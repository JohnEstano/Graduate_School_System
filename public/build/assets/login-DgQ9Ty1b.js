import{m as T,r,j as e,L as U}from"./app-BAKMM9W6.js";import{I as G}from"./input-error-Cb_5nDhF.js";import{T as O}from"./text-link-DEPrlhK9.js";import{B}from"./button-CVeIta7K.js";import{C as I}from"./checkbox-C4nOuQnB.js";import{I as h}from"./input-BRk-fvKd.js";import{L as d}from"./label-BmI7-N0c.js";import{A as Z}from"./auth-layout-BxTO2kQL.js";import{L as R}from"./loader-circle-Ci098EBy.js";import"./utils-jAU0Cazi.js";import"./index-CEqJL0NP.js";import"./index-DZZQifJx.js";import"./index-BHprz6Pm.js";import"./index-CUQ5MhIm.js";import"./index-DUmeJSti.js";import"./index-SVK1MPcU.js";import"./index-tSynuKjl.js";import"./index-BqysFurs.js";import"./check-DCZqiU_u.js";import"./createLucideIcon-BSNBS9Xz.js";import"./card-DwLtnUhU.js";function me(P){const{status:b,canResetPassword:q,googleJustVerified:c,googleSuccessMessage:j,googleVerifiedEmail:w,googleSuggestedIdentifier:v}=P,{data:t,setData:x,post:M,processing:N,errors:l,reset:k}=T({identifier:"",password:"",remember:!1}),[y,C]=r.useState(!1),[m,u]=r.useState(!!c),[A,L]=r.useState(!1),[i,p]=r.useState({identifier:"",password:"",remember:!1}),[S,E]=r.useState(!1),[F,g]=r.useState(null);r.useEffect(()=>{c&&v&&!t.identifier&&x("identifier",v)},[]),r.useEffect(()=>{if(c)return;const s=t.identifier.trim();if(!s){u(!1);return}const f=/^[0-9]{6,}$/.test(s),n=/@/.test(s);if(!(f||n)){u(!1);return}let a=!0;return L(!0),fetch(`/auth/status/google-verified?identifier=${encodeURIComponent(s)}`).then(o=>o.json()).then(o=>{a&&u(!!o.verified)}).catch(()=>{a&&u(!1)}).finally(()=>{a&&L(!1)}),()=>{a=!1}},[t.identifier]),r.useEffect(()=>{l.identifier&&/sign in with Google/i.test(l.identifier)&&C(!0)},[l.identifier]);const D=s=>{s.preventDefault(),M(route("login"),{onSuccess:()=>{k("password")},onError:()=>{k("password")}})},V=s=>{var f;s.preventDefault(),E(!0),g(null),fetch("/login-registered",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((f=document.querySelector('meta[name="csrf-token"]'))==null?void 0:f.content)||""},body:JSON.stringify(i)}).then(async n=>{var a;if(n.redirected)window.location.href=n.url;else if(!n.ok){const o=await n.json();g(((a=o.errors)==null?void 0:a.identifier)||o.message||"Login failed.")}}).catch(()=>g("Network error.")).finally(()=>E(!1))};return e.jsxs(Z,{title:"Graduate School System",description:"Login to your UIC account",children:[e.jsx(U,{title:"Log in"}),c&&j&&e.jsx("div",{className:"fixed inset-x-0 top-4 z-40 flex justify-center px-4",children:e.jsx("div",{className:"relative w-full max-w-md overflow-hidden rounded-lg border border-green-300 bg-green-50 shadow-lg ring-1 ring-green-200",children:e.jsxs("div",{className:"flex items-start gap-3 p-4 pr-4",children:[e.jsx("div",{className:"mt-0.5 flex h-6 w-6 items-center justify-center rounded-full bg-green-100 text-green-600",children:e.jsx("svg",{className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M20 6 9 17l-5-5"})})}),e.jsxs("div",{className:"text-sm text-green-800",children:[e.jsx("p",{className:"font-semibold",children:"Google Verified"}),e.jsx("p",{className:"mt-1 leading-snug",children:j}),w&&e.jsxs("p",{className:"mt-1 text-xs text-green-600",children:["Email: ",w]}),e.jsx("p",{className:"mt-2 text-xs text-green-700",children:"Enter your student number and password below."})]})]})})}),y&&e.jsx("div",{className:"fixed inset-x-0 top-4 z-50 flex justify-center px-4",children:e.jsxs("div",{className:"relative w-full max-w-md overflow-hidden rounded-lg border border-red-300 bg-red-50 shadow-lg ring-1 ring-red-200",children:[e.jsx("button",{type:"button",onClick:()=>C(!1),className:"absolute right-2 top-2 rounded p-1 text-red-500 hover:bg-red-100 focus:outline-none focus:ring-2 focus:ring-red-400","aria-label":"Dismiss notice",children:e.jsx("svg",{className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"flex items-start gap-3 p-4 pr-8",children:[e.jsx("div",{className:"mt-0.5 flex h-6 w-6 items-center justify-center rounded-full bg-red-100 text-red-600",children:e.jsxs("svg",{className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),e.jsx("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]})}),e.jsxs("div",{className:"text-sm text-red-800",children:[e.jsx("p",{className:"font-semibold",children:"Google Verification Required"}),e.jsx("p",{className:"mt-1 leading-snug",children:l.identifier}),e.jsx("p",{className:"mt-2 text-xs text-red-600",children:'Click "Sign in with Google" below using your @uic.edu.ph email once. After that you can use your student number directly.'})]})]})]})}),e.jsx("form",{className:"flex flex-col gap-6",onSubmit:D,"aria-describedby":y?"google-block-notice":void 0,children:e.jsxs("div",{className:"grid gap-6",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(d,{htmlFor:"identifier",children:"Email or Student Number"}),e.jsx("p",{className:"text-[10px] text-slate-500 -mt-1",children:"First time? Use Google (@uic.edu.ph) sign-in before student number login."}),e.jsx(h,{id:"identifier",name:"identifier",type:"text",required:!0,autoComplete:"username",value:t.identifier,onChange:s=>x("identifier",s.target.value),placeholder:"Email or Student Number",className:!m&&/@/.test(t.identifier)?"opacity-60":"",disabled:!c&&/@/.test(t.identifier)}),/@/.test(t.identifier)&&e.jsx("p",{className:"text-[11px] text-blue-600 mt-1",children:"Use the Google button below to continue with your email."}),e.jsx(G,{message:l.identifier})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(d,{htmlFor:"password",children:"Password"}),q&&e.jsx(O,{href:route("password.request"),className:"ml-auto text-sm",tabIndex:5,children:"Forgot password?"})]}),e.jsx(h,{id:"password",type:"password",required:!0,tabIndex:2,autoComplete:"current-password",value:t.password,onChange:s=>x("password",s.target.value),placeholder:"Password",disabled:!m}),!m&&t.identifier&&e.jsxs("p",{className:"text-[11px] text-amber-600 mt-1 flex items-center gap-1",children:[e.jsxs("svg",{className:"h-3.5 w-3.5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),e.jsx("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]}),A?"Checking Google verificationâ€¦":"Complete Google sign-in first."]}),e.jsx(G,{message:l.password})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(I,{id:"remember",name:"remember",checked:t.remember,onClick:()=>x("remember",!t.remember),tabIndex:3}),e.jsx(d,{htmlFor:"remember",children:"Remember me"})]}),e.jsxs(B,{type:"submit",className:"mt-4 w-full",tabIndex:4,disabled:N||!m,children:[N&&e.jsx(R,{className:"h-4 w-4 animate-spin"}),m?"Log in":"Log in (Google verify first)"]})]})}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-base font-semibold mb-2",children:"Login with Google (@uic.edu.ph)"}),e.jsxs("a",{href:route("google.redirect"),className:"flex w-full items-center justify-center gap-2 rounded-md border border-blue-500 bg-white py-2 text-xs font-medium text-blue-700 shadow-sm transition hover:bg-blue-50 dark:border-blue-400 dark:bg-neutral-800 dark:text-neutral-100 dark:hover:bg-neutral-700",children:[e.jsxs("svg",{className:"h-4 w-4",viewBox:"0 0 24 24",children:[e.jsx("path",{fill:"#EA4335",d:"M12 11v3h8.5c-.3 2-2.3 6-8.5 6-5.2 0-9.5-4.3-9.5-9.5S6.8 1 12 1c3 0 5 1.3 6.2 2.5L20.5 1C18.3-.9 15.4-1 12-1 5.4-1 0 4.4 0 11s5.4 12 12 12c6.9 0 11.5-4.8 11.5-11.5 0-.8-.1-1.4-.2-2.1H12Z"}),e.jsx("path",{fill:"#34A853",d:"M1.7 6.7 4.9 9c1-2.4 3.3-4 6.1-4 1.8 0 3.4.6 4.6 1.7l3.4-3.4C16.9 1.1 14.6 0 11 0 6.4 0 2.5 2.6 1 6.2l.7.5Z"}),e.jsx("path",{fill:"#FBBC05",d:"M12 24c3.2 0 6.2-1.1 8.4-3.1l-3.9-3.2c-1.1.8-2.5 1.3-4.5 1.3-3.5 0-6.4-2.4-7.4-5.6l-3.8 2.9C2.3 21.4 6.8 24 12 24Z"}),e.jsx("path",{fill:"#4285F4",d:"M23.8 10.4H12v4.4h6.8c-.5 1.6-1.5 2.8-3 3.6l3.9 3.1c-2.3 2.1-5.3 3.3-8.7 3.3-5.2 0-9.7-2.6-11.4-7l3.8-2.9c.8 2.4 3.3 4.3 6.6 4.3 1.9 0 3.5-.6 4.5-1.3.8-.5 1.4-1.2 1.8-2.1.4-.9.6-1.8.6-2.7 0-.9-.2-1.7-.4-2.4Z"})]}),e.jsx("span",{children:"Sign in with Google"})]}),e.jsx("p",{className:"text-center text-[11px] text-slate-500 dark:text-neutral-500 mt-2",children:"Only @uic.edu.ph accounts are accepted."})]}),e.jsxs("div",{className:"relative flex items-center justify-center my-6",children:[e.jsx("span",{className:"h-px w-full bg-gradient-to-r from-transparent via-slate-300 to-transparent dark:via-neutral-700"}),e.jsx("span",{className:"absolute bg-white px-3 text-[10px] font-medium uppercase tracking-wider text-slate-500 dark:bg-neutral-900 dark:text-neutral-400",children:"or"})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-base font-semibold mb-2",children:"Login with Registered Account"}),e.jsxs("form",{className:"flex flex-col gap-4",onSubmit:V,children:[e.jsxs("div",{children:[e.jsx(d,{htmlFor:"fallback-identifier",children:"Email or Student Number"}),e.jsx(h,{id:"fallback-identifier",type:"text",required:!0,autoComplete:"username",value:i.identifier,onChange:s=>p({...i,identifier:s.target.value}),placeholder:"Username"})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"fallback-password",children:"Password"}),e.jsx(h,{id:"fallback-password",type:"password",required:!0,autoComplete:"current-password",value:i.password,onChange:s=>p({...i,password:s.target.value}),placeholder:"Password"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(I,{id:"fallback-remember",name:"fallback-remember",checked:i.remember,onClick:()=>p({...i,remember:!i.remember})}),e.jsx(d,{htmlFor:"fallback-remember",children:"Remember me"})]}),F&&e.jsx("div",{className:"text-xs text-red-600",children:F}),e.jsx(B,{type:"submit",className:"mt-2 w-full",disabled:S,children:S?e.jsx(R,{className:"h-4 w-4 animate-spin"}):"Log in"})]})]}),b&&e.jsx("div",{className:"mb-4 text-center text-sm font-medium text-green-600",children:b})]})}export{me as default};
