import{K as C,r as s,j as e,R as q,$ as A}from"./app-cp5Xxmuq.js";import E from"./defense-status-widget-CROxk0BW.js";import T from"./weekly-defense-schedule-widget-BCIb_qRN.js";import{B as W,Q as P}from"./quick-actions-widget-DpltoGXd.js";import{C as _,a as L,b as $,c as B}from"./card-CEBh1pSW.js";import b from"./unified-dashboard-layout-CyE1hZwB.js";import{C as M}from"./clipboard-list-B-Seeu2v.js";import{C as Q}from"./calendar-days-JKNu6GOh.js";import{C as F}from"./circle-alert-CP3IHFmQ.js";import"./graduation-cap-DiPQsR-i.js";import"./createLucideIcon-fPg6f676.js";import"./chevron-right-u5yeAyLv.js";import"./hourglass-D3ZOeZeu.js";import"./x-ChVMmgUr.js";import"./check-BKTDNJDu.js";import"./calendar-CPOz5vlg.js";import"./users-Dgf5XU-g.js";import"./skeleton-CvIeXqD9.js";import"./utils-jAU0Cazi.js";import"./format-HX8DKPSU.js";import"./en-US-BA9orzCf.js";import"./isSameDay-DUlCFK42.js";import"./parseISO-CbXPh3Al.js";import"./tooltip-CP7U2y76.js";import"./index-BwY1skv1.js";import"./index-BiaJJerR.js";import"./floating-ui.react-dom-CclZEsZs.js";import"./user-round-Bjl-RuYP.js";import"./settings-BJpfwdNG.js";import"./receipt-bvtmF3pp.js";import"./book-open-DtRim5tR.js";import"./separator-DqvAWWgV.js";import"./index-B7grp9yP.js";import"./sun-BdlRNmMn.js";function Ae(){var h,g;const n=C().props,{auth:{user:t},defenseRequirement:G,defenseRequest:H}=n,d=n.defenseRequests??[],[c,p]=s.useState([]),[I,K]=s.useState([]),[v,U]=s.useState([]),[m,u]=s.useState(!0),[Y,J]=s.useState(!0),[j,y]=s.useState(!0),[N,w]=s.useState(new Date().getDay()),k=[{label:"Sun",value:0},{label:"Mon",value:1},{label:"Tue",value:2},{label:"Wed",value:3},{label:"Thu",value:4},{label:"Fri",value:5},{label:"Sat",value:6}];s.useEffect(()=>{const r=o=>{let a=o.filter(l=>{const i=l.submitted_by;return i===(t==null?void 0:t.id)||i===String(t==null?void 0:t.id)});a.length===0&&(a=o);const x=[...a].sort((l,i)=>{const z=l.created_at?new Date(l.created_at).getTime():0;return(i.created_at?new Date(i.created_at).getTime():0)-z});p(x)};(async()=>{u(!0);try{const o=await fetch("/defense-request",{headers:{Accept:"application/json"}});if(!o.ok)throw new Error("bad");const a=await o.json(),x=Array.isArray(a)?a:a.defenseRequests??[];r(x)}catch{p([])}finally{u(!1)}})()},[t==null?void 0:t.id]);const S=d&&d.length>0?d:c,D=((h=n.recentPayment)==null?void 0:h.amount)??0,R=[{title:"Defense Submissions",value:c.length,description:"Total defense requests submitted",icon:e.jsx(M,{className:"size-7"})},{title:"Today's Schedules",value:v.length,description:"Events scheduled for today",icon:e.jsx(Q,{className:"size-7"})},{title:"Recent Payment",value:`₱${D.toLocaleString()}`,description:"Most recent payment made",icon:e.jsx(W,{className:"size-7"})}];return m?e.jsx(b,{user:t,children:e.jsxs("div",{className:"w-full min-h-[70vh] bg-zinc-100 dark:bg-zinc-900 flex flex-col gap-4 p-0 m-0",children:[e.jsx("div",{className:"h-6 w-1/6 rounded bg-zinc-300 dark:bg-zinc-800 mt-8 mx-8"}),e.jsx("div",{className:"h-12 w-3/4 rounded bg-zinc-300 dark:bg-zinc-800 mx-8"}),e.jsx("div",{className:"h-12 w-2/3 rounded bg-zinc-300 dark:bg-zinc-800 mx-8"}),e.jsx("div",{className:"h-[500px] w-full rounded bg-zinc-300 dark:bg-zinc-800 mt-4"})]})}):e.jsxs(b,{user:t,children:[e.jsx("div",{className:"absolute top-6 right-8",children:e.jsx(P,{userRole:t==null?void 0:t.role})}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-3 px-7",children:R.map((r,f)=>e.jsxs(_,{className:"border border-1 bg-white dark:bg-muted rounded-xl shadow-none flex flex-row items-center min-h-[70px] py-4 px-5",children:[e.jsxs("div",{className:"flex flex-col justify-center flex-1",children:[e.jsx(L,{className:"pb-1 px-0",children:e.jsx($,{className:"text-xs font-semibold text-gray-600 dark:text-gray-300",children:r.title})}),e.jsxs(B,{className:"px-0 py-0",children:[e.jsx("div",{className:"mb-0.5",children:e.jsx("span",{className:"text-2xl font-bold text-gray-900 dark:text-white leading-tight",children:r.value})}),e.jsx("div",{className:"text-[11px] text-gray-400 dark:text-gray-500 mt-0.5",children:r.description})]})]}),e.jsx("div",{className:"flex items-center justify-center ml-3 w-[40px] h-[40px]",children:q.cloneElement(r.icon,{className:"text-rose-500 dark:text-rose-400 size-7"})})]},f))}),((g=t==null?void 0:t.advisers)==null?void 0:g.length)===0&&j&&e.jsx("div",{className:"mx-7 my-3",children:e.jsxs("div",{className:"bg-rose-50 dark:bg-rose-950 border border-rose-200 dark:border-rose-900 text-rose-900 dark:text-rose-100 flex items-start gap-3 px-6 py-5 rounded-xl relative",children:[e.jsx(F,{className:"h-5 w-5 text-rose-500 dark:text-rose-400 mt-1 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"font-semibold mb-1 block",children:"You have not registered an adviser yet."}),e.jsxs("span",{className:"text-sm",children:["Please register with your adviser using their code or contact your adviser for assistance.",e.jsx(A,{href:"/settings/profile",className:"ml-2 underline text-rose-600 dark:text-rose-300 font-medium hover:text-rose-700 dark:hover:text-rose-200",children:"Go to Settings"})]})]}),e.jsx("button",{onClick:()=>y(!1),className:"absolute top-3 right-4 px-2 py-1 text-base rounded hover:bg-rose-100 dark:hover:bg-rose-900 text-rose-600 dark:text-rose-200","aria-label":"Close",children:"✕"})]})}),e.jsxs("div",{className:"flex flex-col gap-6 bg-gray-100 dark:bg-muted ms-4 me-4 rounded-xl mt-2 mb-2 px-5 py-8",children:[e.jsxs("div",{className:"w-full mb-2 flex flex-col md:flex-row gap-4",children:[e.jsx(T,{weekDays:k,selectedDay:N,setSelectedDay:w,approvedDefenses:S,referenceDate:new Date,loading:m,studentId:t==null?void 0:t.id}),e.jsx(E,{recentRequests:c,loading:m})]}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2"})]})]})}export{Ae as default};
