import{r as s,j as e}from"./app-BDkuJsct.js";import{C as n,a as d,b as i,d as c,c as l,e as N}from"./card-BJFJPDio.js";import{C as A,a as w,b as P}from"./chart-7aubccfQ.js";import{R as O,a as f}from"./RadarChart-DvW10P3K.js";import{P as k,a as E}from"./PolarAngleAxis--DfQntO3.js";import"./utils-jAU0Cazi.js";import"./generateCategoricalChart-BOHwT1p9.js";import"./index-CoS1vLG5.js";import"./index-Chjiymov.js";const R={approved:{label:"Approved",color:"#10b981"},pending:{label:"Pending",color:"#f59e0b"}};function H(){const[p,h]=s.useState([]),[j,u]=s.useState(!0),[m,g]=s.useState({totalCoordinators:0,totalApproved:0});return s.useEffect(()=>{Promise.all([fetch("/defense-requests",{headers:{Accept:"application/json"}}).then(o=>o.ok?o.json():[]),fetch("/api/coordinators",{headers:{Accept:"application/json"}}).then(o=>o.ok?o.json():[])]).then(([o,x])=>{const v=Array.isArray(o)?o:o.defenseRequests??[],C=Array.isArray(x)?x:[],t={};v.forEach(r=>{const a=r.coordinator_name||"Unknown";t[a]||(t[a]={approved:0,pending:0}),r.workflow_state==="coordinator-approved"||r.scheduled_date?t[a].approved++:r.workflow_state==="coordinator-review"&&t[a].pending++});const b=Object.entries(t).map(([r,a])=>({coordinator:r.length>15?r.substring(0,15)+"...":r,approved:a.approved,pending:a.pending})).sort((r,a)=>a.approved-r.approved).slice(0,6);h(b);const y=Object.values(t).reduce((r,a)=>r+a.approved,0);g({totalCoordinators:C.length||Object.keys(t).length,totalApproved:y})}).catch(o=>{console.error("Error fetching coordinator data:",o),h([])}).finally(()=>{u(!1)})},[]),j?e.jsxs(n,{className:"rounded-xl shadow-none border",children:[e.jsxs(d,{className:"items-center pb-4",children:[e.jsx(i,{children:"Coordinator Performance"}),e.jsx(c,{children:"Loading..."})]}),e.jsx(l,{className:"h-[300px] flex items-center justify-center",children:e.jsx("div",{className:"text-muted-foreground",children:"Loading chart data..."})})]}):p.length===0?e.jsxs(n,{className:"rounded-xl shadow-none border",children:[e.jsxs(d,{className:"items-center pb-4",children:[e.jsx(i,{children:"Coordinator Performance"}),e.jsx(c,{children:"No data available"})]}),e.jsx(l,{className:"h-[300px] flex items-center justify-center",children:e.jsx("div",{className:"text-muted-foreground",children:"No coordinator data found"})})]}):e.jsxs(n,{className:"rounded-xl shadow-none border",children:[e.jsxs(d,{className:"items-center pb-4",children:[e.jsx(i,{children:"Coordinator Performance"}),e.jsx(c,{children:"Approved vs pending requests per coordinator"})]}),e.jsx(l,{className:"pb-0",children:e.jsx(A,{config:R,className:"mx-auto aspect-square max-h-[250px]",children:e.jsxs(O,{data:p,children:[e.jsx(w,{cursor:!1,content:e.jsx(P,{})}),e.jsx(k,{dataKey:"coordinator"}),e.jsx(E,{}),e.jsx(f,{dataKey:"approved",fill:"var(--color-approved)",fillOpacity:.6,dot:{r:4,fillOpacity:1}}),e.jsx(f,{dataKey:"pending",fill:"var(--color-pending)",fillOpacity:.4,dot:{r:3,fillOpacity:1}})]})})}),e.jsx(N,{className:"flex-col gap-2 pt-4 text-sm",children:e.jsxs("div",{className:"flex items-center gap-2 font-medium leading-none",children:[m.totalApproved," approvals by ",m.totalCoordinators," coordinators"]})})]})}export{H as CoordinatorPerformance};
