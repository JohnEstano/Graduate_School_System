import{r,j as e,L as T}from"./app-BDkuJsct.js";import{A as k}from"./app-layout-Cr_DtTkJ.js";import{B as i}from"./button-DggClj9M.js";import{C as E}from"./card-BJFJPDio.js";import{I as y}from"./input-BmPXXlp0.js";import{T as O,t as l}from"./index-By5vkq0G.js";import{D as F,a as R,b as L,c as P}from"./dialog-DeUj0iLU.js";import I from"./table-all-defense-batch-C5Fw_2Rw.js";import{S as q}from"./send-9CEFXyiZ.js";import{R as z}from"./refresh-cw-B6toqFMV.js";import{P as A}from"./plus-kO5msmqZ.js";import{X as U}from"./x-CtfT_1vN.js";import"./index-B_a1aFVM.js";import"./index-DZZQifJx.js";import"./utils-jAU0Cazi.js";import"./index-CWqpdCTP.js";import"./index-BhbofC_p.js";import"./index-D-bfryUZ.js";import"./tooltip-CWM4FSMS.js";import"./floating-ui.react-dom-w0Q93DA2.js";import"./createLucideIcon-CEmaZ7tj.js";import"./separator-DaKqQg6m.js";import"./index-LRezjsDo.js";import"./chevron-right-BpKiIXqV.js";import"./dropdown-menu-B7sOazTG.js";import"./index-DMsjTEK4.js";import"./index-BdhkuEJx.js";import"./index-BKBXBDOv.js";import"./index-QFmRa-KD.js";import"./check-BUlQxyEc.js";import"./avatar-DpsgA3Kf.js";import"./settings-BITCJcnj.js";import"./users-BTr8E8QO.js";import"./graduation-cap-Cszrlop1.js";import"./file-text-rxgzo2tt.js";import"./dollar-sign-CSALIIUa.js";import"./credit-card-CM3Zlvhr.js";import"./tabs-BOuSS6lC.js";import"./badge-BJdX7_A9.js";import"./circle-check-big-CKfkcUFR.js";import"./info-DwFda8kE.js";import"./sun-B3PIUh1_.js";import"./table-CnA6sFiR.js";import"./pencil-BymrdZQ3.js";const X=[{value:"ready",label:"Ready for Finance",color:"bg-blue-100 text-blue-700 border-blue-200"},{value:"in_progress",label:"In Progress",color:"bg-yellow-100 text-yellow-700 border-yellow-200"},{value:"paid",label:"Paid",color:"bg-green-100 text-green-700 border-green-200"}];function Re(){const[N,x]=r.useState([]),[h,v]=r.useState(""),[c,b]=r.useState([]),[n,o]=r.useState(!1),[C,m]=r.useState(!1),[p,j]=r.useState(""),[g,d]=r.useState(""),u=async()=>{o(!0);try{const t=await fetch("/aa/payment-batches");if(t.ok){const s=await t.json();x(s)}else l.error("Failed to fetch batches")}catch{l.error("Error fetching batches")}finally{o(!1)}};r.useEffect(()=>{u()},[]);const S=N.filter(t=>(!h||t.name.toLowerCase().includes(h.toLowerCase()))&&(!c.length||c.includes(t.status))),w=async()=>{var t;if(!p.trim()){d("Batch name is required");return}o(!0),d("");try{const s=await fetch("/aa/payment-batches",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((t=document.querySelector('meta[name="csrf-token"]'))==null?void 0:t.content)||""},body:JSON.stringify({name:p})});if(s.ok)m(!1),j(""),u(),l.success("Batch created");else{const a=await s.json();d((a==null?void 0:a.error)||"Failed to create batch")}}catch{d("Error creating batch")}finally{o(!1)}},B=async(t,s)=>{var a;o(!0);try{(await fetch(`/aa/payment-batches/${t}/status`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((a=document.querySelector('meta[name="csrf-token"]'))==null?void 0:a.content)||""},body:JSON.stringify({status:s})})).ok?(x(D=>D.map(f=>f.id===t?{...f,status:s}:f)),l.success("Status updated")):l.error("Failed to update status")}catch{l.error("Error updating status")}finally{o(!1)}};return e.jsxs(k,{breadcrumbs:[{title:"Dashboard",href:"/dashboard"},{title:"Defense Batches",href:"/assistant/defense-batch"}],children:[e.jsx(T,{title:"Defense Batches"}),e.jsx(O,{richColors:!0,position:"bottom-right"}),e.jsxs("div",{className:"flex flex-col gap-4 pt-5 pr-3 pl-3",children:[e.jsxs(E,{className:"p-4 flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-10 w-10 flex items-center justify-center rounded-full bg-blue-500/10 border border-blue-500",children:e.jsx(q,{className:"h-5 w-5 text-blue-500"})}),e.jsxs("div",{children:[e.jsx("span",{className:"text-base font-semibold",children:"Defense Batches"}),e.jsx("span",{className:"block text-xs text-muted-foreground",children:"Grouped defense requests for finance processing."})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(i,{variant:"outline",size:"sm",onClick:u,disabled:n,children:[e.jsx(z,{className:"h-4 w-4 mr-1"})," Refresh"]}),e.jsxs(i,{variant:"default",size:"sm",onClick:()=>m(!0),children:[e.jsx(A,{className:"h-4 w-4 mr-1"})," New Batch"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(y,{type:"text",placeholder:"Search batch name...",value:h,onChange:t=>v(t.target.value),className:"max-w-xs text-sm h-8",disabled:n}),e.jsxs("div",{className:"flex gap-1",children:[X.map(t=>e.jsx(i,{variant:c.includes(t.value)?"default":"outline",size:"sm",className:"h-8 px-3",onClick:()=>b(s=>s.includes(t.value)?s.filter(a=>a!==t.value):[...s,t.value]),children:t.label},t.value)),c.length>0&&e.jsxs(i,{variant:"ghost",size:"sm",onClick:()=>b([]),children:[e.jsx(U,{className:"h-4 w-4"})," Reset"]})]})]})]}),e.jsx(I,{batches:S,onUpdateStatus:B,isLoading:n})]}),e.jsx(F,{open:C,onOpenChange:m,children:e.jsxs(R,{children:[e.jsx(L,{children:"Create New Batch"}),e.jsx(P,{children:"Enter a name for the new batch."}),e.jsx(y,{value:p,onChange:t=>j(t.target.value),placeholder:"Batch name",className:"mt-2",disabled:n}),g&&e.jsx("div",{className:"text-red-600 text-xs mt-1",children:g}),e.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[e.jsx(i,{variant:"ghost",onClick:()=>m(!1),children:"Cancel"}),e.jsx(i,{onClick:w,disabled:n,children:"Create"})]})]})})]})}export{Re as default};
