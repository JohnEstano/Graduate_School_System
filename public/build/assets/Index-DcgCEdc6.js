import{r as a,R as K,j as s,L as pr}from"./app-cp5Xxmuq.js";import{A as br}from"./app-layout-FVyShlvS.js";import{B as Ee}from"./button-HcUz4N3c.js";import{B as vr}from"./badge-CD31ww1M.js";import{c as L}from"./utils-jAU0Cazi.js";import{S as Xt,a as Vt,b as Gt,c as qt,d as kt}from"./select-TPdSJVhR.js";import{D as xr,f as yr,a as wr,b as Dr,c as Cr,e as Sr}from"./dialog-BrgoPxJ8.js";import{L as Pe}from"./label-BLxT7CIS.js";import{T as En}from"./textarea-ByK0ywa2.js";import{C as Nr}from"./checkbox-Bg390E6Z.js";import{S as Rt}from"./skeleton-CvIeXqD9.js";import{r as Ge}from"./index-BwY1skv1.js";import{G as yt}from"./graduation-cap-DiPQsR-i.js";import{C as jn}from"./calendar-CPOz5vlg.js";import{X as Er}from"./x-ChVMmgUr.js";import{C as jr}from"./chevron-left-Lq9k-s81.js";import{C as kr}from"./chevron-right-u5yeAyLv.js";import{C as Rr}from"./calendar-days-JKNu6GOh.js";import{c as Mr}from"./createLucideIcon-fPg6f676.js";import{E as Tr}from"./eye-DXr7fUbP.js";import{S as Or}from"./square-pen-CJEgJwJN.js";import{P as Ar}from"./printer-CtXwBjXz.js";import{T as zr}from"./trash-2-CdaG9Vkl.js";import{f as _,a as kn}from"./format-HX8DKPSU.js";import{s as Jt,i as Rn}from"./isSameMonth-CQd3m9St.js";import{e as Qt}from"./endOfMonth-CK_ShA5m.js";import{e as Lr,a as Ae}from"./endOfWeek-QFyZPl43.js";import{p as $e}from"./parseISO-CbXPh3Al.js";import{i as Zt}from"./isToday-2ODO8FsQ.js";import{i as Mn}from"./isSameDay-DUlCFK42.js";import"./index-BiaJJerR.js";import"./index-DZZQifJx.js";import"./input-CozWEoae.js";import"./index-DbUO4osX.js";import"./index-BkV9g7de.js";import"./tooltip-CP7U2y76.js";import"./floating-ui.react-dom-CclZEsZs.js";import"./separator-DqvAWWgV.js";import"./index-B7grp9yP.js";import"./dropdown-menu-gg636D7H.js";import"./index-DGSzJOj5.js";import"./index-w2GBgPnQ.js";import"./index-KWoA_zXX.js";import"./index-DgxNXxEZ.js";import"./avatar-BVnHwuNv.js";import"./settings-BJpfwdNG.js";import"./chevrons-up-down-CUkeUAhf.js";import"./file-text-Brb8dGUd.js";import"./dollar-sign-OqGbvCP2.js";import"./users-Dgf5XU-g.js";import"./credit-card-BumryUWt.js";import"./circle-check-big-D0Jy2-20.js";import"./info-CTXSwM4X.js";import"./sun-BdlRNmMn.js";import"./index-DjkDYLy3.js";import"./chevron-down-CRKR2eDe.js";import"./check-BKTDNJDu.js";import"./en-US-BA9orzCf.js";import"./constructNow-Chb2L4Vx.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ir=[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M17 14h-6",key:"bkmgh3"}],["path",{d:"M13 18H7",key:"bb0bb7"}],["path",{d:"M7 14h.01",key:"1qa3f1"}],["path",{d:"M17 18h.01",key:"1bdyru"}]],_r=Mr("CalendarRange",Ir),Pt=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function et(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function pn(e){return"nodeType"in e}function ne(e){var t,n;return e?et(e)?e:pn(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function bn(e){const{Document:t}=ne(e);return e instanceof t}function wt(e){return et(e)?!1:e instanceof ne(e).HTMLElement}function Vn(e){return e instanceof ne(e).SVGElement}function tt(e){return e?et(e)?e.document:pn(e)?bn(e)?e:wt(e)||Vn(e)?e.ownerDocument:document:document:document}const je=Pt?a.useLayoutEffect:a.useEffect;function $t(e){const t=a.useRef(e);return je(()=>{t.current=e}),a.useCallback(function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t.current==null?void 0:t.current(...r)},[])}function Pr(){const e=a.useRef(null),t=a.useCallback((r,o)=>{e.current=setInterval(r,o)},[]),n=a.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function pt(e,t){t===void 0&&(t=[e]);const n=a.useRef(e);return je(()=>{n.current!==e&&(n.current=e)},t),n}function Dt(e,t){const n=a.useRef();return a.useMemo(()=>{const r=e(n.current);return n.current=r,r},[...t])}function Tt(e){const t=$t(e),n=a.useRef(null),r=a.useCallback(o=>{o!==n.current&&(t==null||t(o,n.current)),n.current=o},[]);return[n,r]}function Ot(e){const t=a.useRef();return a.useEffect(()=>{t.current=e},[e]),t.current}let en={};function Ft(e,t){return a.useMemo(()=>{if(t)return t;const n=en[e]==null?0:en[e]+1;return en[e]=n,e+"-"+n},[e,t])}function Gn(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return r.reduce((i,d)=>{const c=Object.entries(d);for(const[u,f]of c){const m=i[u];m!=null&&(i[u]=m+e*f)}return i},{...t})}}const qe=Gn(1),At=Gn(-1);function $r(e){return"clientX"in e&&"clientY"in e}function vn(e){if(!e)return!1;const{KeyboardEvent:t}=ne(e.target);return t&&e instanceof t}function Fr(e){if(!e)return!1;const{TouchEvent:t}=ne(e.target);return t&&e instanceof t}function zt(e){if(Fr(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return $r(e)?{x:e.clientX,y:e.clientY}:null}const bt=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[bt.Translate.toString(e),bt.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:r}=e;return t+" "+n+"ms "+r}}}),Tn="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function Br(e){return e.matches(Tn)?e:e.querySelector(Tn)}const Hr={display:"none"};function Wr(e){let{id:t,value:n}=e;return K.createElement("div",{id:t,style:Hr},n)}function Ur(e){let{id:t,announcement:n,ariaLiveType:r="assertive"}=e;const o={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return K.createElement("div",{id:t,style:o,role:"status","aria-live":r,"aria-atomic":!0},n)}function Yr(){const[e,t]=a.useState("");return{announce:a.useCallback(r=>{r!=null&&t(r)},[]),announcement:e}}const qn=a.createContext(null);function Kr(e){const t=a.useContext(qn);a.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function Xr(){const[e]=a.useState(()=>new Set),t=a.useCallback(r=>(e.add(r),()=>e.delete(r)),[e]);return[a.useCallback(r=>{let{type:o,event:i}=r;e.forEach(d=>{var c;return(c=d[o])==null?void 0:c.call(d,i)})},[e]),t]}const Vr={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},Gr={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function qr(e){let{announcements:t=Gr,container:n,hiddenTextDescribedById:r,screenReaderInstructions:o=Vr}=e;const{announce:i,announcement:d}=Yr(),c=Ft("DndLiveRegion"),[u,f]=a.useState(!1);if(a.useEffect(()=>{f(!0)},[]),Kr(a.useMemo(()=>({onDragStart(h){let{active:p}=h;i(t.onDragStart({active:p}))},onDragMove(h){let{active:p,over:x}=h;t.onDragMove&&i(t.onDragMove({active:p,over:x}))},onDragOver(h){let{active:p,over:x}=h;i(t.onDragOver({active:p,over:x}))},onDragEnd(h){let{active:p,over:x}=h;i(t.onDragEnd({active:p,over:x}))},onDragCancel(h){let{active:p,over:x}=h;i(t.onDragCancel({active:p,over:x}))}}),[i,t])),!u)return null;const m=K.createElement(K.Fragment,null,K.createElement(Wr,{id:r,value:o.draggable}),K.createElement(Ur,{id:c,announcement:d}));return n?Ge.createPortal(m,n):m}var V;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(V||(V={}));function Lt(){}const pe=Object.freeze({x:0,y:0});function Jr(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function Qr(e,t){const n=zt(e);if(!n)return"0 0";const r={x:(n.x-t.left)/t.width*100,y:(n.y-t.top)/t.height*100};return r.x+"% "+r.y+"%"}function Zr(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return n-r}function es(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return r-n}function ts(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}function On(e,t,n){return t===void 0&&(t=e.left),n===void 0&&(n=e.top),{x:t+e.width*.5,y:n+e.height*.5}}const tn=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const o=On(t,t.left,t.top),i=[];for(const d of r){const{id:c}=d,u=n.get(c);if(u){const f=Jr(On(u),o);i.push({id:c,data:{droppableContainer:d,value:f}})}}return i.sort(Zr)};function ns(e,t){const n=Math.max(t.top,e.top),r=Math.max(t.left,e.left),o=Math.min(t.left+t.width,e.left+e.width),i=Math.min(t.top+t.height,e.top+e.height),d=o-r,c=i-n;if(r<o&&n<i){const u=t.width*t.height,f=e.width*e.height,m=d*c,h=m/(u+f-m);return Number(h.toFixed(4))}return 0}const rs=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const o=[];for(const i of r){const{id:d}=i,c=n.get(d);if(c){const u=ns(c,t);u>0&&o.push({id:d,data:{droppableContainer:i,value:u}})}}return o.sort(es)};function ss(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function Jn(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:pe}function os(e){return function(n){for(var r=arguments.length,o=new Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];return o.reduce((d,c)=>({...d,top:d.top+e*c.y,bottom:d.bottom+e*c.y,left:d.left+e*c.x,right:d.right+e*c.x}),{...n})}}const is=os(1);function Qn(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function as(e,t,n){const r=Qn(t);if(!r)return e;const{scaleX:o,scaleY:i,x:d,y:c}=r,u=e.left-d-(1-o)*parseFloat(n),f=e.top-c-(1-i)*parseFloat(n.slice(n.indexOf(" ")+1)),m=o?e.width/o:e.width,h=i?e.height/i:e.height;return{width:m,height:h,top:f,right:u+m,bottom:f+h,left:u}}const ls={ignoreTransform:!1};function Ct(e,t){t===void 0&&(t=ls);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:f,transformOrigin:m}=ne(e).getComputedStyle(e);f&&(n=as(n,f,m))}const{top:r,left:o,width:i,height:d,bottom:c,right:u}=n;return{top:r,left:o,width:i,height:d,bottom:c,right:u}}function An(e){return Ct(e,{ignoreTransform:!0})}function cs(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function ds(e,t){return t===void 0&&(t=ne(e).getComputedStyle(e)),t.position==="fixed"}function us(e,t){t===void 0&&(t=ne(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(o=>{const i=t[o];return typeof i=="string"?n.test(i):!1})}function xn(e,t){const n=[];function r(o){if(t!=null&&n.length>=t||!o)return n;if(bn(o)&&o.scrollingElement!=null&&!n.includes(o.scrollingElement))return n.push(o.scrollingElement),n;if(!wt(o)||Vn(o)||n.includes(o))return n;const i=ne(e).getComputedStyle(o);return o!==e&&us(o,i)&&n.push(o),ds(o,i)?n:r(o.parentNode)}return e?r(e):n}function Zn(e){const[t]=xn(e,1);return t??null}function nn(e){return!Pt||!e?null:et(e)?e:pn(e)?bn(e)||e===tt(e).scrollingElement?window:wt(e)?e:null:null}function er(e){return et(e)?e.scrollX:e.scrollLeft}function tr(e){return et(e)?e.scrollY:e.scrollTop}function un(e){return{x:er(e),y:tr(e)}}var q;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(q||(q={}));function nr(e){return!Pt||!e?!1:e===document.scrollingElement}function rr(e){const t={x:0,y:0},n=nr(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},r={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},o=e.scrollTop<=t.y,i=e.scrollLeft<=t.x,d=e.scrollTop>=r.y,c=e.scrollLeft>=r.x;return{isTop:o,isLeft:i,isBottom:d,isRight:c,maxScroll:r,minScroll:t}}const fs={x:.2,y:.2};function hs(e,t,n,r,o){let{top:i,left:d,right:c,bottom:u}=n;r===void 0&&(r=10),o===void 0&&(o=fs);const{isTop:f,isBottom:m,isLeft:h,isRight:p}=rr(e),x={x:0,y:0},T={x:0,y:0},y={height:t.height*o.y,width:t.width*o.x};return!f&&i<=t.top+y.height?(x.y=q.Backward,T.y=r*Math.abs((t.top+y.height-i)/y.height)):!m&&u>=t.bottom-y.height&&(x.y=q.Forward,T.y=r*Math.abs((t.bottom-y.height-u)/y.height)),!p&&c>=t.right-y.width?(x.x=q.Forward,T.x=r*Math.abs((t.right-y.width-c)/y.width)):!h&&d<=t.left+y.width&&(x.x=q.Backward,T.x=r*Math.abs((t.left+y.width-d)/y.width)),{direction:x,speed:T}}function ms(e){if(e===document.scrollingElement){const{innerWidth:i,innerHeight:d}=window;return{top:0,left:0,right:i,bottom:d,width:i,height:d}}const{top:t,left:n,right:r,bottom:o}=e.getBoundingClientRect();return{top:t,left:n,right:r,bottom:o,width:e.clientWidth,height:e.clientHeight}}function sr(e){return e.reduce((t,n)=>qe(t,un(n)),pe)}function gs(e){return e.reduce((t,n)=>t+er(n),0)}function ps(e){return e.reduce((t,n)=>t+tr(n),0)}function or(e,t){if(t===void 0&&(t=Ct),!e)return;const{top:n,left:r,bottom:o,right:i}=t(e);Zn(e)&&(o<=0||i<=0||n>=window.innerHeight||r>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const bs=[["x",["left","right"],gs],["y",["top","bottom"],ps]];class yn{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=xn(n),o=sr(r);this.rect={...t},this.width=t.width,this.height=t.height;for(const[i,d,c]of bs)for(const u of d)Object.defineProperty(this,u,{get:()=>{const f=c(r),m=o[i]-f;return this.rect[u]+m},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class ht{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...n)})},this.target=t}add(t,n,r){var o;(o=this.target)==null||o.addEventListener(t,n,r),this.listeners.push([t,n,r])}}function vs(e){const{EventTarget:t}=ne(e);return e instanceof t?e:tt(e)}function rn(e,t){const n=Math.abs(e.x),r=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+r**2)>t:"x"in t&&"y"in t?n>t.x&&r>t.y:"x"in t?n>t.x:"y"in t?r>t.y:!1}var fe;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(fe||(fe={}));function zn(e){e.preventDefault()}function xs(e){e.stopPropagation()}var I;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(I||(I={}));const ir={start:[I.Space,I.Enter],cancel:[I.Esc],end:[I.Space,I.Enter,I.Tab]},ys=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case I.Right:return{...n,x:n.x+25};case I.Left:return{...n,x:n.x-25};case I.Down:return{...n,y:n.y+25};case I.Up:return{...n,y:n.y-25}}};class ar{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new ht(tt(n)),this.windowListeners=new ht(ne(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(fe.Resize,this.handleCancel),this.windowListeners.add(fe.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(fe.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,r=t.node.current;r&&or(r),n(pe)}handleKeyDown(t){if(vn(t)){const{active:n,context:r,options:o}=this.props,{keyboardCodes:i=ir,coordinateGetter:d=ys,scrollBehavior:c="smooth"}=o,{code:u}=t;if(i.end.includes(u)){this.handleEnd(t);return}if(i.cancel.includes(u)){this.handleCancel(t);return}const{collisionRect:f}=r.current,m=f?{x:f.left,y:f.top}:pe;this.referenceCoordinates||(this.referenceCoordinates=m);const h=d(t,{active:n,context:r.current,currentCoordinates:m});if(h){const p=At(h,m),x={x:0,y:0},{scrollableAncestors:T}=r.current;for(const y of T){const D=t.code,{isTop:N,isRight:M,isLeft:k,isBottom:P,maxScroll:z,minScroll:O}=rr(y),R=ms(y),j={x:Math.min(D===I.Right?R.right-R.width/2:R.right,Math.max(D===I.Right?R.left:R.left+R.width/2,h.x)),y:Math.min(D===I.Down?R.bottom-R.height/2:R.bottom,Math.max(D===I.Down?R.top:R.top+R.height/2,h.y))},$=D===I.Right&&!M||D===I.Left&&!k,W=D===I.Down&&!P||D===I.Up&&!N;if($&&j.x!==h.x){const H=y.scrollLeft+p.x,X=D===I.Right&&H<=z.x||D===I.Left&&H>=O.x;if(X&&!p.y){y.scrollTo({left:H,behavior:c});return}X?x.x=y.scrollLeft-H:x.x=D===I.Right?y.scrollLeft-z.x:y.scrollLeft-O.x,x.x&&y.scrollBy({left:-x.x,behavior:c});break}else if(W&&j.y!==h.y){const H=y.scrollTop+p.y,X=D===I.Down&&H<=z.y||D===I.Up&&H>=O.y;if(X&&!p.x){y.scrollTo({top:H,behavior:c});return}X?x.y=y.scrollTop-H:x.y=D===I.Down?y.scrollTop-z.y:y.scrollTop-O.y,x.y&&y.scrollBy({top:-x.y,behavior:c});break}}this.handleMove(t,qe(At(h,this.referenceCoordinates),x))}}}handleMove(t,n){const{onMove:r}=this.props;t.preventDefault(),r(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}ar.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:r=ir,onActivation:o}=t,{active:i}=n;const{code:d}=e.nativeEvent;if(r.start.includes(d)){const c=i.activatorNode.current;return c&&e.target!==c?!1:(e.preventDefault(),o==null||o({event:e.nativeEvent}),!0)}return!1}}];function Ln(e){return!!(e&&"distance"in e)}function In(e){return!!(e&&"delay"in e)}class wn{constructor(t,n,r){var o;r===void 0&&(r=vs(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:i}=t,{target:d}=i;this.props=t,this.events=n,this.document=tt(d),this.documentListeners=new ht(this.document),this.listeners=new ht(r),this.windowListeners=new ht(ne(d)),this.initialCoordinates=(o=zt(i))!=null?o:pe,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:r}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(fe.Resize,this.handleCancel),this.windowListeners.add(fe.DragStart,zn),this.windowListeners.add(fe.VisibilityChange,this.handleCancel),this.windowListeners.add(fe.ContextMenu,zn),this.documentListeners.add(fe.Keydown,this.handleKeydown),n){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(In(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(Ln(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:r,onPending:o}=this.props;o(r,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(fe.Click,xs,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(fe.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:r,initialCoordinates:o,props:i}=this,{onMove:d,options:{activationConstraint:c}}=i;if(!o)return;const u=(n=zt(t))!=null?n:pe,f=At(o,u);if(!r&&c){if(Ln(c)){if(c.tolerance!=null&&rn(f,c.tolerance))return this.handleCancel();if(rn(f,c.distance))return this.handleStart()}if(In(c)&&rn(f,c.tolerance))return this.handleCancel();this.handlePending(c,f);return}t.cancelable&&t.preventDefault(),d(u)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===I.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const ws={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class lr extends wn{constructor(t){const{event:n}=t,r=tt(n.target);super(t,ws,r)}}lr.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return!n.isPrimary||n.button!==0?!1:(r==null||r({event:n}),!0)}}];const Ds={move:{name:"mousemove"},end:{name:"mouseup"}};var fn;(function(e){e[e.RightClick=2]="RightClick"})(fn||(fn={}));class Cs extends wn{constructor(t){super(t,Ds,tt(t.event.target))}}Cs.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return n.button===fn.RightClick?!1:(r==null||r({event:n}),!0)}}];const sn={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class Ss extends wn{constructor(t){super(t,sn)}static setup(){return window.addEventListener(sn.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(sn.move.name,t)};function t(){}}}Ss.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;const{touches:o}=n;return o.length>1?!1:(r==null||r({event:n}),!0)}}];var mt;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(mt||(mt={}));var It;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(It||(It={}));function Ns(e){let{acceleration:t,activator:n=mt.Pointer,canScroll:r,draggingRect:o,enabled:i,interval:d=5,order:c=It.TreeOrder,pointerCoordinates:u,scrollableAncestors:f,scrollableAncestorRects:m,delta:h,threshold:p}=e;const x=js({delta:h,disabled:!i}),[T,y]=Pr(),D=a.useRef({x:0,y:0}),N=a.useRef({x:0,y:0}),M=a.useMemo(()=>{switch(n){case mt.Pointer:return u?{top:u.y,bottom:u.y,left:u.x,right:u.x}:null;case mt.DraggableRect:return o}},[n,o,u]),k=a.useRef(null),P=a.useCallback(()=>{const O=k.current;if(!O)return;const R=D.current.x*N.current.x,j=D.current.y*N.current.y;O.scrollBy(R,j)},[]),z=a.useMemo(()=>c===It.TreeOrder?[...f].reverse():f,[c,f]);a.useEffect(()=>{if(!i||!f.length||!M){y();return}for(const O of z){if((r==null?void 0:r(O))===!1)continue;const R=f.indexOf(O),j=m[R];if(!j)continue;const{direction:$,speed:W}=hs(O,j,M,t,p);for(const H of["x","y"])x[H][$[H]]||(W[H]=0,$[H]=0);if(W.x>0||W.y>0){y(),k.current=O,T(P,d),D.current=W,N.current=$;return}}D.current={x:0,y:0},N.current={x:0,y:0},y()},[t,P,r,y,i,d,JSON.stringify(M),JSON.stringify(x),T,f,z,m,JSON.stringify(p)])}const Es={x:{[q.Backward]:!1,[q.Forward]:!1},y:{[q.Backward]:!1,[q.Forward]:!1}};function js(e){let{delta:t,disabled:n}=e;const r=Ot(t);return Dt(o=>{if(n||!r||!o)return Es;const i={x:Math.sign(t.x-r.x),y:Math.sign(t.y-r.y)};return{x:{[q.Backward]:o.x[q.Backward]||i.x===-1,[q.Forward]:o.x[q.Forward]||i.x===1},y:{[q.Backward]:o.y[q.Backward]||i.y===-1,[q.Forward]:o.y[q.Forward]||i.y===1}}},[n,t,r])}function ks(e,t){const n=t!=null?e.get(t):void 0,r=n?n.node.current:null;return Dt(o=>{var i;return t==null?null:(i=r??o)!=null?i:null},[r,t])}function Rs(e,t){return a.useMemo(()=>e.reduce((n,r)=>{const{sensor:o}=r,i=o.activators.map(d=>({eventName:d.eventName,handler:t(d.handler,r)}));return[...n,...i]},[]),[e,t])}var vt;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(vt||(vt={}));var hn;(function(e){e.Optimized="optimized"})(hn||(hn={}));const _n=new Map;function Ms(e,t){let{dragging:n,dependencies:r,config:o}=t;const[i,d]=a.useState(null),{frequency:c,measure:u,strategy:f}=o,m=a.useRef(e),h=D(),p=pt(h),x=a.useCallback(function(N){N===void 0&&(N=[]),!p.current&&d(M=>M===null?N:M.concat(N.filter(k=>!M.includes(k))))},[p]),T=a.useRef(null),y=Dt(N=>{if(h&&!n)return _n;if(!N||N===_n||m.current!==e||i!=null){const M=new Map;for(let k of e){if(!k)continue;if(i&&i.length>0&&!i.includes(k.id)&&k.rect.current){M.set(k.id,k.rect.current);continue}const P=k.node.current,z=P?new yn(u(P),P):null;k.rect.current=z,z&&M.set(k.id,z)}return M}return N},[e,i,n,h,u]);return a.useEffect(()=>{m.current=e},[e]),a.useEffect(()=>{h||x()},[n,h]),a.useEffect(()=>{i&&i.length>0&&d(null)},[JSON.stringify(i)]),a.useEffect(()=>{h||typeof c!="number"||T.current!==null||(T.current=setTimeout(()=>{x(),T.current=null},c))},[c,h,x,...r]),{droppableRects:y,measureDroppableContainers:x,measuringScheduled:i!=null};function D(){switch(f){case vt.Always:return!1;case vt.BeforeDragging:return n;default:return!n}}}function Dn(e,t){return Dt(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function Ts(e,t){return Dn(e,t)}function Os(e){let{callback:t,disabled:n}=e;const r=$t(t),o=a.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:i}=window;return new i(r)},[r,n]);return a.useEffect(()=>()=>o==null?void 0:o.disconnect(),[o]),o}function Bt(e){let{callback:t,disabled:n}=e;const r=$t(t),o=a.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:i}=window;return new i(r)},[n]);return a.useEffect(()=>()=>o==null?void 0:o.disconnect(),[o]),o}function As(e){return new yn(Ct(e),e)}function Pn(e,t,n){t===void 0&&(t=As);const[r,o]=a.useState(null);function i(){o(u=>{if(!e)return null;if(e.isConnected===!1){var f;return(f=u??n)!=null?f:null}const m=t(e);return JSON.stringify(u)===JSON.stringify(m)?u:m})}const d=Os({callback(u){if(e)for(const f of u){const{type:m,target:h}=f;if(m==="childList"&&h instanceof HTMLElement&&h.contains(e)){i();break}}}}),c=Bt({callback:i});return je(()=>{i(),e?(c==null||c.observe(e),d==null||d.observe(document.body,{childList:!0,subtree:!0})):(c==null||c.disconnect(),d==null||d.disconnect())},[e]),r}function zs(e){const t=Dn(e);return Jn(e,t)}const $n=[];function Ls(e){const t=a.useRef(e),n=Dt(r=>e?r&&r!==$n&&e&&t.current&&e.parentNode===t.current.parentNode?r:xn(e):$n,[e]);return a.useEffect(()=>{t.current=e},[e]),n}function Is(e){const[t,n]=a.useState(null),r=a.useRef(e),o=a.useCallback(i=>{const d=nn(i.target);d&&n(c=>c?(c.set(d,un(d)),new Map(c)):null)},[]);return a.useEffect(()=>{const i=r.current;if(e!==i){d(i);const c=e.map(u=>{const f=nn(u);return f?(f.addEventListener("scroll",o,{passive:!0}),[f,un(f)]):null}).filter(u=>u!=null);n(c.length?new Map(c):null),r.current=e}return()=>{d(e),d(i)};function d(c){c.forEach(u=>{const f=nn(u);f==null||f.removeEventListener("scroll",o)})}},[o,e]),a.useMemo(()=>e.length?t?Array.from(t.values()).reduce((i,d)=>qe(i,d),pe):sr(e):pe,[e,t])}function Fn(e,t){t===void 0&&(t=[]);const n=a.useRef(null);return a.useEffect(()=>{n.current=null},t),a.useEffect(()=>{const r=e!==pe;r&&!n.current&&(n.current=e),!r&&n.current&&(n.current=null)},[e]),n.current?At(e,n.current):pe}function _s(e){a.useEffect(()=>{if(!Pt)return;const t=e.map(n=>{let{sensor:r}=n;return r.setup==null?void 0:r.setup()});return()=>{for(const n of t)n==null||n()}},e.map(t=>{let{sensor:n}=t;return n}))}function Ps(e,t){return a.useMemo(()=>e.reduce((n,r)=>{let{eventName:o,handler:i}=r;return n[o]=d=>{i(d,t)},n},{}),[e,t])}function cr(e){return a.useMemo(()=>e?cs(e):null,[e])}const Bn=[];function $s(e,t){t===void 0&&(t=Ct);const[n]=e,r=cr(n?ne(n):null),[o,i]=a.useState(Bn);function d(){i(()=>e.length?e.map(u=>nr(u)?r:new yn(t(u),u)):Bn)}const c=Bt({callback:d});return je(()=>{c==null||c.disconnect(),d(),e.forEach(u=>c==null?void 0:c.observe(u))},[e]),o}function dr(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return wt(t)?t:e}function Fs(e){let{measure:t}=e;const[n,r]=a.useState(null),o=a.useCallback(f=>{for(const{target:m}of f)if(wt(m)){r(h=>{const p=t(m);return h?{...h,width:p.width,height:p.height}:p});break}},[t]),i=Bt({callback:o}),d=a.useCallback(f=>{const m=dr(f);i==null||i.disconnect(),m&&(i==null||i.observe(m)),r(m?t(m):null)},[t,i]),[c,u]=Tt(d);return a.useMemo(()=>({nodeRef:c,rect:n,setRef:u}),[n,c,u])}const Bs=[{sensor:lr,options:{}},{sensor:ar,options:{}}],Hs={current:{}},Mt={draggable:{measure:An},droppable:{measure:An,strategy:vt.WhileDragging,frequency:hn.Optimized},dragOverlay:{measure:Ct}};class gt extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,r;return(n=(r=this.get(t))==null?void 0:r.node.current)!=null?n:void 0}}const Ws={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new gt,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Lt},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Mt,measureDroppableContainers:Lt,windowRect:null,measuringScheduled:!1},ur={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Lt,draggableNodes:new Map,over:null,measureDroppableContainers:Lt},St=a.createContext(ur),fr=a.createContext(Ws);function Us(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new gt}}}function Ys(e,t){switch(t.type){case V.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case V.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case V.DragEnd:case V.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case V.RegisterDroppable:{const{element:n}=t,{id:r}=n,o=new gt(e.droppable.containers);return o.set(r,n),{...e,droppable:{...e.droppable,containers:o}}}case V.SetDroppableDisabled:{const{id:n,key:r,disabled:o}=t,i=e.droppable.containers.get(n);if(!i||r!==i.key)return e;const d=new gt(e.droppable.containers);return d.set(n,{...i,disabled:o}),{...e,droppable:{...e.droppable,containers:d}}}case V.UnregisterDroppable:{const{id:n,key:r}=t,o=e.droppable.containers.get(n);if(!o||r!==o.key)return e;const i=new gt(e.droppable.containers);return i.delete(n),{...e,droppable:{...e.droppable,containers:i}}}default:return e}}function Ks(e){let{disabled:t}=e;const{active:n,activatorEvent:r,draggableNodes:o}=a.useContext(St),i=Ot(r),d=Ot(n==null?void 0:n.id);return a.useEffect(()=>{if(!t&&!r&&i&&d!=null){if(!vn(i)||document.activeElement===i.target)return;const c=o.get(d);if(!c)return;const{activatorNode:u,node:f}=c;if(!u.current&&!f.current)return;requestAnimationFrame(()=>{for(const m of[u.current,f.current]){if(!m)continue;const h=Br(m);if(h){h.focus();break}}})}},[r,t,o,d,i]),null}function hr(e,t){let{transform:n,...r}=t;return e!=null&&e.length?e.reduce((o,i)=>i({transform:o,...r}),n):n}function Xs(e){return a.useMemo(()=>({draggable:{...Mt.draggable,...e==null?void 0:e.draggable},droppable:{...Mt.droppable,...e==null?void 0:e.droppable},dragOverlay:{...Mt.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function Vs(e){let{activeNode:t,measure:n,initialRect:r,config:o=!0}=e;const i=a.useRef(!1),{x:d,y:c}=typeof o=="boolean"?{x:o,y:o}:o;je(()=>{if(!d&&!c||!t){i.current=!1;return}if(i.current||!r)return;const f=t==null?void 0:t.node.current;if(!f||f.isConnected===!1)return;const m=n(f),h=Jn(m,r);if(d||(h.x=0),c||(h.y=0),i.current=!0,Math.abs(h.x)>0||Math.abs(h.y)>0){const p=Zn(f);p&&p.scrollBy({top:h.y,left:h.x})}},[t,d,c,r,n])}const Ht=a.createContext({...pe,scaleX:1,scaleY:1});var ze;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(ze||(ze={}));const on=a.memo(function(t){var n,r,o,i;let{id:d,accessibility:c,autoScroll:u=!0,children:f,sensors:m=Bs,collisionDetection:h=rs,measuring:p,modifiers:x,...T}=t;const y=a.useReducer(Ys,void 0,Us),[D,N]=y,[M,k]=Xr(),[P,z]=a.useState(ze.Uninitialized),O=P===ze.Initialized,{draggable:{active:R,nodes:j,translate:$},droppable:{containers:W}}=D,H=R!=null?j.get(R):null,X=a.useRef({initial:null,translated:null}),le=a.useMemo(()=>{var B;return R!=null?{id:R,data:(B=H==null?void 0:H.data)!=null?B:Hs,rect:X}:null},[R,H]),ce=a.useRef(null),[nt,rt]=a.useState(null),[J,Fe]=a.useState(null),be=pt(T,Object.values(T)),st=Ft("DndDescribedBy",d),Be=a.useMemo(()=>W.getEnabled(),[W]),ke=Xs(p),{droppableRects:Re,measureDroppableContainers:Me,measuringScheduled:He}=Ms(Be,{dragging:O,dependencies:[$.x,$.y],config:ke.droppable}),Q=ks(j,R),ot=a.useMemo(()=>J?zt(J):null,[J]),Te=F(),it=Ts(Q,ke.draggable.measure);Vs({activeNode:R!=null?j.get(R):null,config:Te.layoutShiftCompensation,initialRect:it,measure:ke.draggable.measure});const se=Pn(Q,ke.draggable.measure,it),at=Pn(Q?Q.parentElement:null),Ce=a.useRef({activatorEvent:null,active:null,activeNode:Q,collisionRect:null,collisions:null,droppableRects:Re,draggableNodes:j,draggingNode:null,draggingNodeRect:null,droppableContainers:W,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Nt=W.getNodeFor((n=Ce.current.over)==null?void 0:n.id),he=Fs({measure:ke.dragOverlay.measure}),We=(r=he.nodeRef.current)!=null?r:Q,oe=O?(o=he.rect)!=null?o:se:null,Ue=!!(he.nodeRef.current&&he.rect),_e=zs(Ue?null:se),lt=cr(We?ne(We):null),ve=Ls(O?Nt??Q:null),Ye=$s(ve),Ke=hr(x,{transform:{x:$.x-_e.x,y:$.y-_e.y,scaleX:1,scaleY:1},activatorEvent:J,active:le,activeNodeRect:se,containerNodeRect:at,draggingNodeRect:oe,over:Ce.current.over,overlayNodeRect:he.rect,scrollableAncestors:ve,scrollableAncestorRects:Ye,windowRect:lt}),ct=ot?qe(ot,$):null,ie=Is(ve),Wt=Fn(ie),A=Fn(ie,[se]),Se=qe(Ke,Wt),xe=oe?is(oe,Ke):null,Ne=le&&xe?h({active:le,collisionRect:xe,droppableRects:Re,droppableContainers:Be,pointerCoordinates:ct}):null,Oe=ts(Ne,"id"),[de,Xe]=a.useState(null),dt=Ue?Ke:qe(Ke,A),Nn=ss(dt,(i=de==null?void 0:de.rect)!=null?i:null,se),Et=a.useRef(null),re=a.useCallback((B,U)=>{let{sensor:Z,options:me}=U;if(ce.current==null)return;const ee=j.get(ce.current);if(!ee)return;const te=B.nativeEvent,ae=new Z({active:ce.current,activeNode:ee,event:te,options:me,context:Ce,onAbort(Y){if(!j.get(Y))return;const{onDragAbort:ue}=be.current,l={id:Y};ue==null||ue(l),M({type:"onDragAbort",event:l})},onPending(Y,ye,ue,l){if(!j.get(Y))return;const{onDragPending:v}=be.current,b={id:Y,constraint:ye,initialCoordinates:ue,offset:l};v==null||v(b),M({type:"onDragPending",event:b})},onStart(Y){const ye=ce.current;if(ye==null)return;const ue=j.get(ye);if(!ue)return;const{onDragStart:l}=be.current,g={activatorEvent:te,active:{id:ye,data:ue.data,rect:X}};Ge.unstable_batchedUpdates(()=>{l==null||l(g),z(ze.Initializing),N({type:V.DragStart,initialCoordinates:Y,active:ye}),M({type:"onDragStart",event:g}),rt(Et.current),Fe(te)})},onMove(Y){N({type:V.DragMove,coordinates:Y})},onEnd:ge(V.DragEnd),onCancel:ge(V.DragCancel)});Et.current=ae;function ge(Y){return async function(){const{active:ue,collisions:l,over:g,scrollAdjustedTranslate:v}=Ce.current;let b=null;if(ue&&v){const{cancelDrop:E}=be.current;b={activatorEvent:te,active:ue,collisions:l,delta:v,over:g},Y===V.DragEnd&&typeof E=="function"&&await Promise.resolve(E(b))&&(Y=V.DragCancel)}ce.current=null,Ge.unstable_batchedUpdates(()=>{N({type:Y}),z(ze.Uninitialized),Xe(null),rt(null),Fe(null),Et.current=null;const E=Y===V.DragEnd?"onDragEnd":"onDragCancel";if(b){const C=be.current[E];C==null||C(b),M({type:E,event:b})}})}}},[j]),Ut=a.useCallback((B,U)=>(Z,me)=>{const ee=Z.nativeEvent,te=j.get(me);if(ce.current!==null||!te||ee.dndKit||ee.defaultPrevented)return;const ae={active:te};B(Z,U.options,ae)===!0&&(ee.dndKit={capturedBy:U.sensor},ce.current=me,re(Z,U))},[j,re]),jt=Rs(m,Ut);_s(m),je(()=>{se&&P===ze.Initializing&&z(ze.Initialized)},[se,P]),a.useEffect(()=>{const{onDragMove:B}=be.current,{active:U,activatorEvent:Z,collisions:me,over:ee}=Ce.current;if(!U||!Z)return;const te={active:U,activatorEvent:Z,collisions:me,delta:{x:Se.x,y:Se.y},over:ee};Ge.unstable_batchedUpdates(()=>{B==null||B(te),M({type:"onDragMove",event:te})})},[Se.x,Se.y]),a.useEffect(()=>{const{active:B,activatorEvent:U,collisions:Z,droppableContainers:me,scrollAdjustedTranslate:ee}=Ce.current;if(!B||ce.current==null||!U||!ee)return;const{onDragOver:te}=be.current,ae=me.get(Oe),ge=ae&&ae.rect.current?{id:ae.id,rect:ae.rect.current,data:ae.data,disabled:ae.disabled}:null,Y={active:B,activatorEvent:U,collisions:Z,delta:{x:ee.x,y:ee.y},over:ge};Ge.unstable_batchedUpdates(()=>{Xe(ge),te==null||te(Y),M({type:"onDragOver",event:Y})})},[Oe]),je(()=>{Ce.current={activatorEvent:J,active:le,activeNode:Q,collisionRect:xe,collisions:Ne,droppableRects:Re,draggableNodes:j,draggingNode:We,draggingNodeRect:oe,droppableContainers:W,over:de,scrollableAncestors:ve,scrollAdjustedTranslate:Se},X.current={initial:oe,translated:xe}},[le,Q,Ne,xe,j,We,oe,Re,W,de,ve,Se]),Ns({...Te,delta:$,draggingRect:xe,pointerCoordinates:ct,scrollableAncestors:ve,scrollableAncestorRects:Ye});const Yt=a.useMemo(()=>({active:le,activeNode:Q,activeNodeRect:se,activatorEvent:J,collisions:Ne,containerNodeRect:at,dragOverlay:he,draggableNodes:j,droppableContainers:W,droppableRects:Re,over:de,measureDroppableContainers:Me,scrollableAncestors:ve,scrollableAncestorRects:Ye,measuringConfiguration:ke,measuringScheduled:He,windowRect:lt}),[le,Q,se,J,Ne,at,he,j,W,Re,de,Me,ve,Ye,ke,He,lt]),ut=a.useMemo(()=>({activatorEvent:J,activators:jt,active:le,activeNodeRect:se,ariaDescribedById:{draggable:st},dispatch:N,draggableNodes:j,over:de,measureDroppableContainers:Me}),[J,jt,le,se,N,st,j,de,Me]);return K.createElement(qn.Provider,{value:k},K.createElement(St.Provider,{value:ut},K.createElement(fr.Provider,{value:Yt},K.createElement(Ht.Provider,{value:Nn},f)),K.createElement(Ks,{disabled:(c==null?void 0:c.restoreFocus)===!1})),K.createElement(qr,{...c,hiddenTextDescribedById:st}));function F(){const B=(nt==null?void 0:nt.autoScrollEnabled)===!1,U=typeof u=="object"?u.enabled===!1:u===!1,Z=O&&!B&&!U;return typeof u=="object"?{...u,enabled:Z}:{enabled:Z}}}),Gs=a.createContext(null),Hn="button",qs="Draggable";function Cn(e){let{id:t,data:n,disabled:r=!1,attributes:o}=e;const i=Ft(qs),{activators:d,activatorEvent:c,active:u,activeNodeRect:f,ariaDescribedById:m,draggableNodes:h,over:p}=a.useContext(St),{role:x=Hn,roleDescription:T="draggable",tabIndex:y=0}=o??{},D=(u==null?void 0:u.id)===t,N=a.useContext(D?Ht:Gs),[M,k]=Tt(),[P,z]=Tt(),O=Ps(d,t),R=pt(n);je(()=>(h.set(t,{id:t,key:i,node:M,activatorNode:P,data:R}),()=>{const $=h.get(t);$&&$.key===i&&h.delete(t)}),[h,t]);const j=a.useMemo(()=>({role:x,tabIndex:y,"aria-disabled":r,"aria-pressed":D&&x===Hn?!0:void 0,"aria-roledescription":T,"aria-describedby":m.draggable}),[r,x,y,D,T,m.draggable]);return{active:u,activatorEvent:c,activeNodeRect:f,attributes:j,isDragging:D,listeners:r?void 0:O,node:M,over:p,setNodeRef:k,setActivatorNodeRef:z,transform:N}}function Js(){return a.useContext(fr)}const Qs="Droppable",Zs={timeout:25};function mr(e){let{data:t,disabled:n=!1,id:r,resizeObserverConfig:o}=e;const i=Ft(Qs),{active:d,dispatch:c,over:u,measureDroppableContainers:f}=a.useContext(St),m=a.useRef({disabled:n}),h=a.useRef(!1),p=a.useRef(null),x=a.useRef(null),{disabled:T,updateMeasurementsFor:y,timeout:D}={...Zs,...o},N=pt(y??r),M=a.useCallback(()=>{if(!h.current){h.current=!0;return}x.current!=null&&clearTimeout(x.current),x.current=setTimeout(()=>{f(Array.isArray(N.current)?N.current:[N.current]),x.current=null},D)},[D]),k=Bt({callback:M,disabled:T||!d}),P=a.useCallback((j,$)=>{k&&($&&(k.unobserve($),h.current=!1),j&&k.observe(j))},[k]),[z,O]=Tt(P),R=pt(t);return a.useEffect(()=>{!k||!z.current||(k.disconnect(),h.current=!1,k.observe(z.current))},[z,k]),a.useEffect(()=>(c({type:V.RegisterDroppable,element:{id:r,key:i,disabled:n,node:z,rect:p,data:R}}),()=>c({type:V.UnregisterDroppable,key:i,id:r})),[r]),a.useEffect(()=>{n!==m.current.disabled&&(c({type:V.SetDroppableDisabled,id:r,key:i,disabled:n}),m.current.disabled=n)},[r,i,n,c]),{active:d,rect:p,isOver:(u==null?void 0:u.id)===r,node:z,over:u,setNodeRef:O}}function eo(e){let{animation:t,children:n}=e;const[r,o]=a.useState(null),[i,d]=a.useState(null),c=Ot(n);return!n&&!r&&c&&o(c),je(()=>{if(!i)return;const u=r==null?void 0:r.key,f=r==null?void 0:r.props.id;if(u==null||f==null){o(null);return}Promise.resolve(t(f,i)).then(()=>{o(null)})},[t,r,i]),K.createElement(K.Fragment,null,n,r?a.cloneElement(r,{ref:d}):null)}const to={x:0,y:0,scaleX:1,scaleY:1};function no(e){let{children:t}=e;return K.createElement(St.Provider,{value:ur},K.createElement(Ht.Provider,{value:to},t))}const ro={position:"fixed",touchAction:"none"},so=e=>vn(e)?"transform 250ms ease":void 0,oo=a.forwardRef((e,t)=>{let{as:n,activatorEvent:r,adjustScale:o,children:i,className:d,rect:c,style:u,transform:f,transition:m=so}=e;if(!c)return null;const h=o?f:{...f,scaleX:1,scaleY:1},p={...ro,width:c.width,height:c.height,top:c.top,left:c.left,transform:bt.Transform.toString(h),transformOrigin:o&&r?Qr(r,c):void 0,transition:typeof m=="function"?m(r):m,...u};return K.createElement(n,{className:d,style:p,ref:t},i)}),io=e=>t=>{let{active:n,dragOverlay:r}=t;const o={},{styles:i,className:d}=e;if(i!=null&&i.active)for(const[c,u]of Object.entries(i.active))u!==void 0&&(o[c]=n.node.style.getPropertyValue(c),n.node.style.setProperty(c,u));if(i!=null&&i.dragOverlay)for(const[c,u]of Object.entries(i.dragOverlay))u!==void 0&&r.node.style.setProperty(c,u);return d!=null&&d.active&&n.node.classList.add(d.active),d!=null&&d.dragOverlay&&r.node.classList.add(d.dragOverlay),function(){for(const[u,f]of Object.entries(o))n.node.style.setProperty(u,f);d!=null&&d.active&&n.node.classList.remove(d.active)}},ao=e=>{let{transform:{initial:t,final:n}}=e;return[{transform:bt.Transform.toString(t)},{transform:bt.Transform.toString(n)}]},lo={duration:250,easing:"ease",keyframes:ao,sideEffects:io({styles:{active:{opacity:"0"}}})};function co(e){let{config:t,draggableNodes:n,droppableContainers:r,measuringConfiguration:o}=e;return $t((i,d)=>{if(t===null)return;const c=n.get(i);if(!c)return;const u=c.node.current;if(!u)return;const f=dr(d);if(!f)return;const{transform:m}=ne(d).getComputedStyle(d),h=Qn(m);if(!h)return;const p=typeof t=="function"?t:uo(t);return or(u,o.draggable.measure),p({active:{id:i,data:c.data,node:u,rect:o.draggable.measure(u)},draggableNodes:n,dragOverlay:{node:d,rect:o.dragOverlay.measure(f)},droppableContainers:r,measuringConfiguration:o,transform:h})})}function uo(e){const{duration:t,easing:n,sideEffects:r,keyframes:o}={...lo,...e};return i=>{let{active:d,dragOverlay:c,transform:u,...f}=i;if(!t)return;const m={x:c.rect.left-d.rect.left,y:c.rect.top-d.rect.top},h={scaleX:u.scaleX!==1?d.rect.width*u.scaleX/c.rect.width:1,scaleY:u.scaleY!==1?d.rect.height*u.scaleY/c.rect.height:1},p={x:u.x-m.x,y:u.y-m.y,...h},x=o({...f,active:d,dragOverlay:c,transform:{initial:u,final:p}}),[T]=x,y=x[x.length-1];if(JSON.stringify(T)===JSON.stringify(y))return;const D=r==null?void 0:r({active:d,dragOverlay:c,...f}),N=c.node.animate(x,{duration:t,easing:n,fill:"forwards"});return new Promise(M=>{N.onfinish=()=>{D==null||D(),M()}})}}let Wn=0;function fo(e){return a.useMemo(()=>{if(e!=null)return Wn++,Wn},[e])}const an=K.memo(e=>{let{adjustScale:t=!1,children:n,dropAnimation:r,style:o,transition:i,modifiers:d,wrapperElement:c="div",className:u,zIndex:f=999}=e;const{activatorEvent:m,active:h,activeNodeRect:p,containerNodeRect:x,draggableNodes:T,droppableContainers:y,dragOverlay:D,over:N,measuringConfiguration:M,scrollableAncestors:k,scrollableAncestorRects:P,windowRect:z}=Js(),O=a.useContext(Ht),R=fo(h==null?void 0:h.id),j=hr(d,{activatorEvent:m,active:h,activeNodeRect:p,containerNodeRect:x,draggingNodeRect:D.rect,over:N,overlayNodeRect:D.rect,scrollableAncestors:k,scrollableAncestorRects:P,transform:O,windowRect:z}),$=Dn(p),W=co({config:r,draggableNodes:T,droppableContainers:y,measuringConfiguration:M}),H=$?D.setRef:void 0;return K.createElement(no,null,K.createElement(eo,{animation:W},h&&R?K.createElement(oo,{key:R,id:h.id,ref:H,as:c,activatorEvent:m,adjustScale:t,className:u,transition:i,rect:$,style:{zIndex:f,...o},transform:j},n):null))}),Un=e=>e.toString().padStart(2,"0");function xt(e,t=28){return e.length>t?e.slice(0,t)+"â€¦":e}const ho=[{title:"Dashboard",href:"/dashboard"},{title:"Schedules",href:"/schedule"}],ln=["January","February","March","April","May","June","July","August","September","October","November","December"],mo=new Date().getFullYear(),go=Array.from({length:9},(e,t)=>mo-4+t),Le=0,_t=24,po=30,De=(_t-Le)*60,we=44,Je="bg-zinc-100 dark:bg-zinc-900/90 hover:bg-zinc-200 dark:hover:bg-zinc-800 text-zinc-900 dark:text-zinc-100 ring-1 ring-zinc-300 dark:ring-zinc-700/40 shadow-sm",Sn="bg-zinc-200 dark:bg-zinc-900 hover:bg-zinc-300 dark:hover:bg-zinc-800 text-zinc-900 dark:text-zinc-100 ring-1 ring-zinc-400 dark:ring-zinc-700/40 shadow-sm ";function bo(){const e=[];for(let t=Le;t<_t;t++)for(let n=0;n<60;n+=po){const r=(t-Le)*60+n,o=_(new Date(2020,1,1,t,n,0),"h:mm a");e.push({label:o,minutes:r,isHour:n===0})}return e}const Ve=bo();function Qe(e){if(!e)return 0;const[t,n]=e.split(":").map(r=>parseInt(r,10));return(t-Le)*60+n}function Ie(e){if(!e)return"";const[t,n]=e.split(":"),r=new Date(2020,0,1,Number(t||0),Number(n||0),0);return _(r,"h:mm a")}function Yn(e){if(!e.length)return e;const t=[...e].sort((i,d)=>(i.start||"").localeCompare(d.start||"")||(i.end||"").localeCompare(d.end||""));let n=[],r=0;const o=()=>{if(!n.length)return;const i=r+1;n.forEach(d=>{const c=100/i;d.ev.__layout={leftPct:d.col*c,widthPct:c-1.5,top:0,height:0}}),n=[],r=0};for(const i of t){const d=Qe(i.start),c=i.end?Qe(i.end):d+30,u=Math.max(d+5,c);n=n.filter(h=>h.end>d);const f=new Set(n.map(h=>h.col));let m=0;for(;f.has(m);)m++;n.push({ev:i,start:d,end:u,col:m}),r=Math.max(r,m)}return o(),t}function Ze(e){if(!e)return"#064e3b";const t=e.replace("#","");if(t.length!==6)return"#064e3b";const n=parseInt(t.slice(0,2),16)/255,r=parseInt(t.slice(2,4),16)/255,o=parseInt(t.slice(4,6),16)/255;return .2126*Math.pow(n,2.2)+.7152*Math.pow(r,2.2)+.0722*Math.pow(o,2.2)>.55?"#1f2937":"#ffffff"}function vo(e){const t=e.replace("#","").match(/^([0-9a-fA-F]{6})$/);if(!t)return{r:37,g:99,b:235};const n=t[1];return{r:parseInt(n.slice(0,2),16),g:parseInt(n.slice(2,4),16),b:parseInt(n.slice(4,6),16)}}function xo(e){const t=(e.defense?"#059669":e.color||"#2563eb").toLowerCase();function n(m,h){const p=m.replace("#",""),x=parseInt(p,16);let T=(x>>16)+h,y=(x>>8&255)+h,D=(x&255)+h;return T=Math.max(0,Math.min(255,T)),y=Math.max(0,Math.min(255,y)),D=Math.max(0,Math.min(255,D)),"#"+((1<<24)+(T<<16)+(y<<8)+D).toString(16).slice(1)}const r=n(t,-30),{r:o,g:i,b:d}=vo(t),c=(.299*o+.587*i+.114*d)/255,u=c>.55?"#1f2937":"#ffffff",f=c>.55?"#111827":"rgba(255,255,255,0.85)";return{base:t,border:r,text:u,subText:f}}const cn="backdrop-blur supports-[backdrop-filter]:bg-white/85 bg-white/70 dark:bg-zinc-900/75 shadow-sm",mn=0,gr=52,dn=mn+gr;function Kn(){const e=document.querySelector('meta[name="csrf-token"]');return(e==null?void 0:e.content)||""}const gn=({event:e,editMode:t,onClick:n})=>{const{attributes:r,listeners:o,setNodeRef:i,isDragging:d}=Cn({id:e.id,data:{event:e,fromDate:e.date},disabled:!t||e.defense});return s.jsxs("div",{ref:i,...r,...o,className:L("px-1 py-0.5 rounded text-[10px] font-medium truncate flex items-center gap-1 cursor-grab active:cursor-grabbing",e.defense?Sn:Je,d&&"opacity-50"),style:e.defense?void 0:{backgroundColor:e.color||"#6ee7b7",color:Ze(e.color)},title:e.title,onClick:n,children:[e.defense&&s.jsx(yt,{className:"h-3 w-3"}),xt(e.title,26)]})},yo=({dateKey:e,children:t,editMode:n,isDragOver:r,activeDrag:o})=>{const{setNodeRef:i,isOver:d}=mr({id:e,disabled:!n});return s.jsxs("div",{ref:i,className:L("relative p-1 border-r border-b last:[&:nth-last-child(-n+7)]:border-b-0 cursor-pointer overflow-hidden focus:outline-none focus-visible:outline-none","bg-white dark:bg-zinc-900","border-zinc-200 dark:border-zinc-800",d&&"bg-blue-50 dark:bg-blue-900/20 ring-2 ring-blue-400 ring-inset"),style:{minHeight:120},children:[t,r&&o&&s.jsx("div",{className:"absolute left-1 right-1 top-7 z-30 pointer-events-none",style:{opacity:.6},children:s.jsx(gn,{event:o.event,editMode:!1})})]})},Xn=({dateKey:e,children:t,editMode:n,isDragOver:r,activeDrag:o})=>{const{setNodeRef:i,isOver:d}=mr({id:e,disabled:!n});return s.jsxs("div",{ref:i,className:L("relative h-full",d&&"bg-blue-50 dark:bg-blue-900/20 ring-2 ring-blue-400 ring-inset"),children:[t,r&&o&&s.jsx("div",{className:"absolute left-2 right-2 top-2 z-50 pointer-events-none",style:{opacity:.6},children:s.jsxs("div",{className:L("px-2 py-1 rounded text-[11px] font-medium truncate flex items-center gap-1 shadow-lg",Je),style:{backgroundColor:o.event.color||"#6ee7b7",color:Ze(o.event.color),border:"2px dashed #888"},children:[o.event.defense&&s.jsx(yt,{className:"h-3 w-3"}),xt(o.event.title,26),s.jsx("span",{className:"ml-1 text-[9px] text-muted-foreground",children:"(Preview)"})]})})]})},wo=({event:e,editMode:t,onClick:n})=>{const{attributes:r,listeners:o,setNodeRef:i,isDragging:d}=Cn({id:e.id,data:{event:e,fromDate:e.date},disabled:!t||e.defense}),c=e.__layout,u=Math.max(0,Qe(e.start)),f=Math.min(De,e.end?Qe(e.end):u+60),m=u/De*100,p=Math.max(5,f-u)/De*100;return s.jsxs("div",{ref:i,...r,...o,className:L("absolute rounded-md text-[11px] flex flex-col overflow-hidden cursor-grab active:cursor-grabbing",(e.defense,Je),"hover:ring-2 ring-primary/40","bg-white dark:bg-zinc-800","border border-zinc-200 dark:border-zinc-700",d&&"opacity-50 z-50"),style:{top:`calc(${m}% )`,height:`calc(${p}% )`,left:`calc(${(c==null?void 0:c.leftPct)??0}% )`,width:`calc(${(c==null?void 0:c.widthPct)??100}% )`,backgroundColor:e.defense?void 0:e.color||"#34d399",color:e.defense?void 0:Ze(e.color)},title:e.title,onClick:n,children:[s.jsxs("div",{className:"px-1 pt-1 flex items-start gap-1",children:[e.defense&&s.jsx(yt,{className:"h-3.5 w-3.5 shrink-0 text-emerald-900/80"}),s.jsx("span",{className:"font-semibold leading-tight truncate",children:xt(e.title,56)})]}),s.jsxs("div",{className:"px-1 pb-1 font-medium",children:[e.start&&Ie(e.start),e.end&&" â€“ "+Ie(e.end)]}),e.raw.student_name&&e.defense&&s.jsx("div",{className:"px-1 pb-1 truncate text-emerald-950/90 text-[10px]",children:xt(e.raw.student_name,40)})]})},Do=({event:e,editMode:t,onClick:n})=>{const{attributes:r,listeners:o,setNodeRef:i,isDragging:d}=Cn({id:e.id,data:{event:e,fromDate:e.date},disabled:!t||e.defense}),c=e.__layout,u=Math.max(0,Qe(e.start)),f=Math.min(De,e.end?Qe(e.end):u+60),m=u/De*100,p=Math.max(5,f-u)/De*100;return s.jsxs("div",{ref:i,...r,...o,className:L("absolute rounded-md p-2 text-[11px] flex flex-col overflow-hidden cursor-grab active:cursor-grabbing",e.defense?Sn:Je,"hover:ring-2 ring-primary/40","bg-white dark:bg-zinc-800","border border-zinc-200 dark:border-zinc-700",d&&"opacity-50 z-50"),style:{top:`calc(${m}% )`,height:`calc(${p}% )`,left:`calc(${(c==null?void 0:c.leftPct)??0}% )`,width:`calc(${(c==null?void 0:c.widthPct)??100}% )`,backgroundColor:e.defense?void 0:e.color||"#34d399",color:e.defense?void 0:Ze(e.color)},title:e.title,onClick:n,children:[s.jsxs("div",{className:"flex items-start gap-1",children:[e.defense&&s.jsx(yt,{className:"h-4 w-4 shrink-0"}),s.jsx("div",{className:"font-semibold leading-tight truncate text-[12px]",children:xt(e.title,80)})]}),s.jsxs("div",{className:"text-[11px] font-medium mt-0.5",children:[e.start&&Ie(e.start),e.end&&" â€“ "+Ie(e.end),e.raw.student_name&&e.defense&&" â€¢ "+e.raw.student_name]}),e.defense&&e.raw.student_name&&s.jsxs("div",{className:"text-[10px] truncate",children:[e.raw.student_name," ",e.raw.program&&s.jsxs("span",{className:"opacity-70",children:["(",e.raw.program,")"]})]}),e.defense&&e.raw.defense_type&&s.jsx("div",{className:"text-[10px] mt-0.5 uppercase tracking-wide",children:e.raw.defense_type})]})};function ki({canManage:e,userRole:t}){const[n,r]=a.useState([]),[o,i]=a.useState([]),[d,c]=a.useState([]),[u,f]=a.useState(new Date),[m,h]=a.useState(new Date),[p,x]=a.useState("week"),[T,y]=a.useState(!1),[D,N]=a.useState(!1),[M,k]=a.useState(!1),[P,z]=a.useState(""),[O,R]=a.useState(_(new Date,"yyyy-MM-dd")),[j,$]=a.useState("08:00"),[W,H]=a.useState("09:00"),[X,le]=a.useState(!1),[ce,nt]=a.useState(""),[rt,J]=a.useState(null),[Fe,be]=a.useState("#10b981"),st=["#10b981","#0ea5e9","#6366f1","#f59e0b","#ef4444","#d946ef","#14b8a6","#6d28d9"],[Be]=a.useState(""),[ke,Re]=a.useState(new Date);a.useEffect(()=>{const l=setInterval(()=>Re(new Date),6e4);return()=>clearInterval(l)},[]);const Me=a.useRef(null),He=a.useRef(null),[Q,ot]=a.useState({v:!1,y:0}),[Te,it]=a.useState({v:!1,y:0}),se=l=>{if(!Me.current)return;const g=Me.current.getBoundingClientRect(),v=Math.min(Math.max(0,l.clientY-g.top),g.height);ot({v:!0,y:v})},at=()=>ot({v:!1,y:0}),Ce=l=>{if(!He.current)return;const g=He.current.getBoundingClientRect(),v=Math.min(Math.max(0,l.clientY-g.top),g.height);it({v:!0,y:v})},Nt=()=>it({v:!1,y:0});a.useEffect(()=>{y(!0),fetch("/defense-requests/calendar").then(l=>l.json()).then(l=>r(l||[])).finally(()=>y(!1))},[]),a.useEffect(()=>{const l=Jt(u),g=Qt(u),v=`?from=${encodeURIComponent(l.toISOString())}&to=${encodeURIComponent(g.toISOString())}`;fetch("/api/calendar/events"+v).then(b=>b.json()).then(b=>{const E=w=>new Date(w.replace(" ","T")),C=b.filter(w=>w.origin==="event").map(w=>{const S=E(w.start),G=w.end?E(w.end):null;return{id:w.id,title:w.title||"Event",date:_(S,"yyyy-MM-dd"),start:_(S,"HH:mm"),end:G?_(G,"HH:mm"):void 0,raw:{id:Number((w.id||"").replace("ev-",""))||0,thesis_title:w.title,date_of_defense:_(S,"yyyy-MM-dd"),start_time:_(S,"HH:mm"),end_time:G?_(G,"HH:mm"):void 0,defense_type:void 0,defense_mode:void 0,defense_venue:void 0,program:void 0,student_name:void 0},color:w.color||"#2563eb",defense:!1,description:w.description??w.desc??w.details??w.detail??w.note??w.notes??""}});c(C)}).catch(()=>{})},[u]),a.useEffect(()=>{const l=n.map(g=>({id:"def-"+g.id,title:g.thesis_title||"Thesis Defense",date:g.date_of_defense,start:g.start_time?g.start_time.slice(0,5):void 0,end:g.end_time?g.end_time.slice(0,5):void 0,raw:g,defense:!0}));i([...l,...d])},[n,d]);const he=a.useMemo(()=>{if(!Be.trim())return o;const l=Be.toLowerCase();return o.filter(g=>g.title.toLowerCase().includes(l)||(g.raw.student_name||"").toLowerCase().includes(l)||(g.raw.program||"").toLowerCase().includes(l)||(g.raw.defense_type||"").toLowerCase().includes(l))},[o,Be]),We=a.useMemo(()=>{const l=kn(Jt(u),{weekStartsOn:0}),g=Lr(Qt(u),{weekStartsOn:0}),v=[];let b=l;for(;b<=g;){const E=[];for(let C=0;C<7;C++)E.push(b),b=Ae(b,1);v.push(E)}return v},[u]),oe=a.useMemo(()=>{const l={};return he.forEach(g=>{var v;(l[v=g.date]||(l[v]=[])).push(g)}),Object.values(l).forEach(g=>g.sort((v,b)=>(v.start||"23:59:59").localeCompare(b.start||"23:59:59"))),l},[he]),Ue=m?_(m,"yyyy-MM-dd"):"";a.useMemo(()=>Ue?oe[Ue]||[]:[],[oe,Ue]);const _e=a.useMemo(()=>{const g=kn(m||new Date,{weekStartsOn:0});return Array.from({length:7},(v,b)=>Ae(g,b))},[m]),lt=a.useMemo(()=>{const l={};return _e.forEach(g=>{const v=_(g,"yyyy-MM-dd");l[v]=(oe[v]||[]).map(b=>({...b})),Yn(l[v])}),l},[_e,oe]),ve=()=>{p==="month"?f(Ae(Jt(u),-1)):h(p==="week"?l=>Ae(l||new Date,-7):l=>Ae(l||new Date,-1))},Ye=()=>{p==="month"?f(Ae(Qt(u),1)):h(p==="week"?l=>Ae(l||new Date,7):l=>Ae(l||new Date,1))},Ke=()=>{const l=new Date;f(l),h(l)};a.useEffect(()=>{p==="month"&&m&&!Rn(m,u)&&h(u)},[p,u,m]);function ct(l,g=28){return l.length>g?l.slice(0,g)+"â€¦":l}const[ie,Wt]=a.useState(!1),[A,Se]=a.useState(null),[xe,Ne]=a.useState(null),Oe=()=>{Se(null),Ne(null)};a.useEffect(()=>{!D&&A&&Oe()},[D,A]);function de(l){l.active.data.current&&Se(l.active.data.current)}function Xe(l){const{active:g,over:v}=l;if(Oe(),!g||!v)return;const b=g.data.current;!b||b.event.defense||b.fromDate!==v.id&&(B({...b.event,date:v.id}),N(!0))}function dt(l){var g;(g=l.over)!=null&&g.id?Ne(l.over.id):Ne(null)}const re="border-zinc-200 dark:border-zinc-700",Ut=()=>{const l=We;return s.jsx(on,{collisionDetection:tn,onDragStart:de,onDragEnd:Xe,onDragOver:dt,children:s.jsxs("div",{className:"w-full border border-t-0 bg-white dark:bg-zinc-900 flex flex-col rounded-b-md rounded-t-none",children:[s.jsx("div",{className:L("grid border-b sticky z-40",cn,"bg-transparent"),style:{gridTemplateColumns:"repeat(7, 1fr)",top:dn},children:["SUN","MON","TUE","WED","THU","FRI","SAT"].map(g=>s.jsx("div",{className:L("h-12 border-r last:border-r-0 flex items-center justify-center text-[10px] font-semibold uppercase tracking-wide",re),children:g},g))}),s.jsx("div",{className:"grid grid-cols-7",children:l.map(g=>g.map(v=>{const b=_(v,"yyyy-MM-dd"),E=oe[b]||[];Rn(v,u);const C=Zt(v),w=m&&Mn(v,m);return s.jsxs(yo,{dateKey:b,editMode:ie,isDragOver:xe===b,activeDrag:A,children:[s.jsxs("div",{className:"flex items-start justify-between mb-0.5",children:[s.jsx("span",{className:L("w-6 h-6 rounded-full flex items-center justify-center text-[10px] font-semibold select-none",C&&"bg-rose-500 text-white shadow dark:bg-rose-500",!C&&w&&"bg-rose-500/80 text-white dark:bg-rose-500/80",!C&&!w&&"text-muted-foreground"),children:_(v,"d")}),E.length>3&&s.jsxs("span",{className:"text-[10px] text-muted-foreground mt-0.5",children:["+",E.length-3]})]}),s.jsx("div",{className:"space-y-0.5",children:E.slice(0,3).map(S=>s.jsx(gn,{event:S,editMode:ie,onClick:G=>{G.stopPropagation(),ie||(h(v),x("day"))}},S.id))})]},b)}))}),s.jsx(an,{children:A?s.jsx(gn,{event:A.event,editMode:!1}):null})]})})},jt=()=>{const g=Ve.length*we;let v=null;if(Q.v){const b=Math.min(De,Math.max(0,Q.y/g*De)),E=Math.round(b),C=Le+Math.floor(E/60),w=E%60,S=(C+11)%12+1,G=C>=12?"PM":"AM";v=`${S}:${Un(w)} ${G}`}return s.jsx(on,{collisionDetection:tn,onDragStart:de,onDragEnd:Xe,onDragOver:dt,children:s.jsxs("div",{className:"w-full border border-t-0 bg-white dark:bg-zinc-900 flex flex-col overflow-visible rounded-b-md rounded-t-none",children:[s.jsxs("div",{className:L("grid border-b sticky z-40",cn),style:{gridTemplateColumns:"90px repeat(7, 1fr)",top:dn},children:[s.jsx("div",{className:L("h-12 border-r flex items-center justify-center text-[10px] font-semibold uppercase tracking-wide text-muted-foreground",re),children:"TIME"}),_e.map(b=>{const E=m&&Mn(b,m),C=Zt(b);return s.jsxs("div",{className:L("h-12 border-r flex flex-col items-center justify-center gap-0.5 text-xs font-medium",E&&!C&&"bg-primary/5 dark:bg-rose-900/10",C&&"text-primary font-semibold",re),children:[s.jsx("span",{className:"uppercase tracking-wide text-[10px]",children:_(b,"EEE")}),s.jsx("span",{className:L("w-7 h-7 rounded-full flex items-center justify-center text-[12px] font-semibold",C&&"bg-rose-500 text-white shadow dark:bg-rose-500",!C&&E&&"bg-rose-500/80 text-white dark:bg-rose-500/80"),children:_(b,"d")})]},b.toISOString())})]}),s.jsxs("div",{ref:Me,className:"relative",style:{minHeight:g},onMouseMove:se,onMouseLeave:at,children:[s.jsx("div",{className:L("absolute left-0 top-0 bottom-0 border-r bg-white dark:bg-zinc-900 z-20",re),style:{width:90},children:Ve.map(b=>s.jsx("div",{className:"relative flex items-center justify-end pr-3",style:{height:we},children:s.jsx("span",{className:L("select-none text-[10px]",b.isHour?"font-semibold text-muted-foreground":"text-muted-foreground/50"),children:b.label.replace(":00","")})},b.minutes))}),s.jsxs("div",{className:"absolute top-0 bottom-0 right-0 grid",style:{left:90,gridTemplateColumns:"repeat(7, 1fr)"},children:[_e.map(b=>{const E=_(b,"yyyy-MM-dd"),C=lt[E]||[];return s.jsx(Xn,{dateKey:E,editMode:ie,isDragOver:xe===E,activeDrag:A,children:s.jsxs("div",{className:L("relative border-r h-full",Zt(b)&&"bg-primary/5 dark:bg-emerald-900/10",re,"bg-white dark:bg-zinc-900"),children:[Array.from({length:_t-Le},(w,S)=>S%2===1?s.jsx("div",{className:"absolute inset-x-0 bg-muted/15 dark:bg-zinc-800/30",style:{top:S*2*we,height:we*2}},"stripe-"+S):null),Ve.map((w,S)=>s.jsx("div",{className:L("absolute left-0 right-0",w.isHour?`${re} border-b-2`:`${re} border-b`),style:{top:S*we}},w.minutes)),C.map(w=>s.jsx(wo,{event:w,editMode:ie,onClick:S=>{S.stopPropagation(),ie||(e&&!w.defense?B(w):(h($e(w.date)),Z(w),x("day")))}},w.id))]})},"week-col-"+E)}),Q.v&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"pointer-events-none absolute left-0 right-0 h-px bg-black/60 z-40",style:{top:Q.y}}),v&&s.jsx("div",{className:"pointer-events-none absolute z-50 -translate-y-1/2 px-1.5 py-0.5 bg-black text-white rounded text-[10px] font-medium shadow",style:{top:Q.y,left:4},children:v})]})]})]}),s.jsx(an,{children:A?s.jsxs("div",{className:L("absolute rounded-md text-[11px] flex flex-col overflow-hidden shadow-lg",Je),style:{backgroundColor:A.event.defense?void 0:A.event.color||"#34d399",color:A.event.defense?void 0:Ze(A.event.color),padding:"4px 8px",minWidth:"120px",maxWidth:"200px"},children:[s.jsx("div",{className:"font-semibold leading-tight truncate",children:ct(A.event.title,40)}),s.jsxs("div",{className:"font-medium text-[10px]",children:[A.event.start&&Ie(A.event.start),A.event.end&&" â€“ "+Ie(A.event.end)]})]}):null})]})})},Yt=()=>{const l=m||new Date,g=_(l,"yyyy-MM-dd"),v=Yn((oe[g]||[]).map(C=>({...C}))),b=Ve.length*we;let E=null;if(Te.v){const C=Math.min(De,Math.max(0,Te.y/b*De)),w=Math.round(C),S=Le+Math.floor(w/60),G=w%60,ft=(S+11)%12+1,Kt=S>=12?"PM":"AM";E=`${ft}:${Un(G)} ${Kt}`}return s.jsx(on,{collisionDetection:tn,onDragStart:de,onDragEnd:Xe,onDragOver:dt,children:s.jsxs("div",{className:"w-full border border-t-0 bg-white dark:bg-zinc-900 flex flex-col rounded-b-md rounded-t-none",children:[s.jsxs("div",{className:L("sticky flex items-center justify-between px-6 py-4 border-b z-40",cn,re),style:{top:dn},children:[s.jsxs("div",{className:"flex items-end gap-4",children:[s.jsx("div",{className:"flex flex-col leading-none",children:s.jsx("span",{className:"text-4xl font-bold tracking-tight",children:_(l,"d")})}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-lg font-semibold",children:_(l,"MMMM")}),s.jsx("span",{className:"text-sm text-muted-foreground",children:_(l,"EEEE, yyyy")})]})]}),s.jsx(vr,{variant:"secondary",className:"text-[11px] px-3 py-1",children:"Approved Defenses"})]}),s.jsx("div",{ref:He,className:"relative",onMouseMove:Ce,onMouseLeave:Nt,children:s.jsx(Xn,{dateKey:g,editMode:ie,isDragOver:xe===g,activeDrag:A,children:s.jsxs("div",{className:"relative",style:{minHeight:b},children:[s.jsx("div",{className:L("absolute left-0 top-0 bottom-0 w-[90px] border-r bg-white dark:bg-zinc-900 z-20",re),children:Ve.map(C=>s.jsx("div",{className:"relative flex items-center justify-end pr-3",style:{height:we},children:s.jsx("span",{className:L("text-[11px] select-none",C.isHour?"font-semibold text-muted-foreground":"text-muted-foreground/50"),children:C.label.replace(":00","")})},C.minutes))}),s.jsxs("div",{className:"absolute left-[90px] right-0 top-0 bottom-0 bg-white dark:bg-zinc-900",children:[Array.from({length:_t-Le},(C,w)=>w%2===1?s.jsx("div",{className:"absolute inset-x-0 bg-muted/15 dark:bg-zinc-800/30",style:{top:w*2*we,height:we*2}},"stripe-"+w):null),Ve.map((C,w)=>s.jsx("div",{className:L("absolute left-0 right-0",C.isHour?`${re} border-b-2`:`${re} border-b`),style:{top:w*we}},C.minutes)),v.map(C=>s.jsx(Do,{event:C,editMode:ie,onClick:w=>{w.stopPropagation(),ie||(e&&!C.defense?B(C):Z(C))}},C.id)),Te.v&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"pointer-events-none absolute left-0 right-0 h-px bg-black/60 z-40",style:{top:Te.y}}),E&&s.jsx("div",{className:"pointer-events-none absolute z-50 -translate-y-1/2 px-1.5 py-0.5 bg-black text-white rounded text-[10px] font-medium shadow",style:{top:Te.y,left:4},children:E})]})]})]})})}),s.jsx(an,{children:A?s.jsxs("div",{className:L("absolute rounded-md p-2 text-[11px] flex flex-col overflow-hidden shadow-lg",Sn),style:{backgroundColor:A.event.defense?void 0:A.event.color||"#34d399",color:A.event.defense?void 0:Ze(A.event.color),minWidth:"150px",maxWidth:"250px"},children:[s.jsx("div",{className:"font-semibold leading-tight truncate text-[12px]",children:ct(A.event.title,60)}),s.jsxs("div",{className:"text-[11px] font-medium mt-0.5",children:[A.event.start&&Ie(A.event.start),A.event.end&&" â€“ "+Ie(A.event.end)]})]}):null})]})})},ut=a.useRef(null),[F,B]=a.useState(null),[U,Z]=a.useState(null),[me,ee]=a.useState(!1),[te,ae]=a.useState(!1),ge=!!F,Y=()=>{!U||me||(ee(!0),setTimeout(()=>{Z(null),ee(!1)},180))};a.useEffect(()=>{if(U){ee(!1),ae(!0);const l=requestAnimationFrame(()=>ae(!1));return()=>cancelAnimationFrame(l)}},[U]),a.useEffect(()=>{if(!U)return;const l=v=>{ut.current&&!ut.current.contains(v.target)&&Y()},g=v=>{v.key==="Escape"&&Y()};return document.addEventListener("mousedown",l),document.addEventListener("keydown",g),()=>{document.removeEventListener("mousedown",l),document.removeEventListener("keydown",g)}},[U]);const ye=U&&p==="day"?Ge.createPortal(s.jsx("div",{ref:ut,className:L("fixed right-4 w-[400px] max-h-[82vh] flex flex-col rounded-lg overflow-hidden shadow-lg border z-[2500]","transition-all duration-200 ease-out will-change-transform will-change-opacity origin-top",te||me?"opacity-0 translate-y-2 scale-[0.97]":"opacity-100 translate-y-0 scale-100"),style:{top:mn+gr+14},children:(()=>{const l=U,g=xo(l),v=_($e(l.date),"PPP"),b=(l.start?_($e("2020-01-01T"+l.start),"h:mm a"):"")+(l.end?" â€“ "+_($e("2020-01-01T"+l.end),"h:mm a"):(l.start,"")),E=l.description&&l.description.trim()||"â€”";return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"px-4 py-3 flex items-start gap-3",style:{background:g.base,borderBottom:`1px solid ${g.border}`,color:g.text},children:[s.jsx("div",{className:"mt-0.5 shrink-0",children:l.defense?s.jsx(yt,{className:"h-5 w-5",style:{color:g.text}}):s.jsx(jn,{className:"h-5 w-5",style:{color:g.text}})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h2",{className:"font-semibold text-sm leading-snug pr-6",style:{color:g.text},title:l.title,children:l.title}),s.jsxs("div",{className:"text-[11px] font-medium mt-0.5",style:{color:g.subText},children:[v,b&&" â€¢ "+b]})]}),s.jsx(Ee,{variant:"ghost",size:"icon",className:"h-7 w-7 -m-1",onClick:Y,children:s.jsx(Er,{className:"h-4 w-4"})})]}),s.jsx("div",{className:"flex-1 overflow-y-auto p-4 bg-white dark:bg-zinc-900 text-zinc-900 dark:text-zinc-100",children:s.jsx("div",{className:"space-y-4",children:s.jsxs("div",{className:"space-y-3",children:[s.jsx("div",{className:"text-xs font-semibold uppercase tracking-wide text-muted-foreground",children:l.defense?"Defense Details":"Event Details"}),s.jsxs("dl",{className:"grid grid-cols-3 gap-x-2 gap-y-1 text-[11px]",children:[s.jsx("dt",{className:"font-medium text-muted-foreground",children:"Date"}),s.jsx("dd",{className:"col-span-2",children:v}),s.jsx("dt",{className:"font-medium text-muted-foreground",children:"Time"}),s.jsx("dd",{className:"col-span-2",children:b||"â€”"}),l.defense&&s.jsxs(s.Fragment,{children:[s.jsx("dt",{className:"font-medium text-muted-foreground",children:"Student"}),s.jsx("dd",{className:"col-span-2",children:l.raw.student_name||"â€”"}),s.jsx("dt",{className:"font-medium text-muted-foreground",children:"Program"}),s.jsx("dd",{className:"col-span-2",children:l.raw.program||"â€”"}),s.jsx("dt",{className:"font-medium text-muted-foreground",children:"Type"}),s.jsx("dd",{className:"col-span-2 uppercase",children:l.raw.defense_type||"â€”"}),s.jsx("dt",{className:"font-medium text-muted-foreground",children:"Mode"}),s.jsx("dd",{className:"col-span-2",children:l.raw.defense_mode||"â€”"}),s.jsx("dt",{className:"font-medium text-muted-foreground",children:"Venue"}),s.jsx("dd",{className:"col-span-2",children:l.raw.defense_venue||"â€”"})]}),s.jsx("dt",{className:"font-medium text-muted-foreground",children:"Description"}),s.jsx("dd",{className:"col-span-2 whitespace-pre-wrap",children:E})]})]})})})]})})()}),document.body):null;a.useEffect(()=>{F&&(N(!0),z(F.title),R(F.date),le(!1),$(F.start?F.start.slice(0,5):"08:00"),H(F.end?F.end.slice(0,5):F.start?F.start.slice(0,5):"09:00"),nt(F.description||""),be(F.color||"#10b981"))},[F]),a.useEffect(()=>{!D&&F&&B(null)},[D,F]);const ue=()=>{try{const l=[...he].slice().sort((S,G)=>S.date===G.date?(S.start||"23:59").localeCompare(G.start||"23:59"):S.date.localeCompare(G.date)),g=S=>(S||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),v=l.map(S=>{const G=_($e(S.date),"MMM d, yyyy"),ft=(S.start?_($e("2020-01-01T"+S.start),"h:mm a"):"")+(S.end?" â€“ "+_($e("2020-01-01T"+S.end),"h:mm a"):"");return`<tr>
          <td>${g(G)}</td>
          <td>${g(ft)}</td>
          <td>${g(S.title)}</td>
          <td>${g(S.raw.student_name||"â€”")}</td>
          <td>${g(S.raw.program||"â€”")}</td>
          <td>${g(S.raw.defense_type||"â€”")}</td>
          <td>${g(S.raw.defense_venue||S.raw.defense_mode||"â€”")}</td>
        </tr>`}).join("")||'<tr><td colspan="7" style="text-align:center;padding:16px;color:#666;">No scheduled defenses.</td></tr>',b=`<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<title>Schedules Print</title>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<style>
  * { box-sizing:border-box; font-family: system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif; }
  body { margin:24px; color:#111; }
  h1 { margin:0 0 16px; font-size:20px; }
  table { border-collapse:collapse; width:100%; font-size:12px; }
  thead th { background:#f1f5f9; text-align:left; padding:6px 8px; font-weight:600; border:1px solid #dbe1e6; }
  td { padding:6px 8px; border:1px solid #e2e8f0; vertical-align:top; }
  tbody tr:nth-child(even) { background:#fafafa; }
  @media print { body { margin:8px 16px; } }
</style>
</head>
<body>
<h1>Schedules (${l.length})</h1>
<table>
  <thead>
    <tr>
      <th>Date</th><th>Time</th><th>Title</th><th>Student</th><th>Program</th><th>Type</th><th>Venue / Mode</th>
    </tr>
  </thead>
  <tbody>${v}</tbody>
</table>
<script>window.addEventListener('load',()=>{setTimeout(()=>window.print(),120);});<\/script>
</body>
</html>`,E=new Blob([b],{type:"text/html"}),C=URL.createObjectURL(E);if(!window.open(C,"_blank")){alert("Pop-up blocked. Allow pop-ups to print."),URL.revokeObjectURL(C);return}setTimeout(()=>URL.revokeObjectURL(C),5e3)}catch(l){console.error("Print failed",l),alert("Print failed.")}};return s.jsxs(br,{breadcrumbs:ho,children:[s.jsx(pr,{title:"Schedules"}),s.jsx("div",{className:"flex flex-col gap-0 bg-white dark:bg-zinc-900 min-h-screen",children:T?s.jsxs("div",{className:"w-full min-h-[70vh] bg-zinc-100 dark:bg-zinc-900 flex flex-col gap-4 p-0 m-0",children:[s.jsx(Rt,{className:"h-6 w-1/6 rounded bg-zinc-300 dark:bg-zinc-800 mt-8 mx-8"}),s.jsx(Rt,{className:"h-12 w-3/4 rounded bg-zinc-300 dark:bg-zinc-800 mx-8"}),s.jsx(Rt,{className:"h-12 w-2/3 rounded bg-zinc-300 dark:bg-zinc-800 mx-8"}),s.jsx(Rt,{className:"h-[500px] w-full rounded bg-zinc-300 dark:bg-zinc-800 mt-4"})]}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:L("flex flex-wrap items-center gap-2 w-full bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-md rounded-b-none px-3 py-2 sticky z-50","shadow-sm"),style:{top:mn},children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Ee,{size:"icon",variant:"outline",onClick:ve,children:s.jsx(jr,{className:"h-4 w-4"})}),s.jsx(Ee,{size:"icon",variant:"outline",onClick:Ye,children:s.jsx(kr,{className:"h-4 w-4"})}),s.jsx(Ee,{className:"hover:cursor-pointer",variant:"outline",onClick:Ke,children:"Today"})]}),s.jsx("div",{className:"inline-flex rounded-md border border-zinc-200 dark:border-zinc-800 overflow-hidden h-8",children:[{key:"day",label:"Day",icon:s.jsx(Rr,{className:"mr-1 h-4 w-4"})},{key:"week",label:"Week",icon:s.jsx(_r,{className:"mr-1 h-4 w-4"})},{key:"month",label:"Month",icon:s.jsx(jn,{className:"mr-1 h-4 w-4"})}].map(l=>s.jsxs("button",{type:"button",onClick:()=>x(l.key),className:L("px-3 text-xs font-medium uppercase tracking-wide  focus:outline-none flex items-center cursor-pointer",p===l.key?"bg-primary text-white dark:bg-rose-500 dark:text-white":"bg-white dark:bg-zinc-900 hover:bg-muted/60 dark:hover:bg-zinc-800 text-muted-foreground"),children:[l.icon,l.label]},l.key))}),p==="month"&&s.jsxs("div",{className:"flex items-center gap-2 ml-2",children:[s.jsxs(Xt,{value:ln[u.getMonth()],onValueChange:l=>{const g=ln.indexOf(l);g!==-1&&f(new Date(u.getFullYear(),g,1))},children:[s.jsx(Vt,{className:"w-[120px] h-8",children:s.jsx(Gt,{placeholder:"Month"})}),s.jsx(qt,{children:ln.map(l=>s.jsx(kt,{value:l,children:l},l))})]}),s.jsxs(Xt,{value:u.getFullYear().toString(),onValueChange:l=>f(new Date(Number(l),u.getMonth(),1)),children:[s.jsx(Vt,{className:"w-[90px] h-8",children:s.jsx(Gt,{placeholder:"Year"})}),s.jsx(qt,{children:go.map(l=>s.jsx(kt,{value:l.toString(),children:l},l))})]})]}),e&&s.jsxs("div",{className:"flex items-center gap-2 ml-auto",children:[s.jsxs(Xt,{value:ie?"editing":"viewing",onValueChange:l=>Wt(l==="editing"),children:[s.jsx(Vt,{className:" h-8",children:s.jsx(Gt,{})}),s.jsxs(qt,{children:[s.jsxs(kt,{value:"viewing",children:[s.jsx(Tr,{className:"inline-block mr-2 h-4 w-4"}),"Viewing"]}),s.jsxs(kt,{value:"editing",children:[s.jsx(Or,{className:"inline-block mr-2 h-4 w-4"}),"Editing"]})]})]}),s.jsx(Ee,{type:"button",size:"icon",variant:"outline",onClick:ue,title:"Print schedules",children:s.jsx(Ar,{className:"h-4 w-4 hover:cursor-printer"})}),s.jsxs(xr,{open:D,onOpenChange:l=>{N(l),J(null),l||(B(null),Oe())},children:[s.jsx(yr,{asChild:!0,children:s.jsx(Ee,{className:"hover:cursor-pointer dark:bg-rose",size:"sm",children:ge?"Edit Event":"Add Event"})}),s.jsxs(wr,{className:"sm:max-w-md",children:[s.jsx(Dr,{children:s.jsx(Cr,{className:"text-sm font-semibold",children:ge?"Edit Event":"Create Event"})}),s.jsxs("div",{className:"space-y-3 py-1",children:[rt&&s.jsx("div",{className:"text-[11px] text-red-600 bg-red-50 border border-red-200 px-2 py-1 rounded",children:rt}),s.jsxs("div",{className:"grid gap-1",children:[s.jsx(Pe,{className:"text-xs",children:"Title"}),s.jsx(En,{value:P,onChange:l=>z(l.target.value),placeholder:"Short description..."})]}),s.jsxs("div",{className:"grid gap-1",children:[s.jsx(Pe,{className:"text-xs",children:"Date"}),s.jsx("input",{type:"date",className:"border rounded px-2 py-1 text-sm",value:O,onChange:l=>R(l.target.value)})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Nr,{checked:X,onCheckedChange:l=>le(!!l),id:"allDay"}),s.jsx(Pe,{htmlFor:"allDay",className:"text-xs",children:"All Day"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[s.jsxs("div",{children:[s.jsx(Pe,{className:"text-xs",children:"Start Time"}),s.jsx("input",{type:"time",className:"border rounded px-2 py-1 text-sm w-full",value:j,onChange:l=>$(l.target.value),disabled:X})]}),s.jsxs("div",{children:[s.jsx(Pe,{className:"text-xs",children:"End Time"}),s.jsx("input",{type:"time",className:"border rounded px-2 py-1 text-sm w-full",value:W,onChange:l=>H(l.target.value),disabled:X})]})]}),s.jsxs("div",{className:"grid gap-1",children:[s.jsx(Pe,{className:"text-xs",children:"Description"}),s.jsx(En,{value:ce,onChange:l=>nt(l.target.value),placeholder:"Details (optional)..."})]}),s.jsxs("div",{className:"grid gap-1",children:[s.jsx(Pe,{className:"text-xs",children:"Color"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:st.map(l=>s.jsx("button",{type:"button",onClick:()=>be(l),className:L("w-6 h-6 rounded-full ring-2 transition",Fe===l?"ring-black scale-110":"ring-transparent hover:ring-gray-400"),style:{backgroundColor:l},"aria-label":`Choose ${l}`},l))})]})]}),s.jsxs(Sr,{className:"gap-2",children:[ge&&s.jsxs(Ee,{type:"button",variant:"destructive",size:"sm",onClick:async()=>{if(F&&confirm("Delete this event?")){k(!0);try{const l=Kn();if(!(await fetch(`/api/calendar/events/${F.raw.id}`,{method:"DELETE",headers:{Accept:"application/json","X-CSRF-TOKEN":l}})).ok)throw new Error("Delete failed");c(v=>v.filter(b=>b.raw.id!==F.raw.id)),N(!1),B(null)}catch(l){J(l.message||"Delete failed")}finally{k(!1)}}},children:[s.jsx(zr,{className:"h-4 w-4 mr-1"})," Delete"]}),s.jsx(Ee,{variant:"outline",size:"sm",onClick:()=>{N(!1),Oe()},disabled:M,children:"Cancel"}),s.jsx(Ee,{size:"sm",onClick:async()=>{if(!P.trim()){J("Title required.");return}if(!O){J("Date required.");return}if(!X&&W<=j){J("End must be after start.");return}J(null),k(!0);try{const l=Kn(),g={title:P.trim(),description:ce.trim()||null,start:X?`${O} 00:00:00`:`${O} ${j}:00`,end:X?`${O} 23:59:59`:`${O} ${W}:00`,allDay:X,color:Fe};let v;if(ge&&F?v=await fetch(`/api/calendar/events/${F.raw.id}`,{method:"PUT",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":l},body:JSON.stringify(g)}):v=await fetch("/api/calendar/events",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":l},body:JSON.stringify(g)}),!v.ok){const S=await v.json().catch(()=>({}));throw new Error(S.message||S.error||"Save failed")}const E=(await v.json().catch(()=>({}))).event_id||F&&F.raw.id,C=X?"00:00":j,w=X?"23:59":W;c(S=>{const G=S.filter(Kt=>Kt.raw.id!==E),ft={id:"ev-"+E,title:P.trim(),date:O,start:C,end:w,raw:{id:E,thesis_title:P.trim(),date_of_defense:O,start_time:C,end_time:w,defense_type:void 0,defense_mode:void 0,defense_venue:void 0,program:void 0,student_name:void 0},color:Fe,defense:!1,description:ce.trim()};return[...G,ft]}),N(!1),B(null),Oe()}catch(l){J(l.message||"Error")}finally{k(!1)}},disabled:M,children:M?"Saving...":"Save Event"})]})]})]})]})]}),p==="month"&&Ut(),p==="week"&&jt(),p==="day"&&Yt(),ye,!1]})})]})}export{ki as default};
