import{K as X,r as i,a as K,j as e,L as Q,S as b}from"./app-DW0Mt5c9.js";import{A as G}from"./app-layout-CPwLq_xH.js";import{B as o}from"./button-BZf0VdIO.js";import{I as H}from"./input-Ch6RmxP_.js";import J from"./panelists-list-table-DRITmeYC.js";import V from"./panelists-form-modal-DeAezazX.js";import{T as W,t as d}from"./index-ByTeG7FR.js";import{P as F,a as L,b as E}from"./popover-D7yVk8xU.js";import{C as D}from"./checkbox-fbuYKHl8.js";import{U as Y}from"./users-CFj_s0Ga.js";import{U as Z}from"./user-plus-ghgo2mQ3.js";import{S as _}from"./search-Ck6Ms1BF.js";import{C as R}from"./circle-plus-BLUyT9nm.js";import{X as T}from"./x-CW6T59GI.js";import{T as ee}from"./trash-2-lOnE2GCJ.js";import{C as se}from"./circle-check-big-CG9wjNDm.js";import{C as te}from"./circle-x-C4V9EZEC.js";import"./index-RzYQM1sh.js";import"./index-DZZQifJx.js";import"./utils-jAU0Cazi.js";import"./index-BMNAwHVU.js";import"./index-DHu7YzAG.js";import"./index-Bh88FqJG.js";import"./tooltip-3yEC6fE6.js";import"./floating-ui.react-dom-DEJ-U2zP.js";import"./createLucideIcon-S0dKkUVo.js";import"./separator-4d5ucxHB.js";import"./index-xrb8sl6P.js";import"./chevron-right-x7vIKCyG.js";import"./dropdown-menu-FJcetjAu.js";import"./index-dxfJWdT_.js";import"./index-I9YLalqX.js";import"./index-Au_TdUcj.js";import"./index-Bwn0NV8Z.js";import"./check-C1Ca0PY3.js";import"./avatar-B3rD_VQk.js";import"./settings-DPsrAkv5.js";import"./graduation-cap-d15gjgNL.js";import"./file-text-Dpj0IN7n.js";import"./dollar-sign-DVIUp7aq.js";import"./send-BUfb6BoG.js";import"./credit-card-Bzx9FpUt.js";import"./tabs-3Dm9feNm.js";import"./badge-B7OUzsXL.js";import"./info-Dl-vg0Zq.js";import"./sun-C_6rnlvD.js";import"./table-CYsX4eCK.js";import"./dialog-D7L72BhV.js";import"./pencil-C6zzAshF.js";import"./user-IcA54EZW.js";import"./mail-DTFdjxel.js";import"./message-circle-BbBLgXPg.js";import"./refresh-cw-CQGNcdhP.js";import"./loader-circle-EY4lXEgZ.js";import"./label-Dk8neUpq.js";import"./index-D1ThX8Vn.js";const re=[{title:"Dashboard",href:"/dashboard"},{title:"Panelists",href:"/panelists"}];function ls(){const{panelists:y=[],paymentRates:j=[]}=X().props,[w,u]=i.useState(y),[p,x]=i.useState([]),[U,h]=i.useState(!1),[B,f]=i.useState(null),[N,C]=i.useState(""),[c,m]=i.useState(!1),[k,g]=i.useState(!1),[M,A]=i.useState(j),[l,v]=i.useState([]),[n,S]=i.useState([]);i.useEffect(()=>{u(y)},[y]),i.useEffect(()=>{if(j&&j.length>0)return;let s=!0;return K.get("/dean/payment-rates/data").then(t=>{var a;if(!s)return;const r=Array.isArray((a=t.data)==null?void 0:a.rates)?t.data.rates:[];A(r)}).catch(()=>A([])),()=>{s=!1}},[j]);const P=i.useMemo(()=>{const s=N.trim().toLowerCase();let t=w;return l.length>0&&(t=t.filter(r=>Array.isArray(r.assignments)&&r.assignments.some(a=>a.role&&l.includes(a.role))||!Array.isArray(r.assignments)&&l.includes(r.role))),n.length>0&&(t=t.filter(r=>{const a=Array.isArray(r.assignments)&&r.assignments.length>0;return n.includes("Assigned")&&a||n.includes("Not Assigned")&&!a})),s&&(t=t.filter(r=>r.name.toLowerCase().includes(s)||r.email.toLowerCase().includes(s)||r.status.toLowerCase().includes(s))),t},[N,w,l,n]),$=i.useMemo(()=>P.map(s=>({...s,assignments:(s.assignments||[]).map(t=>({...t,type:t.type??t.role??s.role}))})),[P]);function I(s,t,r){g(!0),t?b.put(`/panelists/${t}`,s,{preserveScroll:!0,onSuccess:a=>{d.success("Panelist updated"),h(!1),f(null),u(Array.isArray(a.props.panelists)?a.props.panelists:[]),g(!1),r&&r()},onError:()=>{d.error("Failed to update panelist"),g(!1),r&&r()}}):b.post("/panelists",s,{preserveScroll:!0,onSuccess:a=>{d.success("Panelist added"),h(!1),f(null),u(Array.isArray(a.props.panelists)?a.props.panelists:[]),g(!1),r&&r()},onError:()=>{d.error("Failed to add panelist"),g(!1),r&&r()}})}function q(s){m(!0),b.delete(`/panelists/${s}`,{preserveScroll:!0,onSuccess:t=>{d.success("Panelist deleted"),x(r=>r.filter(a=>a!==s)),u(Array.isArray(t.props.panelists)?t.props.panelists:[]),m(!1)},onError:()=>{d.error("Failed to delete panelist"),m(!1)}})}function O(){p.length!==0&&window.confirm("Delete selected panelists?")&&(m(!0),b.post("/panelists/bulk-delete",{ids:p},{preserveScroll:!0,onSuccess:s=>{d.success("Panelists deleted"),x([]),u(Array.isArray(s.props.panelists)?s.props.panelists:[]),m(!1)},onError:()=>{d.error("Failed to bulk delete"),m(!1)}}))}function z(s){p.length!==0&&(m(!0),b.post("/panelists/bulk-status",{ids:p,status:s},{preserveScroll:!0,onSuccess:t=>{d.success("Panelists status updated"),x([]),u(Array.isArray(t.props.panelists)?t.props.panelists:[]),m(!1)},onError:()=>{d.error("Failed to update status"),m(!1)}}))}return e.jsxs(G,{breadcrumbs:re,children:[e.jsx(Q,{title:"Panelists"}),e.jsx(W,{richColors:!0,position:"bottom-right"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 overflow-auto rounded-xl pt-5 pr-7 pl-7 relative bg-background",children:[e.jsxs("div",{className:"w-full bg-white dark:bg-zinc-900 border border-border dark:border-border rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"flex flex-row items-center justify-between w-full p-3 border-b bg-white dark:bg-zinc-900 dark:border-border",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-10 w-10 flex items-center justify-center rounded-full bg-rose-500/10 dark:bg-rose-900 border border-rose-500",children:e.jsx(Y,{className:"h-5 w-5 text-rose-400"})}),e.jsxs("div",{children:[e.jsx("span",{className:"text-base font-semibold",children:"Panelists"}),e.jsx("span",{className:"block text-xs text-muted-foreground dark:text-muted-foreground",children:"This section shows all defense panelists. Add, search, and manage panelists."})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(o,{onClick:()=>{h(!0),f(null)},disabled:k||c,children:[e.jsx(Z,{className:"h-4 w-4"})," ",k?"Loading...":"Add Panel"]})})]}),e.jsx("div",{className:"flex items-center justify-between gap-2 px-4 py-3 border-b bg-white dark:bg-zinc-900 dark:border-border",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(H,{type:"text",startIcon:_,placeholder:"Search...",value:N,onChange:s=>C(s.target.value),className:"max-w-xs text-sm h-8",disabled:c}),e.jsxs(F,{children:[e.jsx(L,{asChild:!0,children:e.jsxs(o,{variant:"outline",className:"h-8 px-3 rounded-md border-dashed text-xs flex items-center gap-1",children:[e.jsx(R,{className:"h-4 w-4 mr-1"}),"Role",l.length>0&&e.jsx("span",{className:"ml-1 px-2 py-0.5 rounded-full text-xs bg-muted dark:bg-zinc-800",children:l.length>1?`${l.length} selected`:l[0]})]})}),e.jsxs(E,{className:"w-44 p-1 dark:bg-zinc-900 dark:text-muted-foreground",side:"bottom",align:"start",children:[["Chairperson","Panel Member"].map(s=>e.jsxs("div",{onClick:()=>v(t=>t.includes(s)?t.filter(r=>r!==s):[...t,s]),className:"flex items-center gap-2 p-2 rounded hover:bg-muted dark:hover:bg-zinc-800 cursor-pointer",children:[e.jsx(D,{checked:l.includes(s)}),e.jsx("span",{className:"text-sm",children:s})]},s)),e.jsx(o,{size:"sm",variant:"ghost",className:"w-full mt-2",onClick:()=>v([]),children:"Clear"})]})]}),e.jsxs(F,{children:[e.jsx(L,{asChild:!0,children:e.jsxs(o,{variant:"outline",className:"h-8 px-3 rounded-md border-dashed text-xs flex items-center gap-1",children:[e.jsx(R,{className:"h-4 w-4 mr-1"}),"Status",n.length>0&&e.jsx("span",{className:"ml-1 px-2 py-0.5 rounded-full text-xs bg-muted dark:bg-zinc-800",children:n.length>1?`${n.length} selected`:n[0]})]})}),e.jsxs(E,{className:"w-44 p-1 dark:bg-zinc-900 dark:text-muted-foreground",side:"bottom",align:"start",children:[["Assigned","Not Assigned"].map(s=>e.jsxs("div",{onClick:()=>S(t=>t.includes(s)?t.filter(r=>r!==s):[...t,s]),className:"flex items-center gap-2 p-2 rounded hover:bg-muted dark:hover:bg-zinc-800 cursor-pointer",children:[e.jsx(D,{checked:n.includes(s)}),e.jsx("span",{className:"text-sm",children:s})]},s)),e.jsx(o,{size:"sm",variant:"ghost",className:"w-full mt-2",onClick:()=>S([]),children:"Clear"})]})]}),(l.length>0||n.length>0||N.trim())&&e.jsxs(o,{variant:"ghost",size:"sm",className:"h-8 px-3 flex items-center gap-1",onClick:()=>{v([]),S([]),C("")},children:[e.jsx(T,{size:14})," Reset"]})]})})]}),e.jsx(J,{panelists:$,paymentRates:M,onEdit:s=>{f(s),h(!0)},onDelete:q,selected:p,setSelected:x,loading:c}),p.length>0&&e.jsxs("div",{className:"fixed left-1/2 z-30 -translate-x-1/2 bottom-4 md:bottom-6 flex items-center gap-1 bg-white dark:bg-muted dark:text-muted-foreground border border-border dark:border-border shadow-lg rounded-lg px-4 py-1 text-xs",children:[e.jsxs("span",{className:"font-semibold min-w-[70px] text-center",children:[p.length," selected"]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsxs(o,{variant:"ghost",size:"icon",className:"px-2 py-1 h-7 w-auto text-xs flex items-center gap-1",onClick:O,"aria-label":"Delete",disabled:c,children:[e.jsx(ee,{size:13}),e.jsx("span",{className:"hidden sm:inline",children:c?"Deleting...":"Delete"})]}),e.jsxs(o,{variant:"ghost",size:"icon",className:"px-2 py-1 h-7 w-auto text-xs flex items-center gap-1",onClick:()=>z("Assigned"),"aria-label":"Set Assigned",disabled:c,children:[e.jsx(se,{size:13,className:"text-green-500"}),e.jsx("span",{className:"hidden sm:inline",children:c?"Updating...":"Set Assigned"})]}),e.jsxs(o,{variant:"ghost",size:"icon",className:"px-2 py-1 h-7 w-auto text-xs flex items-center gap-1",onClick:()=>z("Not Assigned"),"aria-label":"Set Not Assigned",disabled:c,children:[e.jsx(te,{size:13,className:"text-red-500"}),e.jsx("span",{className:"hidden sm:inline",children:c?"Updating...":"Set Not Assigned"})]}),e.jsx(o,{variant:"ghost",size:"icon",className:"px-1 py-1 h-7 w-auto text-xs flex items-center",onClick:()=>x([]),"aria-label":"Clear selection",children:e.jsx(T,{size:14})})]})]}),e.jsx(V,{open:U,editing:B,onClose:()=>{h(!1),f(null)},onSubmit:I,loading:k})]})]})}export{ls as default};
