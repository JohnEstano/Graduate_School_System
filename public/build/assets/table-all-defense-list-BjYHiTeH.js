import{r as w,j as e,S}from"./app-BubHmeqC.js";import{B as p}from"./button-CX84Ig4W.js";import{T as k,a as T,b as u,c as s,d as D,e as a}from"./table-CLIx8tAs.js";import{C as y}from"./checkbox-CXbG8x3T.js";import{B as m}from"./badge-Dd_ET0uG.js";import{g as R}from"./program-abbreviations-BcvFCzIW.js";import{D as A,a as P,b as L,c as O}from"./dialog-ywfV6j7b.js";import{C as $}from"./circle-check-xWUFCjm8.js";import{X as z}from"./x-DS6n0ElR.js";import"./index-CAAZlwhj.js";import"./index-DZZQifJx.js";import"./utils-jAU0Cazi.js";import"./index-1EFpZ92o.js";import"./index-PQN_369Y.js";import"./index-CVQNv_Nf.js";import"./index-6aAr3Pmv.js";import"./index-dLIx9e4I.js";import"./index-Zto0mrax.js";import"./check-CZ9c_sEg.js";import"./createLucideIcon-Biu-y2hB.js";import"./index-Bsel9b7o.js";import"./index-DyQT7xcZ.js";function B(l){return l==="verified"?e.jsx(m,{className:"bg-green-100 text-green-700 border-green-200",children:"Verified"}):l==="rejected"?e.jsx(m,{className:"bg-red-100 text-red-700 border-red-200",children:"Rejected"}):e.jsx(m,{className:"bg-yellow-100 text-yellow-700 border-yellow-200",children:"Pending"})}function fe({paged:l,setPaged:f,columns:i,selected:h,toggleSelectOne:N,headerChecked:_,toggleSelectAll:v,toggleSort:E,sortDir:F,onPriorityChange:q,onViewDetails:j,onRowApprove:U,onRowReject:X,onRowRetrieve:H,highlightMissingDateMode:I,hideActions:J,hideSelect:g,isSidebarCollapsed:K=!1,sidebarWidth:M=260,totalCount:W}){const[n,c]=w.useState({open:!1,ids:[],action:null}),[C,b]=w.useState(!1);return e.jsxs("div",{className:"w-full box-border overflow-x-auto max-w-full border border-zinc-200 rounded-md bg-background transition-all duration-200",children:[e.jsx("div",{className:"min-w-full",children:e.jsxs(k,{className:"w-full text-sm table-auto",children:[e.jsx(T,{children:e.jsxs(u,{children:[!g&&e.jsx(s,{className:"w-[56px] py-2 sticky left-0 z-20 bg-background",style:{boxShadow:"2px 0 4px -2px rgba(0,0,0,0.04)",paddingLeft:"12px",paddingRight:"12px"},children:e.jsx(y,{checked:_,onCheckedChange:v})}),i.title&&e.jsx(s,{className:"px-3 min-w-[180px]",children:"Thesis Title"}),i.presenter&&e.jsx(s,{className:"px-2 min-w-[120px]",children:"Presenter"}),i.adviser&&e.jsx(s,{className:"px-2 min-w-[120px]",children:"Adviser"}),i.submitted_at&&e.jsx(s,{className:"px-2 min-w-[120px]",children:"Submitted At"}),i.program&&e.jsx(s,{className:"px-2 min-w-[100px]",children:"Program"}),i.coordinator&&e.jsx(s,{className:"px-2 min-w-[140px]",children:"Program Coordinator"}),i.scheduled_date&&e.jsx(s,{className:"px-2 min-w-[120px]",children:"Scheduled Date"}),i.expected_amount&&e.jsx(s,{className:"px-2 min-w-[120px]",children:"Expected Amount"}),i.amount_paid&&e.jsx(s,{className:"px-2 min-w-[120px]",children:"Amount Paid"}),i.reference_no&&e.jsx(s,{className:"px-2 min-w-[120px]",children:"Reference/OR No."}),i.priority&&e.jsx(s,{className:"px-2 min-w-[80px]",children:"Priority"}),i.status&&e.jsx(s,{className:"px-2 min-w-[100px] text-center",children:"AA Status"}),i.actions&&e.jsx(s,{className:"px-2 min-w-[80px] text-center sticky right-0 z-20 bg-background",style:{boxShadow:"-2px 0 4px -2px rgba(0,0,0,0.04)"},children:"Actions"})]})}),e.jsxs(D,{children:[l.map(t=>{const d=h==null?void 0:h.includes(t.id),x=r=>{const o=r.target.tagName;o==="BUTTON"||o==="INPUT"||o==="SELECT"||r.target.closest(".action-btn")||r.target.closest(".priority-dropdown")||(j?j(t.id):S.visit(`/assistant/all-defense-list/${t.id}/details`))};return e.jsxs(u,{className:"hover:bg-muted/40 cursor-pointer",onClick:x,children:[!g&&e.jsx(a,{className:"px-3 py-2 sticky left-0 z-10 bg-background",style:{boxShadow:"2px 0 4px -2px rgba(0,0,0,0.04)",paddingLeft:"12px",paddingRight:"12px"},children:e.jsx(y,{checked:d,onCheckedChange:()=>N(t.id),className:"action-btn",onClick:r=>r.stopPropagation()})}),i.title&&e.jsxs(a,{className:"px-3 py-2 font-medium truncate leading-tight align-middle flex items-center gap-2",title:t.thesis_title,children:[e.jsx(m,{variant:"outline",className:"shrink-0",children:t.defense_type||"—"}),e.jsx("span",{className:"truncate",children:t.thesis_title&&t.thesis_title.length>32?t.thesis_title.slice(0,32)+"…":t.thesis_title})]}),i.presenter&&e.jsxs(a,{className:"px-2 py-2 text-xs text-muted-foreground whitespace-nowrap align-middle",title:`${t.first_name} ${t.middle_name?t.middle_name+" ":""}${t.last_name}`,children:[t.first_name," ",t.middle_name?t.middle_name[0]+". ":"",t.last_name]}),i.adviser&&e.jsx(a,{className:"px-2 py-2 text-xs text-muted-foreground whitespace-nowrap align-middle",children:t.adviser||"—"}),i.submitted_at&&e.jsx(a,{className:"px-2 py-2 text-xs text-muted-foreground whitespace-nowrap align-middle",children:t.submitted_at?(()=>{try{return new Date(t.submitted_at).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return t.submitted_at}})():"—"}),i.program&&e.jsx(a,{className:"px-2 py-2 text-xs text-muted-foreground whitespace-nowrap align-middle",title:t.program||"—",children:R(t.program||"—")}),i.coordinator&&e.jsx(a,{className:"px-2 py-2 text-xs text-muted-foreground whitespace-nowrap align-middle",children:t.coordinator||"—"}),i.scheduled_date&&e.jsx(a,{className:"px-2 py-2 text-xs text-muted-foreground whitespace-nowrap align-middle",children:t.scheduled_date?new Date(t.scheduled_date).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"—"}),i.expected_amount&&e.jsx(a,{className:"px-2 py-2 text-xs text-muted-foreground whitespace-nowrap align-middle",children:t.expected_rate!=null?`₱${Number(t.expected_rate).toLocaleString(void 0,{minimumFractionDigits:2})}`:"—"}),i.amount_paid&&e.jsx(a,{className:"px-2 py-2 text-xs text-muted-foreground whitespace-nowrap align-middle",children:t.amount!=null?`₱${Number(t.amount).toLocaleString(void 0,{minimumFractionDigits:2})}`:"—"}),i.reference_no&&e.jsx(a,{className:"px-2 py-2 text-xs text-muted-foreground whitespace-nowrap align-middle",children:t.reference_no||"—"}),i.priority&&e.jsx(a,{className:"px-2 py-2 text-xs text-muted-foreground whitespace-nowrap align-middle",children:t.priority}),i.status&&e.jsx(a,{className:"px-2 py-2 text-xs whitespace-nowrap text-center align-middle",children:B(t.aa_verification_status)}),i.actions&&e.jsxs(a,{className:"px-2 py-2 text-xs text-center align-middle sticky right-0 z-10 bg-background",style:{boxShadow:"-2px 0 4px -2px rgba(0,0,0,0.04)"},children:[e.jsx(p,{size:"sm",variant:"outline",className:"ml-1 action-btn",onClick:r=>{r.stopPropagation(),t.aa_verification_id&&c({open:!0,ids:[t.aa_verification_id],action:"verified"})},disabled:t.aa_verification_status==="verified",children:e.jsx($,{className:"h-4 w-4 text-emerald-600"})}),e.jsx(p,{size:"sm",variant:"outline",className:"ml-1 action-btn",onClick:r=>{r.stopPropagation(),t.aa_verification_id&&c({open:!0,ids:[t.aa_verification_id],action:"rejected"})},disabled:t.aa_verification_status==="rejected",children:e.jsx(z,{className:"h-4 w-4 text-red-600"})})]})]},t.id)}),l.length===0&&e.jsx(u,{children:e.jsx(a,{colSpan:Object.keys(i).length+(g?0:1),className:"py-32 text-center text-sm text-muted-foreground",children:"no results"})})]})]})}),e.jsx(A,{open:n.open,onOpenChange:t=>c(d=>({...d,open:t})),children:e.jsxs(P,{children:[e.jsx(L,{children:"Confirm Status Change"}),e.jsx(O,{children:n.ids.length>1?`Are you sure you want to set ${n.ids.length} requests to ${n.action}?`:`Are you sure you want to set this request to ${n.action}?`}),e.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[e.jsx(p,{variant:"ghost",onClick:()=>c({open:!1,ids:[],action:null}),children:"Cancel"}),e.jsx(p,{disabled:C,onClick:async()=>{var d,x;b(!0);let t;n.ids.length===1?t=await fetch(`/aa/payment-verifications/${n.ids[0]}/status`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((d=document.querySelector('meta[name="csrf-token"]'))==null?void 0:d.content)||""},body:JSON.stringify({status:n.action})}):t=await fetch("/aa/payment-verifications/bulk-update",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((x=document.querySelector('meta[name="csrf-token"]'))==null?void 0:x.content)||""},body:JSON.stringify({verification_ids:n.ids,status:n.action})}),b(!1),c({open:!1,ids:[],action:null}),t.ok&&f?f(r=>r.map(o=>n.ids.includes(o.aa_verification_id??-1)?{...o,aa_verification_status:n.action}:o)):alert("Failed to update status. Please try again.")},children:"Confirm"})]})]})})]})}export{fe as default};
