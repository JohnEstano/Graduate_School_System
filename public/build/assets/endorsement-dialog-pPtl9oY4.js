import{r as s,j as e}from"./app-DW0Mt5c9.js";import{D as we,a as Se,e as je,b as ye,c as Ne}from"./dialog-D7L72BhV.js";import{B as T}from"./button-BZf0VdIO.js";import"./index-DHu7YzAG.js";import{c as tt}from"./index-RzYQM1sh.js";import{c as Ae}from"./utils-jAU0Cazi.js";import{S as ne}from"./separator-4d5ucxHB.js";import{A as oe,b as se}from"./alert-Dap4gtF9.js";import{L as ae}from"./label-Dk8neUpq.js";import{S as rt}from"./index-CPs87JPB.js";import{t as b}from"./index-ByTeG7FR.js";import{E as nt}from"./eye-CiUjArwd.js";import{S as ot}from"./signature-D_iqDcqD.js";import{c as st}from"./createLucideIcon-S0dKkUVo.js";import{L as z}from"./loader-circle-EY4lXEgZ.js";import{S as at}from"./send-BUfb6BoG.js";import{C as le}from"./circle-alert-CV2dla6l.js";import{C as ie}from"./check-C1Ca0PY3.js";import{P as lt}from"./pencil-C6zzAshF.js";import{F as it}from"./file-text-Dpj0IN7n.js";import{T as ct}from"./trash-2-lOnE2GCJ.js";import"./index-BMNAwHVU.js";import"./index-Bh88FqJG.js";import"./x-CW6T59GI.js";import"./index-DZZQifJx.js";import"./index-xrb8sl6P.js";import"./typeof-QjJsDpFa.js";import"./index-BbbQjtbf.js";import"./index-Chjiymov.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dt=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],Ce=st("Upload",dt);var ut=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Y=ut.reduce((t,n)=>{const r=tt(`Primitive.${n}`),a=s.forwardRef((o,l)=>{const{asChild:c,...d}=o,i=c?r:n;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(i,{...d,ref:l})});return a.displayName=`Primitive.${n}`,{...t,[n]:a}},{});function Pe(t,n){if(typeof t=="function")return t(n);t!=null&&(t.current=n)}function mt(...t){return n=>{let r=!1;const a=t.map(o=>{const l=Pe(o,n);return!r&&typeof l=="function"&&(r=!0),l});if(r)return()=>{for(let o=0;o<a.length;o++){const l=a[o];typeof l=="function"?l():Pe(t[o],null)}}}}function M(...t){return s.useCallback(mt(...t),t)}var ce=globalThis!=null&&globalThis.document?s.useLayoutEffect:()=>{};function ft(t,n){return s.useReducer((r,a)=>n[r][a]??r,t)}var B=t=>{const{present:n,children:r}=t,a=ht(n),o=typeof r=="function"?r({present:a.isPresent}):s.Children.only(r),l=M(a.ref,pt(o));return typeof r=="function"||a.isPresent?s.cloneElement(o,{ref:l}):null};B.displayName="Presence";function ht(t){const[n,r]=s.useState(),a=s.useRef(null),o=s.useRef(t),l=s.useRef("none"),c=t?"mounted":"unmounted",[d,i]=ft(c,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return s.useEffect(()=>{const u=Q(a.current);l.current=d==="mounted"?u:"none"},[d]),ce(()=>{const u=a.current,h=o.current;if(h!==t){const f=l.current,g=Q(u);t?i("MOUNT"):g==="none"||(u==null?void 0:u.display)==="none"?i("UNMOUNT"):i(h&&f!==g?"ANIMATION_OUT":"UNMOUNT"),o.current=t}},[t,i]),ce(()=>{if(n){let u;const h=n.ownerDocument.defaultView??window,p=g=>{const y=Q(a.current).includes(g.animationName);if(g.target===n&&y&&(i("ANIMATION_END"),!o.current)){const A=n.style.animationFillMode;n.style.animationFillMode="forwards",u=h.setTimeout(()=>{n.style.animationFillMode==="forwards"&&(n.style.animationFillMode=A)})}},f=g=>{g.target===n&&(l.current=Q(a.current))};return n.addEventListener("animationstart",f),n.addEventListener("animationcancel",p),n.addEventListener("animationend",p),()=>{h.clearTimeout(u),n.removeEventListener("animationstart",f),n.removeEventListener("animationcancel",p),n.removeEventListener("animationend",p)}}else i("ANIMATION_END")},[n,i]),{isPresent:["mounted","unmountSuspended"].includes(d),ref:s.useCallback(u=>{a.current=u?getComputedStyle(u):null,r(u)},[])}}function Q(t){return(t==null?void 0:t.animationName)||"none"}function pt(t){var a,o;let n=(a=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:a.get,r=n&&"isReactWarning"in n&&n.isReactWarning;return r?t.ref:(n=(o=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:o.get,r=n&&"isReactWarning"in n&&n.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}function xt(t,n=[]){let r=[];function a(l,c){const d=s.createContext(c),i=r.length;r=[...r,c];const u=p=>{var P;const{scope:f,children:g,...v}=p,y=((P=f==null?void 0:f[t])==null?void 0:P[i])||d,A=s.useMemo(()=>v,Object.values(v));return e.jsx(y.Provider,{value:A,children:g})};u.displayName=l+"Provider";function h(p,f){var y;const g=((y=f==null?void 0:f[t])==null?void 0:y[i])||d,v=s.useContext(g);if(v)return v;if(c!==void 0)return c;throw new Error(`\`${p}\` must be used within \`${l}\``)}return[u,h]}const o=()=>{const l=r.map(c=>s.createContext(c));return function(d){const i=(d==null?void 0:d[t])||l;return s.useMemo(()=>({[`__scope${t}`]:{...d,[t]:i}}),[d,i])}};return o.scopeName=t,[a,gt(o,...n)]}function gt(...t){const n=t[0];if(t.length===1)return n;const r=()=>{const a=t.map(o=>({useScope:o(),scopeName:o.scopeName}));return function(l){const c=a.reduce((d,{useScope:i,scopeName:u})=>{const p=i(l)[`__scope${u}`];return{...d,...p}},{});return s.useMemo(()=>({[`__scope${n.scopeName}`]:c}),[c])}};return r.scopeName=n.scopeName,r}function U(t){const n=s.useRef(t);return s.useEffect(()=>{n.current=t}),s.useMemo(()=>(...r)=>{var a;return(a=n.current)==null?void 0:a.call(n,...r)},[])}var vt=s.createContext(void 0);function bt(t){const n=s.useContext(vt);return t||n||"ltr"}function wt(t,[n,r]){return Math.min(r,Math.max(n,t))}function k(t,n,{checkForDefaultPrevented:r=!0}={}){return function(o){if(t==null||t(o),r===!1||!o.defaultPrevented)return n==null?void 0:n(o)}}function St(t,n){return s.useReducer((r,a)=>n[r][a]??r,t)}var de="ScrollArea",[De,ur]=xt(de),[jt,E]=De(de),Re=s.forwardRef((t,n)=>{const{__scopeScrollArea:r,type:a="hover",dir:o,scrollHideDelay:l=600,...c}=t,[d,i]=s.useState(null),[u,h]=s.useState(null),[p,f]=s.useState(null),[g,v]=s.useState(null),[y,A]=s.useState(null),[P,R]=s.useState(0),[H,I]=s.useState(0),[L,F]=s.useState(!1),[_,O]=s.useState(!1),S=M(n,N=>i(N)),j=bt(o);return e.jsx(jt,{scope:r,type:a,dir:j,scrollHideDelay:l,scrollArea:d,viewport:u,onViewportChange:h,content:p,onContentChange:f,scrollbarX:g,onScrollbarXChange:v,scrollbarXEnabled:L,onScrollbarXEnabledChange:F,scrollbarY:y,onScrollbarYChange:A,scrollbarYEnabled:_,onScrollbarYEnabledChange:O,onCornerWidthChange:R,onCornerHeightChange:I,children:e.jsx(Y.div,{dir:j,...c,ref:S,style:{position:"relative","--radix-scroll-area-corner-width":P+"px","--radix-scroll-area-corner-height":H+"px",...t.style}})})});Re.displayName=de;var _e="ScrollAreaViewport",Le=s.forwardRef((t,n)=>{const{__scopeScrollArea:r,children:a,nonce:o,...l}=t,c=E(_e,r),d=s.useRef(null),i=M(n,d,c.onViewportChange);return e.jsxs(e.Fragment,{children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:o}),e.jsx(Y.div,{"data-radix-scroll-area-viewport":"",...l,ref:i,style:{overflowX:c.scrollbarXEnabled?"scroll":"hidden",overflowY:c.scrollbarYEnabled?"scroll":"hidden",...t.style},children:e.jsx("div",{ref:c.onContentChange,style:{minWidth:"100%",display:"table"},children:a})})]})});Le.displayName=_e;var D="ScrollAreaScrollbar",Fe=s.forwardRef((t,n)=>{const{forceMount:r,...a}=t,o=E(D,t.__scopeScrollArea),{onScrollbarXEnabledChange:l,onScrollbarYEnabledChange:c}=o,d=t.orientation==="horizontal";return s.useEffect(()=>(d?l(!0):c(!0),()=>{d?l(!1):c(!1)}),[d,l,c]),o.type==="hover"?e.jsx(yt,{...a,ref:n,forceMount:r}):o.type==="scroll"?e.jsx(Nt,{...a,ref:n,forceMount:r}):o.type==="auto"?e.jsx(Oe,{...a,ref:n,forceMount:r}):o.type==="always"?e.jsx(ue,{...a,ref:n}):null});Fe.displayName=D;var yt=s.forwardRef((t,n)=>{const{forceMount:r,...a}=t,o=E(D,t.__scopeScrollArea),[l,c]=s.useState(!1);return s.useEffect(()=>{const d=o.scrollArea;let i=0;if(d){const u=()=>{window.clearTimeout(i),c(!0)},h=()=>{i=window.setTimeout(()=>c(!1),o.scrollHideDelay)};return d.addEventListener("pointerenter",u),d.addEventListener("pointerleave",h),()=>{window.clearTimeout(i),d.removeEventListener("pointerenter",u),d.removeEventListener("pointerleave",h)}}},[o.scrollArea,o.scrollHideDelay]),e.jsx(B,{present:r||l,children:e.jsx(Oe,{"data-state":l?"visible":"hidden",...a,ref:n})})}),Nt=s.forwardRef((t,n)=>{const{forceMount:r,...a}=t,o=E(D,t.__scopeScrollArea),l=t.orientation==="horizontal",c=te(()=>i("SCROLL_END"),100),[d,i]=St("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return s.useEffect(()=>{if(d==="idle"){const u=window.setTimeout(()=>i("HIDE"),o.scrollHideDelay);return()=>window.clearTimeout(u)}},[d,o.scrollHideDelay,i]),s.useEffect(()=>{const u=o.viewport,h=l?"scrollLeft":"scrollTop";if(u){let p=u[h];const f=()=>{const g=u[h];p!==g&&(i("SCROLL"),c()),p=g};return u.addEventListener("scroll",f),()=>u.removeEventListener("scroll",f)}},[o.viewport,l,i,c]),e.jsx(B,{present:r||d!=="hidden",children:e.jsx(ue,{"data-state":d==="hidden"?"hidden":"visible",...a,ref:n,onPointerEnter:k(t.onPointerEnter,()=>i("POINTER_ENTER")),onPointerLeave:k(t.onPointerLeave,()=>i("POINTER_LEAVE"))})})}),Oe=s.forwardRef((t,n)=>{const r=E(D,t.__scopeScrollArea),{forceMount:a,...o}=t,[l,c]=s.useState(!1),d=t.orientation==="horizontal",i=te(()=>{if(r.viewport){const u=r.viewport.offsetWidth<r.viewport.scrollWidth,h=r.viewport.offsetHeight<r.viewport.scrollHeight;c(d?u:h)}},10);return X(r.viewport,i),X(r.content,i),e.jsx(B,{present:a||l,children:e.jsx(ue,{"data-state":l?"visible":"hidden",...o,ref:n})})}),ue=s.forwardRef((t,n)=>{const{orientation:r="vertical",...a}=t,o=E(D,t.__scopeScrollArea),l=s.useRef(null),c=s.useRef(0),[d,i]=s.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),u=We(d.viewport,d.content),h={...a,sizes:d,onSizesChange:i,hasThumb:u>0&&u<1,onThumbChange:f=>l.current=f,onThumbPointerUp:()=>c.current=0,onThumbPointerDown:f=>c.current=f};function p(f,g){return Dt(f,c.current,d,g)}return r==="horizontal"?e.jsx(Ct,{...h,ref:n,onThumbPositionChange:()=>{if(o.viewport&&l.current){const f=o.viewport.scrollLeft,g=Te(f,d,o.dir);l.current.style.transform=`translate3d(${g}px, 0, 0)`}},onWheelScroll:f=>{o.viewport&&(o.viewport.scrollLeft=f)},onDragScroll:f=>{o.viewport&&(o.viewport.scrollLeft=p(f,o.dir))}}):r==="vertical"?e.jsx(Pt,{...h,ref:n,onThumbPositionChange:()=>{if(o.viewport&&l.current){const f=o.viewport.scrollTop,g=Te(f,d);l.current.style.transform=`translate3d(0, ${g}px, 0)`}},onWheelScroll:f=>{o.viewport&&(o.viewport.scrollTop=f)},onDragScroll:f=>{o.viewport&&(o.viewport.scrollTop=p(f))}}):null}),Ct=s.forwardRef((t,n)=>{const{sizes:r,onSizesChange:a,...o}=t,l=E(D,t.__scopeScrollArea),[c,d]=s.useState(),i=s.useRef(null),u=M(n,i,l.onScrollbarXChange);return s.useEffect(()=>{i.current&&d(getComputedStyle(i.current))},[i]),e.jsx(ke,{"data-orientation":"horizontal",...o,ref:u,sizes:r,style:{bottom:0,left:l.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:l.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":ee(r)+"px",...t.style},onThumbPointerDown:h=>t.onThumbPointerDown(h.x),onDragScroll:h=>t.onDragScroll(h.x),onWheelScroll:(h,p)=>{if(l.viewport){const f=l.viewport.scrollLeft+h.deltaX;t.onWheelScroll(f),Xe(f,p)&&h.preventDefault()}},onResize:()=>{i.current&&l.viewport&&c&&a({content:l.viewport.scrollWidth,viewport:l.viewport.offsetWidth,scrollbar:{size:i.current.clientWidth,paddingStart:q(c.paddingLeft),paddingEnd:q(c.paddingRight)}})}})}),Pt=s.forwardRef((t,n)=>{const{sizes:r,onSizesChange:a,...o}=t,l=E(D,t.__scopeScrollArea),[c,d]=s.useState(),i=s.useRef(null),u=M(n,i,l.onScrollbarYChange);return s.useEffect(()=>{i.current&&d(getComputedStyle(i.current))},[i]),e.jsx(ke,{"data-orientation":"vertical",...o,ref:u,sizes:r,style:{top:0,right:l.dir==="ltr"?0:void 0,left:l.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":ee(r)+"px",...t.style},onThumbPointerDown:h=>t.onThumbPointerDown(h.y),onDragScroll:h=>t.onDragScroll(h.y),onWheelScroll:(h,p)=>{if(l.viewport){const f=l.viewport.scrollTop+h.deltaY;t.onWheelScroll(f),Xe(f,p)&&h.preventDefault()}},onResize:()=>{i.current&&l.viewport&&c&&a({content:l.viewport.scrollHeight,viewport:l.viewport.offsetHeight,scrollbar:{size:i.current.clientHeight,paddingStart:q(c.paddingTop),paddingEnd:q(c.paddingBottom)}})}})}),[Tt,Ue]=De(D),ke=s.forwardRef((t,n)=>{const{__scopeScrollArea:r,sizes:a,hasThumb:o,onThumbChange:l,onThumbPointerUp:c,onThumbPointerDown:d,onThumbPositionChange:i,onDragScroll:u,onWheelScroll:h,onResize:p,...f}=t,g=E(D,r),[v,y]=s.useState(null),A=M(n,S=>y(S)),P=s.useRef(null),R=s.useRef(""),H=g.viewport,I=a.content-a.viewport,L=U(h),F=U(i),_=te(p,10);function O(S){if(P.current){const j=S.clientX-P.current.left,N=S.clientY-P.current.top;u({x:j,y:N})}}return s.useEffect(()=>{const S=j=>{const N=j.target;(v==null?void 0:v.contains(N))&&L(j,I)};return document.addEventListener("wheel",S,{passive:!1}),()=>document.removeEventListener("wheel",S,{passive:!1})},[H,v,I,L]),s.useEffect(F,[a,F]),X(v,_),X(g.content,_),e.jsx(Tt,{scope:r,scrollbar:v,hasThumb:o,onThumbChange:U(l),onThumbPointerUp:U(c),onThumbPositionChange:F,onThumbPointerDown:U(d),children:e.jsx(Y.div,{...f,ref:A,style:{position:"absolute",...f.style},onPointerDown:k(t.onPointerDown,S=>{S.button===0&&(S.target.setPointerCapture(S.pointerId),P.current=v.getBoundingClientRect(),R.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",g.viewport&&(g.viewport.style.scrollBehavior="auto"),O(S))}),onPointerMove:k(t.onPointerMove,O),onPointerUp:k(t.onPointerUp,S=>{const j=S.target;j.hasPointerCapture(S.pointerId)&&j.releasePointerCapture(S.pointerId),document.body.style.webkitUserSelect=R.current,g.viewport&&(g.viewport.style.scrollBehavior=""),P.current=null})})})}),Z="ScrollAreaThumb",Me=s.forwardRef((t,n)=>{const{forceMount:r,...a}=t,o=Ue(Z,t.__scopeScrollArea);return e.jsx(B,{present:r||o.hasThumb,children:e.jsx(Et,{ref:n,...a})})}),Et=s.forwardRef((t,n)=>{const{__scopeScrollArea:r,style:a,...o}=t,l=E(Z,r),c=Ue(Z,r),{onThumbPositionChange:d}=c,i=M(n,p=>c.onThumbChange(p)),u=s.useRef(void 0),h=te(()=>{u.current&&(u.current(),u.current=void 0)},100);return s.useEffect(()=>{const p=l.viewport;if(p){const f=()=>{if(h(),!u.current){const g=Rt(p,d);u.current=g,d()}};return d(),p.addEventListener("scroll",f),()=>p.removeEventListener("scroll",f)}},[l.viewport,h,d]),e.jsx(Y.div,{"data-state":c.hasThumb?"visible":"hidden",...o,ref:i,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...a},onPointerDownCapture:k(t.onPointerDownCapture,p=>{const g=p.target.getBoundingClientRect(),v=p.clientX-g.left,y=p.clientY-g.top;c.onThumbPointerDown({x:v,y})}),onPointerUp:k(t.onPointerUp,c.onThumbPointerUp)})});Me.displayName=Z;var me="ScrollAreaCorner",Ie=s.forwardRef((t,n)=>{const r=E(me,t.__scopeScrollArea),a=!!(r.scrollbarX&&r.scrollbarY);return r.type!=="scroll"&&a?e.jsx(At,{...t,ref:n}):null});Ie.displayName=me;var At=s.forwardRef((t,n)=>{const{__scopeScrollArea:r,...a}=t,o=E(me,r),[l,c]=s.useState(0),[d,i]=s.useState(0),u=!!(l&&d);return X(o.scrollbarX,()=>{var p;const h=((p=o.scrollbarX)==null?void 0:p.offsetHeight)||0;o.onCornerHeightChange(h),i(h)}),X(o.scrollbarY,()=>{var p;const h=((p=o.scrollbarY)==null?void 0:p.offsetWidth)||0;o.onCornerWidthChange(h),c(h)}),u?e.jsx(Y.div,{...a,ref:n,style:{width:l,height:d,position:"absolute",right:o.dir==="ltr"?0:void 0,left:o.dir==="rtl"?0:void 0,bottom:0,...t.style}}):null});function q(t){return t?parseInt(t,10):0}function We(t,n){const r=t/n;return isNaN(r)?0:r}function ee(t){const n=We(t.viewport,t.content),r=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,a=(t.scrollbar.size-r)*n;return Math.max(a,18)}function Dt(t,n,r,a="ltr"){const o=ee(r),l=o/2,c=n||l,d=o-c,i=r.scrollbar.paddingStart+c,u=r.scrollbar.size-r.scrollbar.paddingEnd-d,h=r.content-r.viewport,p=a==="ltr"?[0,h]:[h*-1,0];return ze([i,u],p)(t)}function Te(t,n,r="ltr"){const a=ee(n),o=n.scrollbar.paddingStart+n.scrollbar.paddingEnd,l=n.scrollbar.size-o,c=n.content-n.viewport,d=l-a,i=r==="ltr"?[0,c]:[c*-1,0],u=wt(t,i);return ze([0,c],[0,d])(u)}function ze(t,n){return r=>{if(t[0]===t[1]||n[0]===n[1])return n[0];const a=(n[1]-n[0])/(t[1]-t[0]);return n[0]+a*(r-t[0])}}function Xe(t,n){return t>0&&t<n}var Rt=(t,n=()=>{})=>{let r={left:t.scrollLeft,top:t.scrollTop},a=0;return function o(){const l={left:t.scrollLeft,top:t.scrollTop},c=r.left!==l.left,d=r.top!==l.top;(c||d)&&n(),r=l,a=window.requestAnimationFrame(o)}(),()=>window.cancelAnimationFrame(a)};function te(t,n){const r=U(t),a=s.useRef(0);return s.useEffect(()=>()=>window.clearTimeout(a.current),[]),s.useCallback(()=>{window.clearTimeout(a.current),a.current=window.setTimeout(r,n)},[r,n])}function X(t,n){const r=U(n);ce(()=>{let a=0;if(t){const o=new ResizeObserver(()=>{cancelAnimationFrame(a),a=window.requestAnimationFrame(r)});return o.observe(t),()=>{window.cancelAnimationFrame(a),o.unobserve(t)}}},[t,r])}var _t=Re,Lt=Le,Ft=Ie;function Ee({className:t,children:n,...r}){return e.jsxs(_t,{"data-slot":"scroll-area",className:Ae("relative",t),...r,children:[e.jsx(Lt,{"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1",children:n}),e.jsx(Ot,{}),e.jsx(Ft,{})]})}function Ot({className:t,orientation:n="vertical",...r}){return e.jsx(Fe,{"data-slot":"scroll-area-scrollbar",orientation:n,className:Ae("flex touch-none p-px transition-colors select-none",n==="vertical"&&"h-full w-2.5 border-l border-l-transparent",n==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent",t),...r,children:e.jsx(Me,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"})})}function mr({open:t,onOpenChange:n,defenseRequest:r,coordinatorId:a,coordinatorName:o="Coordinator",onEndorseComplete:l}){const[c,d]=s.useState("preview"),[i,u]=s.useState(null),[h,p]=s.useState(null),[f,g]=s.useState(!1),[v,y]=s.useState(!1),[A,P]=s.useState([]),[R,H]=s.useState(null),[I,L]=s.useState(!1),[F,_]=s.useState(!1),[O,S]=s.useState(!1),j=s.useRef(null),[N,V]=s.useState(null),[fe,he]=s.useState(!1),[He,G]=s.useState(!1),pe=s.useRef(null),[xe,$e]=s.useState([]),[K,ge]=s.useState(null);function W(){var m;return((m=document.querySelector('meta[name="csrf-token"]'))==null?void 0:m.content)||""}s.useEffect(()=>{t?(Ye(),re()):(i&&i.startsWith("blob:")&&window.URL.revokeObjectURL(i),u(null),p(null),d("preview"),V(null),G(!1))},[t]),s.useEffect(()=>{t&&xe.length>0&&K&&!i&&!f&&ve()},[t,xe,K]);async function Ye(){var m;try{const x=await fetch("/api/document-templates");if(x.ok){const w=await x.json();$e(w);const C=((m=r==null?void 0:r.defense_type)==null?void 0:m.toLowerCase())||"",$=w.find(et=>{const J=et.name.toLowerCase();return C.includes("prefinal")||C.includes("pre-final")?J.includes("prefinal")||J.includes("pre-final"):C.includes("final")?J.includes("final")&&!J.includes("prefinal"):!1});$?ge($):w.length>0&&ge(w[0])}}catch(x){console.error("Failed to load templates:",x)}}async function re(){L(!0);try{const m=await fetch("/api/signatures");if(m.ok){const x=await m.json();P(x);const w=x.find(C=>C.active);H(w||null)}}catch(m){console.error("Failed to load signatures:",m)}finally{L(!1)}}async function ve(){if(!K){b.error("No template selected");return}if(!(r!=null&&r.id)){b.error("Invalid defense request");return}g(!0);try{const m=await fetch("/api/generate-document",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/pdf","X-CSRF-TOKEN":W()},body:JSON.stringify({template_id:K.id,defense_request_id:r.id,fields:{}})});if(!m.ok){b.error("Failed to generate document"),g(!1);return}const x=await m.blob(),w=window.URL.createObjectURL(x);u(w);const C=new FormData;C.append("endorsement_form",x,"endorsement-form.pdf"),(await fetch(`/api/defense-requests/${r.id}/upload-endorsement`,{method:"POST",headers:{"X-CSRF-TOKEN":W()},body:C})).ok||console.warn("Failed to save generated document to defense request"),b.success("Endorsement form generated successfully!")}catch(m){console.error("Generate error:",m),b.error("Failed to generate endorsement form")}finally{g(!1)}}async function Be(){if(!j.current)return;const m=j.current.getCanvas(),x=m.toDataURL("image/png");S(!0);try{(await fetch("/api/signatures",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":W()},body:JSON.stringify({image_base64:x,label:"Drawn Signature",natural_width:m.width,natural_height:m.height})})).ok?(b.success("Signature saved successfully!"),_(!1),re()):b.error("Failed to save signature")}catch(w){console.error("Save signature error:",w),b.error("Failed to save signature")}finally{S(!1)}}async function Ve(m){try{(await fetch(`/api/signatures/${m}/activate`,{method:"PATCH",headers:{"X-CSRF-TOKEN":W()}})).ok?(b.success("Signature activated!"),re()):b.error("Failed to activate signature")}catch(x){console.error("Activate signature error:",x),b.error("Failed to activate signature")}}async function Ge(m){var w;const x=(w=m.target.files)==null?void 0:w[0];if(x){if(!x.type.includes("pdf")){b.error("Please upload a PDF file");return}V(x),b.success('File selected. Click "Use This File" to continue.')}}function Ke(m){m.preventDefault(),G(!0)}function Je(m){m.preventDefault(),G(!1)}function Qe(m){var w;m.preventDefault(),G(!1);const x=(w=m.dataTransfer.files)==null?void 0:w[0];if(x){if(!x.type.includes("pdf")){b.error("Please upload a PDF file");return}V(x),b.success('File selected. Click "Use This File" to continue.')}}async function Ze(){if(!(!N||!(r!=null&&r.id))){he(!0);try{const m=new FormData;m.append("endorsement_form",N);const x=await fetch(`/api/defense-requests/${r.id}/upload-endorsement`,{method:"POST",headers:{"X-CSRF-TOKEN":W()},body:m});if(x.ok){const w=await x.json(),C=new Blob([N],{type:"application/pdf"}),$=window.URL.createObjectURL(C);u($),b.success("Endorsement form uploaded successfully!"),d("preview")}else b.error("Failed to upload endorsement form")}catch(m){console.error("Upload error:",m),b.error("Failed to upload endorsement form")}finally{he(!1)}}}async function qe(){if(!i){b.error("Please generate or upload an endorsement form first");return}if(!R){b.error("Please set an active signature first");return}y(!0);try{const m={adviser_status:"Approved"};a&&(m.coordinator_user_id=a);const x=await fetch(`/adviser/defense-requirements/${r.id}/adviser-status`,{method:"PATCH",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":W()},body:JSON.stringify(m)});if(x.ok){const w=await x.json();console.log("✅ Endorsement successful, updating parent..."),l&&await l(),n(!1),b.success(`Request endorsed successfully and forwarded to ${o}!`)}else{const w=await x.json();b.error(w.message||"Failed to endorse request")}}catch(m){console.error("Endorse error:",m),b.error("Failed to endorse request")}finally{y(!1)}}function be(){if(j.current){const m=j.current.getCanvas(),x=m.getContext("2d");if(x){const C=m.height-80;x.save(),x.strokeStyle="#d1d5db",x.lineWidth=1,x.beginPath(),x.moveTo(40,C),x.lineTo(m.width-40,C),x.stroke(),x.restore()}}}return e.jsxs(e.Fragment,{children:[e.jsx(we,{open:t,onOpenChange:n,children:e.jsx(Se,{className:"max-w-full w-[90vw] h-[90vh] p-0 gap-0 flex flex-col overflow-hidden",children:e.jsxs("div",{className:"flex flex-1 min-h-0",children:[e.jsxs("div",{className:"w-72 border-r bg-muted/30 flex flex-col shrink-0",children:[e.jsx("div",{className:"p-6 pb-4 shrink-0",children:e.jsxs(je,{children:[e.jsx(ye,{className:"text-lg",children:"Endorse Request"}),e.jsx(Ne,{className:"text-xs mt-2",children:"Review and endorse the defense request"})]})}),e.jsx(ne,{}),e.jsx(Ee,{className:"flex-1 min-h-0",children:e.jsxs("div",{className:"px-6 py-4 space-y-6",children:[e.jsxs("nav",{className:"space-y-1",children:[e.jsxs(T,{variant:c==="preview"?"secondary":"ghost",className:"w-full justify-start",onClick:()=>d("preview"),children:[e.jsx(nt,{className:"mr-2 h-4 w-4"}),"Preview"]}),e.jsxs(T,{variant:c==="signature"?"secondary":"ghost",className:"w-full justify-start",onClick:()=>d("signature"),children:[e.jsx(ot,{className:"mr-2 h-4 w-4"}),"Signature"]}),e.jsxs(T,{variant:c==="upload"?"secondary":"ghost",className:"w-full justify-start",onClick:()=>d("upload"),children:[e.jsx(Ce,{className:"mr-2 h-4 w-4"}),"Upload File"]})]}),e.jsx(ne,{}),e.jsxs("div",{className:"space-y-2 text-xs",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-muted-foreground",children:"Student"}),e.jsxs("div",{className:"font-semibold",children:[r==null?void 0:r.first_name," ",r==null?void 0:r.last_name]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-muted-foreground",children:"Defense Type"}),e.jsx("div",{className:"font-semibold",children:r==null?void 0:r.defense_type})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-muted-foreground",children:"Coordinator"}),e.jsx("div",{className:"font-semibold",children:o})]})]})]})}),e.jsx(ne,{}),e.jsx("div",{className:"p-6 pt-4 shrink-0",children:e.jsx(T,{className:"w-full",size:"lg",disabled:!i||!R||v,onClick:qe,children:v?e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"mr-2 h-4 w-4 animate-spin"}),"Endorsing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(at,{className:"mr-2 h-4 w-4"}),"Endorse to Coordinator"]})})})]}),e.jsx("div",{className:"flex-1 flex flex-col min-w-0 overflow-hidden",children:e.jsx(Ee,{className:"flex-1",children:e.jsxs("div",{className:"p-8 max-w-5xl mx-auto",children:[f&&e.jsxs("div",{className:"flex flex-col items-center justify-center h-[600px] space-y-4",children:[e.jsx(z,{className:"h-12 w-12 animate-spin text-primary"}),e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Generating Document..."}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Please wait while we prepare your endorsement form"})]})]}),!f&&c==="preview"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Document Preview"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Review the generated endorsement form"})]}),i&&e.jsxs(T,{variant:"outline",size:"sm",onClick:()=>{i.startsWith("blob:")&&window.URL.revokeObjectURL(i),u(null),ve()},disabled:f,children:[e.jsx(z,{className:`mr-2 h-4 w-4 ${f?"animate-spin":""}`}),"Regenerate"]})]}),i?e.jsx("div",{className:"border rounded-lg overflow-hidden",style:{height:"700px"},children:e.jsx("iframe",{src:i,className:"w-full h-full",title:"Document Preview"})}):e.jsxs(oe,{children:[e.jsx(le,{className:"h-4 w-4"}),e.jsx(se,{children:"Document is being generated automatically. Please wait..."})]})]}),c==="signature"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Manage Signature"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"View, draw, or upload your signature"})]}),R&&e.jsxs("div",{className:"border rounded-lg p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(ae,{className:"text-sm font-medium",children:"Active Signature"}),e.jsx(ie,{className:"h-4 w-4 text-green-600"})]}),e.jsx("div",{className:"bg-muted/50 rounded-lg p-4 flex items-center justify-center",children:e.jsx("img",{src:`/storage/${R.image_path}`,alt:"Active signature",className:"max-h-24 object-contain"})})]}),e.jsxs("div",{className:"border rounded-lg p-4 space-y-3",children:[e.jsx(ae,{className:"text-sm font-medium",children:"Draw New Signature"}),e.jsxs(T,{variant:"outline",className:"w-full",onClick:()=>_(!0),children:[e.jsx(lt,{className:"mr-2 h-4 w-4"}),"Draw Signature"]})]}),e.jsxs("div",{className:"border rounded-lg p-4 space-y-3",children:[e.jsx(ae,{className:"text-sm font-medium",children:"All Signatures"}),I?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(z,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):A.length>0?e.jsx("div",{className:"grid grid-cols-2 gap-3",children:A.map(m=>e.jsxs("div",{className:`border rounded-lg p-3 space-y-2 ${m.active?"ring-2 ring-primary":""}`,children:[e.jsx("div",{className:"bg-muted/50 rounded p-2 flex items-center justify-center min-h-[60px]",children:e.jsx("img",{src:`/storage/${m.image_path}`,alt:"Signature",className:"max-h-12 object-contain"})}),e.jsx(T,{variant:m.active?"secondary":"outline",size:"sm",className:"w-full",onClick:()=>Ve(m.id),disabled:m.active,children:m.active?"Active":"Set Active"})]},m.id))}):e.jsxs(oe,{children:[e.jsx(le,{className:"h-4 w-4"}),e.jsx(se,{children:"No signatures found. Draw one to get started."})]})]})]}),c==="upload"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Upload Custom File"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Upload your own endorsement form PDF"})]}),e.jsxs(oe,{children:[e.jsx(le,{className:"h-4 w-4"}),e.jsx(se,{children:"If you prefer to use your own endorsement form, you can upload it here instead of generating one."})]}),e.jsxs("div",{className:`border-2 border-dashed rounded-lg p-12 text-center space-y-4 transition-colors ${He?"border-primary bg-primary/5":"border-muted-foreground/25"}`,onDragOver:Ke,onDragLeave:Je,onDrop:Qe,children:[e.jsx(Ce,{className:"h-16 w-16 mx-auto text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-base font-medium",children:N?N.name:"Drag and drop your PDF here"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"or click to browse"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"PDF files only, max 10MB"})]}),e.jsx("input",{ref:pe,type:"file",accept:".pdf",onChange:Ge,className:"hidden"}),e.jsxs(T,{variant:"outline",size:"lg",onClick:()=>{var m;return(m=pe.current)==null?void 0:m.click()},children:[e.jsx(it,{className:"mr-2 h-4 w-4"}),"Choose File"]})]}),N&&e.jsx(T,{size:"lg",className:"w-full",onClick:Ze,disabled:fe,children:fe?e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"mr-2 h-4 w-4 animate-spin"}),"Uploading..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ie,{className:"mr-2 h-4 w-4"}),"Use This File"]})})]})]})})})]})})}),e.jsx(we,{open:F,onOpenChange:_,children:e.jsxs(Se,{className:"max-w-4xl",children:[e.jsxs(je,{children:[e.jsx(ye,{children:"Draw Your Signature"}),e.jsx(Ne,{children:"Draw your signature below. This will replace any existing signatures."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"border rounded-lg p-4 bg-muted/30",children:e.jsx(rt,{ref:j,penColor:"black",backgroundColor:"rgba(0,0,0,0)",minWidth:2,maxWidth:4,velocityFilterWeight:.7,canvasProps:{width:690,height:300,className:"border border-border rounded bg-background w-full",style:{cursor:"crosshair"}},onEnd:be})}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsxs(T,{variant:"outline",onClick:()=>{var m;(m=j.current)==null||m.clear(),be()},children:[e.jsx(ct,{className:"mr-2 h-4 w-4"}),"Clear"]}),e.jsx(T,{variant:"outline",onClick:()=>_(!1),children:"Cancel"}),e.jsx(T,{onClick:Be,disabled:O,children:O?e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"mr-2 h-4 w-4 animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ie,{className:"mr-2 h-4 w-4"}),"Save Signature"]})})]})]})]})})]})}export{mr as default};
