import{K as M,r as a,j as e,R as L}from"./app-CQngmq00.js";import _ from"./pending-defense-request-widget-Wll2GlDq.js";import H from"./weekly-defense-schedule-widget-neNTVngQ.js";import U from"./quick-actions-widget-CFXp9tUk.js";import{C as B}from"./card-C_emSl4Q.js";import{S as m}from"./skeleton-Dhy5gbzz.js";import Y from"./defense-count-BiU_WDs9.js";import{T as K,a as O,b as y,c as N}from"./tabs-DJOYkXMD.js";import{CoordinatorMostActivePrograms as Q}from"./coordinator-most-active-programs-CVSVLb4n.js";import{CoordinatorAdviserStudentRatio as V}from"./coordinator-adviser-student-ratio-CDSQLYfc.js";import{CoordinatorDefenseScheduleTrends as $}from"./coordinator-defense-schedule-trends-CX1lfq1V.js";import{C as w}from"./clipboard-list-D93gqQbk.js";import{C as G}from"./calendar-days-DHLDYaT_.js";import{B as I}from"./badge-dollar-sign-DPXQOWgc.js";import{U as k}from"./users-DZ67WViD.js";import{S as J,M as X}from"./sun-5m6UvoyG.js";import"./graduation-cap-DHFIPOzN.js";import"./createLucideIcon-pjYyoixj.js";import"./chevron-right-QGs8lTP5.js";import"./constructNow-Chb2L4Vx.js";import"./en-US-BA9orzCf.js";import"./getRoundingMethod-Btu-7J5l.js";import"./parseISO-CbXPh3Al.js";import"./utils-jAU0Cazi.js";import"./calendar-Bi5dAEy5.js";import"./format-HX8DKPSU.js";import"./isSameDay-DUlCFK42.js";import"./tooltip-BvePKNvs.js";import"./index-DRp-GX9j.js";import"./index-CDDLQrUy.js";import"./floating-ui.react-dom-DL84dtXf.js";import"./user-round-Re0lcQTC.js";import"./settings-CDLWUJwV.js";import"./receipt-CoKWPx4G.js";import"./book-open-BEj5GOyH.js";import"./button-Cw9tQIeO.js";import"./index-DZZQifJx.js";import"./generateCategoricalChart-RpaH3faT.js";import"./index-BGXDct6C.js";import"./index-Chjiymov.js";import"./AreaChart-Cnc-_-2A.js";import"./YAxis-CFpew_UZ.js";import"./chart-BC_ZPf9S.js";import"./BarChart-C9yfhd02.js";import"./PolarAngleAxis-J6U1uu9p.js";import"./LineChart-DccwEbWW.js";import"./CartesianGrid-D1brq1mr.js";function Z(){return new Date().toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"})}function ee(){const s=new Date().getHours();return s>=6&&s<18}function te(s){const i=new Set;let n=0;return s.forEach(r=>{Array.isArray(r.panelists)&&r.panelists.forEach(o=>{o!=null&&o.id&&(i.add(o.id),n++)})}),{totalPanelists:i.size,assignedPanelists:n}}function se(s){const i=new Date;return s.filter(n=>{if(!n.scheduled_date)return!1;const r=new Date(n.scheduled_date);return r.getFullYear()===i.getFullYear()&&r.getMonth()===i.getMonth()&&r.getDate()===i.getDate()}).length}function et(){const{auth:{user:s},panelists:i}=M().props,[n,r]=a.useState([]),[o,g]=a.useState([]),[ae,u]=a.useState([]),[x,D]=a.useState(!0),[ie,h]=a.useState(0),[ne,f]=a.useState(0),[z,b]=a.useState(0),[S,A]=a.useState(new Date().getDay()),[T,v]=a.useState(0),C=[{label:"Sun",value:0},{label:"Mon",value:1},{label:"Tue",value:2},{label:"Wed",value:3},{label:"Thu",value:4},{label:"Fri",value:5},{label:"Sat",value:6}],[P,R]=a.useState("overview");a.useEffect(()=>{fetch("/defense-requests",{headers:{Accept:"application/json"}}).then(t=>{if(!t.ok)throw new Error("Failed");return t.json()}).then(t=>{const l=Array.isArray(t)?t:t.defenseRequests??[];r(l);const c=l.filter(d=>(d.normalized_status||d.status)==="Pending");g(c);const p=new Date,F=l.filter(d=>{if(!d.scheduled_date)return!1;const j=(new Date(d.scheduled_date).getTime()-p.getTime())/(1e3*60*60*24);return j>=0&&j<3});u(F)}).catch(()=>{r([]),g([]),u([])}).finally(()=>D(!1)),fetch("/api/panelists/count",{headers:{Accept:"application/json"}}).then(t=>t.ok?t.json():{count:0}).then(t=>{h(t.count??0)}).catch(()=>h(0)),fetch("/api/assigned-panelists/count",{headers:{Accept:"application/json"}}).then(t=>t.ok?t.json():{assignedPanelists:0}).then(t=>{f(t.assignedPanelists??0)}).catch(()=>f(0)),fetch("/api/coordinator/advisers",{headers:{Accept:"application/json"}}).then(t=>t.ok?t.json():[]).then(t=>{const l=Array.isArray(t)?t:t.advisers??t;b(l.length??0)}).catch(()=>b(0)),fetch("/api/coordinator/programs",{headers:{Accept:"application/json"}}).then(t=>t.ok?t.json():[]).then(t=>{v(Array.isArray(t)?t.length:0)}).catch(()=>v(0))},[]),te(n);const E=se(n),q=Array.isArray(i)?i.length:0,W=[{title:"Pending Defense Requests",value:o.length,description:"Awaiting coordinator action",icon:e.jsx(w,{className:"size-5 text-rose-500"}),iconTheme:"bg-rose-100 text-rose-600 dark:bg-rose-900 dark:text-rose-300"},{title:"Today's Defense Schedules",value:E,description:"Defenses scheduled for today",icon:e.jsx(G,{className:"size-5 text-blue-500"}),iconTheme:"bg-blue-100 text-blue-600 dark:bg-blue-900 dark:text-blue-300"},{title:"Pending Honorariums",value:7,description:"Honorariums not yet processed",icon:e.jsx(I,{className:"size-5 text-amber-500"}),iconTheme:"bg-amber-100 text-amber-600 dark:bg-amber-900 dark:text-amber-300"},{title:"Assigned Programs",value:T,description:"Programs you coordinate",icon:e.jsx(w,{className:"size-5 text-violet-500"}),iconTheme:"bg-violet-100 text-violet-600 dark:bg-violet-900 dark:text-violet-300"},{title:"Advisers",value:z,description:"Total advisers linked to you",icon:e.jsx(k,{className:"size-5 text-green-500"}),iconTheme:"bg-green-100 text-green-600 dark:bg-green-900 dark:text-green-300"},{title:"Panelists",value:e.jsx("span",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:q}),description:"Panelists assigned",icon:e.jsx(k,{className:"size-5 text-violet-500"}),iconTheme:"bg-violet-100 text-violet-600 dark:bg-violet-900 dark:text-violet-300"}];return e.jsx("div",{className:"flex h-full flex-1 flex-col gap-4 overflow-auto bg-white dark:bg-background",children:x?e.jsxs("div",{className:"w-full min-h-[70vh] bg-zinc-100 dark:bg-zinc-900 flex flex-col gap-4 p-0 m-0",children:[e.jsx(m,{className:"h-6 w-1/6 rounded bg-zinc-300 dark:bg-zinc-800 mt-8 mx-8"}),e.jsx(m,{className:"h-12 w-3/4 rounded bg-zinc-300 dark:bg-zinc-800 mx-8"}),e.jsx(m,{className:"h-12 w-2/3 rounded bg-zinc-300 dark:bg-zinc-800 mx-8"}),e.jsx(m,{className:"h-[500px] w-full rounded bg-zinc-300 dark:bg-zinc-800 mt-4"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-4 md:mb-7 mt-2 md:mt-3 pt-2 md:pt-3 px-4 md:px-7",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center gap-4 md:gap-0 relative overflow-hidden",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("span",{className:"flex items-center text-xs font-semibold text-gray-700 dark:text-gray-200 mb-1 md:mb-2 relative z-10",children:[ee()?e.jsx(J,{className:"mr-1 size-3 md:size-4 text-rose-500"}):e.jsx(X,{className:"mr-1 size-3 md:size-4 text-rose-500"}),Z()]}),e.jsxs("h1",{className:"text-xl md:text-2xl lg:text-3xl font-bold text-gray-900 dark:text-white relative z-10",children:["Hi, ",s==null?void 0:s.name,"!"]}),e.jsx("span",{className:"text-xs text-gray-400 dark:text-gray-500 mt-1 relative z-10",children:(s==null?void 0:s.role)??"Student"})]}),e.jsxs("div",{className:"hidden md:flex items-center",children:[e.jsx("div",{className:"h-12 w-px mx-4 bg-gray-300 dark:bg-gray-700 opacity-60"}),e.jsx("div",{className:"mr-8",children:e.jsx(U,{userRole:s==null?void 0:s.role})})]})]})}),e.jsx("div",{className:"w-full px-4 md:px-7",children:e.jsxs(K,{value:P,onValueChange:R,className:"",children:[e.jsxs(O,{className:"mb-2 ",children:[e.jsx(y,{value:"overview",className:"flex-1 ",children:"Overview"}),e.jsx(y,{value:"analytics",className:"flex-1 ",children:"Analytics"})]}),e.jsxs(N,{value:"overview",className:"w-full",children:[e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3 md:gap-4 px-0 mb-4 md:mb-6",children:W.map((t,l)=>{var c;return e.jsxs(B,{className:"col-span-1 rounded-lg md:rounded-xl border border-gray-200 dark:border-zinc-800 bg-white dark:bg-zinc-900 shadow-sm flex flex-col justify-between p-0 min-h-0 h-auto transition hover:shadow-md",style:{minWidth:0},children:[e.jsxs("div",{className:"flex items-center justify-between px-4 md:px-5 pt-3 md:pt-4 pb-0",children:[e.jsx("div",{className:"text-xs md:text-sm font-extrabold text-gray-800 dark:text-zinc-100 leading-tight",children:t.title}),e.jsx("div",{className:`rounded-full p-1 md:p-1.5 flex items-center justify-center flex-shrink-0 ${t.iconTheme}`,children:L.cloneElement(t.icon,{className:"size-3 md:size-4 font-extrabold "+(((c=t.iconTheme)==null?void 0:c.split(" ").find(p=>p.startsWith("text-")))??"")})})]}),e.jsxs("div",{className:"flex flex-col px-4 md:px-5 pb-3 md:pb-4 pt-1 md:pt-2",children:[e.jsx("span",{className:"text-xl md:text-2xl font-bold text-gray-900 dark:text-white leading-none",children:t.value}),e.jsx("span",{className:"text-xs text-gray-400 dark:text-gray-500 mt-1 truncate",children:t.description})]})]},l)})}),e.jsx("div",{className:"flex flex-col gap-4 md:gap-6 bg-gray-100 dark:bg-muted rounded-lg md:rounded-xl mt-2 mb-2 px-3 md:px-4 py-4 md:py-8 w-full",children:e.jsxs("div",{className:"w-full mb-2 flex flex-col gap-4",children:[e.jsx(H,{weekDays:C,selectedDay:S,setSelectedDay:A,approvedDefenses:n,referenceDate:new Date,loading:x}),e.jsx(_,{pendingRequests:o,loading:x})]})})]}),e.jsx(N,{value:"analytics",className:"w-full",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 md:gap-6 mb-4 md:mb-6",children:[e.jsx("div",{className:"col-span-1 md:col-span-2",children:e.jsx($,{})}),e.jsx("div",{className:"col-span-1 md:col-span-2",children:e.jsx(Y,{})}),e.jsx("div",{className:"col-span-1 md:col-span-2 lg:col-span-2",children:e.jsx(Q,{})}),e.jsx("div",{className:"col-span-1 md:col-span-2 lg:col-span-2",children:e.jsx(V,{})})]})})]})})]})})}export{et as default};
