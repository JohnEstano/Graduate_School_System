import{r as n,j as e,S as T}from"./app-DW0Mt5c9.js";import{T as U,a as W,b as w,c as l,d as X,e as i}from"./table-CYsX4eCK.js";import{C as R}from"./checkbox-fbuYKHl8.js";import{B as q}from"./badge-B7OUzsXL.js";import{D as _,d as G,a as F}from"./dialog-D7L72BhV.js";import{B as o}from"./button-BZf0VdIO.js";import J from"./details-DOuRzVBA.js";import{D as K,a as Q,b as V,d as g}from"./dropdown-menu-FJcetjAu.js";import{T as Y}from"./textarea-DlzvW0NA.js";import{A as Z,a as ee,b as te,c as se,d as re,e as ae,f as ne,g as ie,h as le}from"./alert-dialog-CRrgAssw.js";import{F as oe}from"./filter-Cr34U9tD.js";import{C as j}from"./check-C1Ca0PY3.js";import{I as de}from"./info-Dl-vg0Zq.js";import{C as ce}from"./circle-x-C4V9EZEC.js";import{C as me}from"./circle-check-big-CG9wjNDm.js";import{C as xe}from"./circle-arrow-left-BUa1uPht.js";import{f as pe}from"./format-HX8DKPSU.js";import"./utils-jAU0Cazi.js";import"./index-xrb8sl6P.js";import"./index-DHu7YzAG.js";import"./index-I9YLalqX.js";import"./index-dxfJWdT_.js";import"./index-D1ThX8Vn.js";import"./index-Bwn0NV8Z.js";import"./index-RzYQM1sh.js";import"./index-DZZQifJx.js";import"./index-BMNAwHVU.js";import"./index-Bh88FqJG.js";import"./x-CW6T59GI.js";import"./createLucideIcon-S0dKkUVo.js";import"./credit-card-Bzx9FpUt.js";import"./user-round-uxkoyzJB.js";import"./mail-DTFdjxel.js";import"./graduation-cap-d15gjgNL.js";import"./receipt-CRIcjQd7.js";import"./index-Au_TdUcj.js";import"./floating-ui.react-dom-DEJ-U2zP.js";import"./en-US-BA9orzCf.js";function tt({paged:m,columns:r,tabType:v,onRowApprove:ue,onRowReject:he,onRowRetrieve:C}){const[f,y]=n.useState([]),[D,I]=n.useState(null),[M,b]=n.useState(null),[z,x]=n.useState(null),[p,k]=n.useState(""),[d,u]=n.useState(!1),[a,h]=n.useState("all"),A=f.length>0&&f.length===m.length,N=n.useMemo(()=>[...m].sort((t,s)=>{const c=t.submitted_at?new Date(t.submitted_at).getTime():-1/0;return(s.submitted_at?new Date(s.submitted_at).getTime():-1/0)-c}),[m]),S=n.useMemo(()=>a==="all"?N:N.filter(t=>t.status===a),[N,a]);function B(){y(A?[]:m.map(t=>t.id))}function P(t){y(s=>s.includes(t)?s.filter(c=>c!==t):[...s,t])}const H=t=>{const s=String(t||"pending").toLowerCase(),c=s==="approved"?"bg-green-100 text-green-700 border-green-200 dark:bg-green-950 dark:text-green-300 dark:border-green-900":s==="rejected"?"bg-rose-100 text-rose-700 border-rose-200 dark:bg-rose-950 dark:text-rose-300 dark:border-rose-900":"bg-amber-100 text-amber-700 border-amber-200 dark:bg-amber-950 dark:text-amber-300 dark:border-amber-900";return e.jsx(q,{className:`rounded-full ${c}`,variant:"outline",children:s[0].toUpperCase()+s.slice(1)})},O=t=>t==null||isNaN(Number(t))?"—":new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP",maximumFractionDigits:2}).format(Number(t)),$=a==="all"?"All":a[0].toUpperCase()+a.slice(1);function L(t){u(!0),T.post(route("coordinator.compre-payment.approve",t),{},{preserveScroll:!0,onFinish:()=>{u(!1),b(null)}})}function E(t){p.trim()&&(u(!0),T.post(route("coordinator.compre-payment.reject",t),{remarks:p.trim()},{preserveScroll:!0,onFinish:()=>{u(!1),x(null),k("")}}))}return e.jsxs("div",{className:"rounded-md overflow-x-auto border border-border bg-white dark:bg-background dark:border-border w-full max-w-full",children:[e.jsx("div",{className:"flex items-center justify-end gap-2 px-3 py-2 border-b bg-muted/20 dark:bg-muted/10",children:e.jsxs(K,{children:[e.jsx(Q,{asChild:!0,children:e.jsxs(o,{variant:"outline",size:"sm",className:"h-8",children:[e.jsx(oe,{className:"mr-2 h-4 w-4"}),"Status: ",$]})}),e.jsxs(V,{align:"end",className:"w-44",children:[e.jsxs(g,{onClick:()=>h("all"),className:"flex items-center justify-between",children:["All ",a==="all"&&e.jsx(j,{className:"h-4 w-4"})]}),e.jsxs(g,{onClick:()=>h("pending"),className:"flex items-center justify-between",children:["Pending ",a==="pending"&&e.jsx(j,{className:"h-4 w-4"})]}),e.jsxs(g,{onClick:()=>h("approved"),className:"flex items-center justify-between",children:["Approved ",a==="approved"&&e.jsx(j,{className:"h-4 w-4"})]}),e.jsxs(g,{onClick:()=>h("rejected"),className:"flex items-center justify-between",children:["Rejected ",a==="rejected"&&e.jsx(j,{className:"h-4 w-4"})]})]})]})}),e.jsxs(U,{className:"min-w-[900px] text-sm dark:text-muted-foreground",children:[e.jsx(W,{children:e.jsxs(w,{className:"dark:bg-muted/40",children:[e.jsx(l,{className:"w-[4%] py-2 dark:bg-muted/30 dark:text-muted-foreground",children:e.jsx(R,{checked:A,onCheckedChange:B})}),r.student&&e.jsx(l,{className:"w-[22%] px-2 dark:bg-muted/30 dark:text-muted-foreground",children:"Student"}),r.program&&e.jsx(l,{className:"w-[18%] px-2 dark:bg-muted/30 dark:text-muted-foreground",children:"Program"}),r.reference&&e.jsx(l,{className:"w-[16%] px-2 dark:bg-muted/30 dark:text-muted-foreground",children:"OR / Reference"}),r.amount&&e.jsx(l,{className:"w-[10%] text-right px-2 py-2 dark:bg-muted/30 dark:text-muted-foreground",children:"Amount"}),r.date&&e.jsx(l,{className:"w-[12%] text-center px-1 py-2 dark:bg-muted/30 dark:text-muted-foreground",children:"Date"}),r.status&&e.jsx(l,{className:"w-[12%] text-center px-1 py-2 dark:bg-muted/30 dark:text-muted-foreground",children:"Status"}),r.actions&&e.jsx(l,{className:"w-[14%] px-1 py-2 text-center dark:bg-muted/30 dark:text-muted-foreground",children:"Actions"})]})}),e.jsxs(X,{children:[S.map(t=>e.jsxs(w,{className:"hover:bg-muted/50 dark:hover:bg-muted/70",children:[e.jsx(i,{className:"px-2 py-2",children:e.jsx(R,{checked:f.includes(t.id),onCheckedChange:()=>P(t.id)})}),r.student&&e.jsxs(i,{className:"px-2 py-2 font-semibold truncate leading-tight dark:text-foreground",style:{maxWidth:"220px"},children:[e.jsxs("div",{className:"truncate",title:`${t.last_name}, ${t.first_name}`,children:[t.last_name,", ",t.first_name," ",t.middle_name?`${t.middle_name[0]}.`:""]}),e.jsxs("div",{className:"text-xs font-normal text-muted-foreground mt-1 truncate",children:[t.email||"—"," ",t.school_id?`• ${t.school_id}`:""]})]}),r.program&&e.jsx(i,{className:"px-2 py-2",children:e.jsx("span",{className:"truncate block",children:t.program||"—"})}),r.reference&&e.jsx(i,{className:"px-2 py-2",children:e.jsx("span",{className:"truncate block",children:t.reference||"—"})}),r.amount&&e.jsx(i,{className:"px-2 py-2 text-right",children:O(t.amount)}),r.date&&e.jsx(i,{className:"px-1 py-2 text-center whitespace-nowrap",children:t.submitted_at?pe(new Date(t.submitted_at),"MMM dd, yyyy"):"—"}),r.status&&e.jsx(i,{className:"px-1 py-2 text-center",children:H(t.status)}),r.actions&&e.jsx(i,{className:"px-1 py-2 text-center",children:e.jsxs("div",{className:"flex gap-1 justify-center",children:[e.jsxs(_,{children:[e.jsx(G,{asChild:!0,children:e.jsx(o,{size:"sm",variant:"outline",onClick:()=>I(t),title:"Details",className:"dark:bg-muted/30",children:e.jsx(de,{})})}),e.jsx(F,{className:"max-w-3xl min-w-260 w-full max-h-[90vh]",children:e.jsx("div",{className:"max-h-[80vh] overflow-y-auto px-1",children:D&&e.jsx(J,{payment:D})})})]}),v==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx(o,{size:"sm",variant:"outline",title:"Reject",onClick:()=>{x(t.id),k("")},className:"text-red-500 hover:text-red-500",children:e.jsx(ce,{size:16})}),e.jsxs(Z,{open:M===t.id,onOpenChange:s=>!s&&b(null),children:[e.jsx(ee,{asChild:!0,children:e.jsx(o,{size:"sm",variant:"outline",title:"Approve",onClick:()=>b(t.id),className:"text-green-500 hover:text-green-500",children:e.jsx(me,{size:16})})}),e.jsxs(te,{children:[e.jsxs(se,{children:[e.jsx(re,{children:"Approve this payment?"}),e.jsx(ae,{children:"This will mark the submission as approved. The student will see the status update."})]}),e.jsxs(ne,{children:[e.jsx(ie,{disabled:d,children:"Cancel"}),e.jsx(le,{disabled:d,onClick:()=>L(t.id),children:d?"Approving…":"Approve"})]})]})]}),e.jsx(_,{open:z===t.id,onOpenChange:s=>!s&&x(null),children:e.jsx(F,{className:"max-w-md",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-base font-semibold",children:"Reject this payment"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Provide a reason. The student will see this message."}),e.jsx(Y,{value:p,onChange:s=>k(s.target.value),placeholder:"Reason for rejection",rows:4}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsx(o,{variant:"outline",onClick:()=>x(null),disabled:d,children:"Cancel"}),e.jsx(o,{variant:"destructive",onClick:()=>E(t.id),disabled:d||p.trim().length<3,children:d?"Rejecting…":"Confirm Reject"})]})]})})})]}),v==="rejected"&&e.jsx(o,{size:"sm",variant:"outline",title:"Retrieve",onClick:()=>C&&C(t.id),className:"text-blue-500 hover:text-blue-500",children:e.jsx(xe,{size:16})})]})})]},t.id)),S.length===0&&e.jsx(w,{children:e.jsx(i,{colSpan:Object.values(r).filter(Boolean).length+1,className:"text-center py-16",children:e.jsx("div",{className:"text-muted-foreground",children:"No records found."})})})]})]})]})}export{tt as default};
