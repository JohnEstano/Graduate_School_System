import{r as o,j as e,S as G,a as J}from"./app-DdPj2m7B.js";import{d as K}from"./dayjs.min-D6wfwQTr.js";import{P as E,a as I,b as L}from"./popover-tBQRRq13.js";import{I as Q}from"./input-DCrn1t-u.js";import{T as W,a as q,b as _,c as m,d as ee,e as d}from"./table-C8ztdzxp.js";import{B as a}from"./button-C4XkiM_B.js";import{C as v}from"./checkbox-DDzRYWAy.js";import{B as A}from"./badge-ofr1GoIX.js";import{c as se,T as te,a as re,b as ae}from"./tooltip-YyHP33lU.js";import{t as P}from"./index-B2MlTwnV.js";import{D as le,a as ie,e as ne,b as oe,f as de}from"./dialog-BeApitpu.js";import{g as M}from"./program-abbreviations-BcvFCzIW.js";import{c as ce}from"./createLucideIcon-B8qZ3ylK.js";import{S as pe}from"./search-gvHM0uxt.js";import{C as O}from"./circle-plus-DNS-2CjW.js";import{X as H}from"./x-gfWO9KfB.js";import{C as me}from"./circle-check-big-CKCqbWb4.js";import{C as xe}from"./circle-x-BzZWIzCj.js";import{C as he}from"./circle-arrow-left-Bx1mKyRQ.js";import{T as ue}from"./trash-2-oufS_Sxw.js";import{P as ge}from"./printer-8ps6np5W.js";import{P as fe}from"./paperclip-CZJ8UXmI.js";import"./index-C0AcbnKJ.js";import"./index-DYEC1Owk.js";import"./floating-ui.react-dom-qFQCHW7g.js";import"./index-DRr-UIpQ.js";import"./utils-jAU0Cazi.js";import"./index-DZZQifJx.js";import"./index-DxK34XW3.js";import"./index-ATT6OHxL.js";import"./index-DGKk-Zer.js";import"./index-DFD1OPps.js";import"./index-BdQOngYf.js";import"./check-BgnkF1LW.js";import"./index-DDxX9UbU.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]],je=ce("File",be);function S(i){const h=i.middle_name?`${i.middle_name[0].toUpperCase()}. `:"";return`${i.first_name} ${h}${i.last_name}`}function we(i){const h=[{key:"manuscript_proposal",label:"Manuscript"},{key:"similarity_index",label:"Similarity"},{key:"rec_endorsement",label:"REC Endorsement"},{key:"proof_of_payment",label:"Proof of Payment"},{key:"advisers_endorsement",label:"Adviser Endorsement"},{key:"avisee_adviser_attachment",label:"Avisee-Adviser File"}];return e.jsx(se,{children:e.jsx("div",{className:"flex gap-1",children:h.map(u=>i[u.key]?e.jsxs(te,{children:[e.jsx(re,{asChild:!0,children:e.jsx("a",{href:`/storage/${i[u.key]}`,target:"_blank",rel:"noopener noreferrer",className:"group",onClick:y=>y.stopPropagation(),children:e.jsx("span",{className:"inline-flex items-center justify-center rounded bg-rose-500 hover:bg-rose-600 transition-colors w-7 h-7",children:e.jsx(fe,{className:"h-4 w-4 text-white"})})})}),e.jsx(ae,{side:"top",className:"text-xs bg-black text-white border-none shadow-lg",children:u.label})]},u.key):null)})})}function as({defenseRequests:i=[],coordinator:h,title:u="All Defense Requirements",description:y="Review, approve, or reject defense requests from your advisees"}){const[N,z]=o.useState(""),[n,w]=o.useState([]),[ve,T]=o.useState(null),[ye,Y]=o.useState(!1),[c,k]=o.useState([]),[p,C]=o.useState([]),[R,D]=o.useState(!1),[g,$]=o.useState(!1),[x,f]=o.useState(null),b=i.filter(s=>{var F;const t=S(s).toLowerCase(),r=((F=s.thesis_title)==null?void 0:F.toLowerCase())||"",j=N.toLowerCase();let l=t.includes(j)||r.includes(j);return c.length&&(l=l&&c.includes(s.priority||"")),p.length&&(l=l&&p.includes(s.defense_type||"")),l}),B=n.length===b.length&&b.length>0,X=()=>w(B?[]:b.map(s=>s.id)),U=s=>w(n.includes(s)?n.filter(t=>t!==s):[...n,s]);function V(){const s=i.filter(r=>n.includes(r.id)),t=window.open("","","height=900,width=1200");t&&(t.document.write(`
          <html>
            <head>
              <title>Print Selected</title>
              <style>
                body{font-family:Arial;padding:32px}
                h1{font-size:18px;margin:0 0 16px}
                table{border-collapse:collapse;width:100%}
                th,td{border:1px solid #ccc;padding:6px 8px;font-size:12px;text-align:left}
              </style>
            </head>
            <body>
              <h1>Defense Requests</h1>
              <table>
                <thead><tr><th>ID</th><th>Title</th><th>Presenter</th><th>Type</th><th>Status</th></tr></thead>
                <tbody>
                  ${s.map(r=>`<tr>
                    <td>${r.id}</td>
                    <td>${r.thesis_title}</td>
                    <td>${r.first_name} ${r.last_name}</td>
                    <td>${r.defense_type}</td>
                    <td>${r.adviser_status==="Approved"?"Endorsed":r.adviser_status||"—"}</td>
                  </tr>`).join("")}
                </tbody>
              </table>
              <script>window.print()<\/script>
            </body>
          </html>
        `),t.document.close())}const Z=async s=>{var r,j;$(!0);const t=P.loading(s==="approve"?"Approving selected...":s==="reject"?"Rejecting selected...":"Retrieving selected...");try{let l="";s==="approve"?l="/defense-requests/bulk-approve":s==="reject"?l="/defense-requests/bulk-reject":s==="retrieve"&&(l="/defense-requests/bulk-retrieve"),await J.post(l,{ids:n}),P.success(s==="approve"?"Requests approved and sent to your coordinator!":s==="reject"?"Requests rejected.":"Requests retrieved for review.",{id:t}),w([]),f(null),T(null),window.location.reload()}catch(l){P.error(((j=(r=l.response)==null?void 0:r.data)==null?void 0:j.error)||`Bulk ${s} failed.`,{id:t})}finally{$(!1)}};return e.jsxs("div",{className:"flex flex-col flex-1 w-full min-h-[90vh] gap-2  pr-3 pl-0 relative overflow-x-hidden",children:[e.jsxs("div",{className:"w-full bg-white dark:bg-zinc-900 border border-border rounded-lg overflow-hidden mb-2",children:[e.jsx("div",{className:"flex flex-row items-center justify-between w-full p-3 border-b border-border bg-white dark:bg-zinc-900",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-10 w-10 flex items-center justify-center rounded-full bg-blue-500/10 dark:bg-blue-900/30 border border-blue-500 dark:border-blue-400",children:e.jsx(je,{className:"h-5 w-5 text-blue-400 dark:text-blue-300"})}),e.jsxs("div",{children:[e.jsx("span",{className:"text-base font-semibold text-zinc-900 dark:text-zinc-100",children:u}),e.jsx("span",{className:"block text-xs text-muted-foreground dark:text-zinc-400",children:y})]})]})}),e.jsx("div",{className:"flex items-center justify-between gap-2 px-4 py-3 border-b border-border bg-white dark:bg-zinc-900",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{type:"text",startIcon:pe,placeholder:"Search...",value:N,onChange:s=>z(s.target.value),className:"max-w-xs text-sm h-8"}),e.jsxs(E,{open:R==="priority",onOpenChange:s=>D(s?"priority":!1),children:[e.jsx(I,{asChild:!0,children:e.jsxs(a,{variant:"outline",className:"h-8 px-3 rounded-md border-dashed text-xs flex items-center gap-1",children:[e.jsx(O,{className:"h-4 w-4 mr-1"}),"Priority",c.length>0&&e.jsx("span",{className:"ml-1 px-2 py-0.5 rounded-full text-xs bg-muted",children:c.length>1?`${c.length} selected`:c[0]})]})}),e.jsxs(L,{className:"w-44 p-1",side:"bottom",align:"start",children:[["Low","Medium","High"].map(s=>e.jsxs("div",{onClick:()=>k(t=>t.includes(s)?t.filter(r=>r!==s):[...t,s]),className:"flex items-center gap-2 p-2 rounded hover:bg-muted cursor-pointer",children:[e.jsx(v,{checked:c.includes(s)}),e.jsx("span",{className:"text-sm",children:s})]},s)),e.jsx(a,{size:"sm",variant:"ghost",className:"w-full mt-2",onClick:()=>k([]),children:"Clear"})]})]}),e.jsxs(E,{open:R==="type",onOpenChange:s=>D(s?"type":!1),children:[e.jsx(I,{asChild:!0,children:e.jsxs(a,{variant:"outline",className:"h-8 px-3 rounded-md border-dashed text-xs flex items-center gap-1",children:[e.jsx(O,{className:"h-4 w-4 mr-1"}),"Type",p.length>0&&e.jsx("span",{className:"ml-1 px-2 py-0.5 rounded-full text-xs bg-muted",children:p.length>1?`${p.length} selected`:p[0]})]})}),e.jsxs(L,{className:"w-44 p-1",side:"bottom",align:"start",children:[["Proposal","Prefinal","Final"].map(s=>e.jsxs("div",{onClick:()=>C(t=>t.includes(s)?t.filter(r=>r!==s):[...t,s]),className:"flex items-center gap-2 p-2 rounded hover:bg-muted cursor-pointer",children:[e.jsx(v,{checked:p.includes(s)}),e.jsx("span",{className:"text-sm",children:s})]},s)),e.jsx(a,{size:"sm",variant:"ghost",className:"w-full mt-2",onClick:()=>C([]),children:"Clear"})]})]}),(c.length>0||p.length>0||N.trim())&&e.jsxs(a,{variant:"ghost",size:"sm",className:"h-8 px-3 flex items-center gap-1",onClick:()=>{k([]),C([]),z("")},children:[e.jsx(H,{size:14})," Reset"]})]})})]}),e.jsx("div",{className:"flex-1 flex flex-col gap-4 w-full min-h-0 overflow-x-hidden",children:e.jsx("div",{className:"flex flex-col w-full min-h-0 overflow-x-hidden",children:e.jsx("div",{className:"relative w-full max-w-full",children:e.jsx("div",{className:"w-full max-w-full",children:e.jsx("div",{className:"overflow-x-auto w-full rounded-md border border-border bg-background",children:e.jsxs(W,{className:"min-w-[900px] w-full text-sm table-auto",children:[e.jsx(q,{children:e.jsxs(_,{children:[e.jsx(m,{className:"w-[40px] px-3 py-2",children:e.jsx(v,{checked:B,onCheckedChange:X,"aria-label":"Select all"})}),e.jsx(m,{className:"px-3 py-2 min-w-[220px] whitespace-nowrap",children:"Thesis Title"}),e.jsx(m,{className:"px-3 py-2 min-w-[120px] whitespace-nowrap",children:"Presenter"}),e.jsx(m,{className:"px-3 py-2 min-w-[100px] whitespace-nowrap",children:"Program"}),e.jsx(m,{className:"px-3 py-2 min-w-[130px] text-center whitespace-nowrap",children:"Submitted"}),e.jsx(m,{className:"px-3 py-2 min-w-[180px] whitespace-nowrap",children:"Attachments"}),e.jsx(m,{className:"px-3 py-2 min-w-[120px] text-center whitespace-nowrap",children:"Adviser Status"}),e.jsx(m,{className:"px-3 py-2 min-w-[120px] text-center whitespace-nowrap",children:"Coordinator Status"})]})}),e.jsxs(ee,{children:[b.map(s=>{const t=n.includes(s.id);return e.jsxs(_,{className:"hover:bg-muted/40 cursor-pointer",onClick:()=>G.visit(`/adviser/defense-requirements/${s.id}/details`),children:[e.jsx(d,{className:"px-3 py-2 align-middle",children:e.jsx(v,{checked:t,onCheckedChange:()=>U(s.id),className:"action-btn",onClick:r=>r.stopPropagation()})}),e.jsxs(d,{className:"px-3 py-2 font-medium truncate leading-tight align-middle whitespace-nowrap max-w-[260px]",title:s.thesis_title,children:[s.defense_type&&e.jsx(A,{variant:"outline",className:"mr-2",children:s.defense_type}),e.jsx("span",{children:s.thesis_title})]}),e.jsx(d,{className:"px-3 py-2 text-xs text-muted-foreground whitespace-nowrap align-middle max-w-[140px] truncate",title:S(s),children:S(s)}),e.jsx(d,{className:"px-3 py-2 text-xs text-muted-foreground whitespace-nowrap align-middle max-w-[100px] truncate",title:M(s.program),children:M(s.program)||"—"}),e.jsx(d,{className:"px-3 py-2 text-xs text-muted-foreground whitespace-nowrap text-center align-middle max-w-[120px] truncate",children:s.created_at?K(s.created_at).format("YYYY-MM-DD hh:mm A"):"—"}),e.jsx(d,{className:"px-3 py-2 max-w-[180px] truncate align-middle",children:e.jsx(we,{...s})}),e.jsx(d,{className:"px-3 py-2 text-xs whitespace-nowrap text-center align-middle",children:e.jsx(A,{className:s.adviser_status==="Endorsed"?"bg-green-100 text-green-700 border-green-200":s.adviser_status==="Rejected"?"bg-red-100 text-red-700 border-red-200":s.adviser_status==="Pending"?"bg-yellow-100 text-yellow-700 border-yellow-200":"bg-gray-100 text-gray-700 border-gray-200",children:s.adviser_status==="Approved"?"Endorsed":s.adviser_status||"—"})}),e.jsx(d,{className:"px-3 py-2 text-xs whitespace-nowrap text-center align-middle",children:e.jsx(A,{className:s.coordinator_status==="Approved"?"bg-green-100 text-green-700 border-green-200":s.coordinator_status==="Rejected"?"bg-red-100 text-red-700 border-red-200":s.coordinator_status==="Pending"?"bg-yellow-100 text-yellow-700 border-yellow-200":"bg-gray-100 text-gray-700 border-gray-200",children:s.coordinator_status||"—"})})]},s.id)}),b.length===0&&e.jsx(_,{children:e.jsx(d,{colSpan:8,className:"text-center py-10 text-muted-foreground",children:"No defense requests found."})})]})]})})})})})}),n.length>0&&e.jsxs("div",{className:"fixed left-1/2 z-30 -translate-x-1/2 bottom-4 md:bottom-6 flex items-center gap-1 bg-white border border-border shadow-lg rounded-lg px-4 py-1 text-xs animate-in fade-in slide-in-from-bottom-2 dark:bg-muted dark:text-muted-foreground dark:border-border",children:[e.jsxs("span",{className:"font-semibold min-w-[70px] text-center",children:[n.length," selected"]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsxs(a,{variant:"ghost",size:"icon",className:"px-3 py-1 h-7 w-auto text-xs flex items-center gap-1",onClick:()=>f("approve"),"aria-label":"Approve",disabled:g,children:[e.jsx(me,{size:13,className:"text-green-500"}),e.jsx("span",{className:"hidden sm:inline",children:"Approve"})]}),e.jsxs(a,{variant:"ghost",size:"icon",className:"px-3 py-1 h-7 w-auto text-xs flex items-center gap-1",onClick:()=>f("reject"),"aria-label":"Reject",disabled:g,children:[e.jsx(xe,{size:13,className:"text-red-500"}),e.jsx("span",{className:"hidden sm:inline",children:"Reject"})]}),e.jsxs(a,{variant:"ghost",size:"icon",className:"px-3 py-1 h-7 w-auto text-xs flex items-center gap-1",onClick:()=>T("retrieve"),"aria-label":"Retrieve",children:[e.jsx(he,{size:13,className:"text-blue-500"}),e.jsx("span",{className:"hidden sm:inline",children:"Retrieve"})]}),e.jsxs(a,{variant:"ghost",size:"icon",className:"px-3 py-1 h-7 w-auto text-xs flex items-center gap-1",onClick:()=>Y(!0),"aria-label":"Delete",children:[e.jsx(ue,{size:13}),e.jsx("span",{className:"hidden sm:inline",children:"Delete"})]}),e.jsxs(a,{variant:"ghost",size:"icon",className:"px-3 py-1 h-7 w-auto text-xs flex items-center gap-1",onClick:V,"aria-label":"Print",children:[e.jsx(ge,{size:13}),e.jsx("span",{className:"hidden sm:inline",children:"Print"})]}),e.jsx(a,{variant:"ghost",size:"icon",className:"px-1 py-1 h-7 w-auto text-xs flex items-center",onClick:()=>w([]),"aria-label":"Clear selection",children:e.jsx(H,{size:14})})]})]}),e.jsx(le,{open:!!x,onOpenChange:s=>!g&&f(null),children:e.jsxs(ie,{children:[e.jsxs(ne,{children:[e.jsx(oe,{children:x==="approve"?"Approve selected requests?":"Reject selected requests?"}),x==="approve"&&h&&e.jsxs("div",{className:"mt-2 text-xs text-muted-foreground",children:["These requests will be forwarded to your coordinator: ",e.jsx("span",{className:"font-semibold",children:h.name})]})]}),e.jsx("div",{className:"text-sm mb-2",children:x==="approve"?"Are you sure you want to approve and forward these requests to your coordinator?":"Are you sure you want to reject these requests? This cannot be undone."}),e.jsxs(de,{children:[e.jsx(a,{variant:"outline",onClick:()=>f(null),disabled:g,children:"Cancel"}),e.jsx(a,{onClick:()=>Z(x),disabled:g,className:"bg-rose-500 hover:bg-rose-600 text-white",children:g?x==="approve"?"Approving...":"Rejecting...":x==="approve"?"Approve":"Reject"})]})]})})]})}export{as as default};
