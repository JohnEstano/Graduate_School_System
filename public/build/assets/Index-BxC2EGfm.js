import{r,j as e,L as T}from"./app-BubHmeqC.js";import{A as k}from"./app-layout-yLDvQPzP.js";import{B as i}from"./button-CX84Ig4W.js";import{C as E}from"./card-Dphj7esD.js";import{I as y}from"./input-y4wBi6jo.js";import{T as O,t as l}from"./index-Bqixm_LI.js";import{D as F,a as R,b as L,c as P}from"./dialog-ywfV6j7b.js";import I from"./table-all-defense-batch-CFR6cI6i.js";import{S as q}from"./send-DnHCHsKV.js";import{R as z}from"./refresh-cw-D1n2GVEV.js";import{P as A}from"./plus-Dt1ajQhA.js";import{X as U}from"./x-DS6n0ElR.js";import"./index-CAAZlwhj.js";import"./index-DZZQifJx.js";import"./utils-jAU0Cazi.js";import"./index-Bsel9b7o.js";import"./index-PQN_369Y.js";import"./index-DyQT7xcZ.js";import"./tooltip-tJz5bvEu.js";import"./floating-ui.react-dom-DwEbxQiH.js";import"./createLucideIcon-Biu-y2hB.js";import"./separator-B1kTuyS6.js";import"./index-1EFpZ92o.js";import"./chevron-right-BRo8ahWW.js";import"./dropdown-menu-BExp8GpF.js";import"./index-6aAr3Pmv.js";import"./index-CVQNv_Nf.js";import"./index-CBu7v5lz.js";import"./index-Zto0mrax.js";import"./check-CZ9c_sEg.js";import"./avatar-DijVPJCE.js";import"./settings-Uvo0cGb6.js";import"./users-wdb3-6X2.js";import"./graduation-cap-B7M__5Eh.js";import"./file-text-B1gFNyH7.js";import"./dollar-sign-DESWnaQ9.js";import"./credit-card-DhKiqKDR.js";import"./tabs-DVolEiAR.js";import"./badge-Dd_ET0uG.js";import"./circle-check-big-BRigqRsr.js";import"./info-DGWfuZKp.js";import"./sun-BLOPCje7.js";import"./table-CLIx8tAs.js";import"./pencil-DPA6PvRF.js";const X=[{value:"ready",label:"Ready for Finance",color:"bg-blue-100 text-blue-700 border-blue-200"},{value:"in_progress",label:"In Progress",color:"bg-yellow-100 text-yellow-700 border-yellow-200"},{value:"paid",label:"Paid",color:"bg-green-100 text-green-700 border-green-200"}];function Re(){const[N,x]=r.useState([]),[h,v]=r.useState(""),[c,b]=r.useState([]),[n,o]=r.useState(!1),[C,m]=r.useState(!1),[p,j]=r.useState(""),[g,d]=r.useState(""),u=async()=>{o(!0);try{const t=await fetch("/aa/payment-batches");if(t.ok){const s=await t.json();x(s)}else l.error("Failed to fetch batches")}catch{l.error("Error fetching batches")}finally{o(!1)}};r.useEffect(()=>{u()},[]);const S=N.filter(t=>(!h||t.name.toLowerCase().includes(h.toLowerCase()))&&(!c.length||c.includes(t.status))),w=async()=>{var t;if(!p.trim()){d("Batch name is required");return}o(!0),d("");try{const s=await fetch("/aa/payment-batches",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((t=document.querySelector('meta[name="csrf-token"]'))==null?void 0:t.content)||""},body:JSON.stringify({name:p})});if(s.ok)m(!1),j(""),u(),l.success("Batch created");else{const a=await s.json();d((a==null?void 0:a.error)||"Failed to create batch")}}catch{d("Error creating batch")}finally{o(!1)}},B=async(t,s)=>{var a;o(!0);try{(await fetch(`/aa/payment-batches/${t}/status`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((a=document.querySelector('meta[name="csrf-token"]'))==null?void 0:a.content)||""},body:JSON.stringify({status:s})})).ok?(x(D=>D.map(f=>f.id===t?{...f,status:s}:f)),l.success("Status updated")):l.error("Failed to update status")}catch{l.error("Error updating status")}finally{o(!1)}};return e.jsxs(k,{breadcrumbs:[{title:"Dashboard",href:"/dashboard"},{title:"Defense Batches",href:"/assistant/defense-batch"}],children:[e.jsx(T,{title:"Defense Batches"}),e.jsx(O,{richColors:!0,position:"bottom-right"}),e.jsxs("div",{className:"flex flex-col gap-4 pt-5 pr-3 pl-3",children:[e.jsxs(E,{className:"p-4 flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-10 w-10 flex items-center justify-center rounded-full bg-blue-500/10 border border-blue-500",children:e.jsx(q,{className:"h-5 w-5 text-blue-500"})}),e.jsxs("div",{children:[e.jsx("span",{className:"text-base font-semibold",children:"Defense Batches"}),e.jsx("span",{className:"block text-xs text-muted-foreground",children:"Grouped defense requests for finance processing."})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(i,{variant:"outline",size:"sm",onClick:u,disabled:n,children:[e.jsx(z,{className:"h-4 w-4 mr-1"})," Refresh"]}),e.jsxs(i,{variant:"default",size:"sm",onClick:()=>m(!0),children:[e.jsx(A,{className:"h-4 w-4 mr-1"})," New Batch"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(y,{type:"text",placeholder:"Search batch name...",value:h,onChange:t=>v(t.target.value),className:"max-w-xs text-sm h-8",disabled:n}),e.jsxs("div",{className:"flex gap-1",children:[X.map(t=>e.jsx(i,{variant:c.includes(t.value)?"default":"outline",size:"sm",className:"h-8 px-3",onClick:()=>b(s=>s.includes(t.value)?s.filter(a=>a!==t.value):[...s,t.value]),children:t.label},t.value)),c.length>0&&e.jsxs(i,{variant:"ghost",size:"sm",onClick:()=>b([]),children:[e.jsx(U,{className:"h-4 w-4"})," Reset"]})]})]})]}),e.jsx(I,{batches:S,onUpdateStatus:B,isLoading:n})]}),e.jsx(F,{open:C,onOpenChange:m,children:e.jsxs(R,{children:[e.jsx(L,{children:"Create New Batch"}),e.jsx(P,{children:"Enter a name for the new batch."}),e.jsx(y,{value:p,onChange:t=>j(t.target.value),placeholder:"Batch name",className:"mt-2",disabled:n}),g&&e.jsx("div",{className:"text-red-600 text-xs mt-1",children:g}),e.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[e.jsx(i,{variant:"ghost",onClick:()=>m(!1),children:"Cancel"}),e.jsx(i,{onClick:w,disabled:n,children:"Create"})]})]})})]})}export{Re as default};
