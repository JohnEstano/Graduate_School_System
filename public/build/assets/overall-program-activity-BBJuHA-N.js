import{r as n,j as e}from"./app-BDkuJsct.js";import{C as o,a as i,b as c,d,c as l,e as v}from"./card-BJFJPDio.js";import{C,a as b,b as N}from"./chart-7aubccfQ.js";import{B as w}from"./BarChart-AW9tJqMJ.js";import{Y as A,X as L}from"./YAxis-B7UrdJFR.js";import{B as P}from"./generateCategoricalChart-BOHwT1p9.js";import"./utils-jAU0Cazi.js";import"./index-CoS1vLG5.js";import"./index-Chjiymov.js";const k={defenses:{label:"Defenses",color:"#e11d48"}};function R(){const[m,f]=n.useState([]),[x,u]=n.useState(!0),[j,g]=n.useState(0);return n.useEffect(()=>{fetch("/defense-requests",{headers:{Accept:"application/json"}}).then(r=>{if(!r.ok)throw new Error("Failed to fetch");return r.json()}).then(r=>{const p=Array.isArray(r)?r:r.defenseRequests??[],a={};p.forEach(s=>{var h;const t=s.program||((h=s.user)==null?void 0:h.program)||"Unknown Program";a[t]=(a[t]||0)+1});const y=Object.entries(a).map(([s,t])=>({program:s.length>30?s.substring(0,30)+"...":s,defenses:t})).sort((s,t)=>t.defenses-s.defenses).slice(0,8);f(y),g(Object.keys(a).length)}).catch(r=>{console.error("Error fetching defense requests:",r),f([])}).finally(()=>{u(!1)})},[]),x?e.jsxs(o,{className:"rounded-xl shadow-none border",children:[e.jsxs(i,{children:[e.jsx(c,{children:"Program Activity Overview"}),e.jsx(d,{children:"Loading..."})]}),e.jsx(l,{className:"h-[300px] flex items-center justify-center",children:e.jsx("div",{className:"text-muted-foreground",children:"Loading chart data..."})})]}):m.length===0?e.jsxs(o,{className:"rounded-xl shadow-none border",children:[e.jsxs(i,{children:[e.jsx(c,{children:"Program Activity Overview"}),e.jsx(d,{children:"No data available"})]}),e.jsx(l,{className:"h-[300px] flex items-center justify-center",children:e.jsx("div",{className:"text-muted-foreground",children:"No defense requests found"})})]}):e.jsxs(o,{className:"rounded-xl shadow-none border",children:[e.jsxs(i,{children:[e.jsx(c,{children:"Program Activity Overview"}),e.jsx(d,{children:"Defense requests across all programs"})]}),e.jsx(l,{children:e.jsx(C,{config:k,children:e.jsxs(w,{accessibilityLayer:!0,data:m,layout:"vertical",margin:{left:0},children:[e.jsx(A,{dataKey:"program",type:"category",tickLine:!1,tickMargin:10,axisLine:!1,tickFormatter:r=>r}),e.jsx(L,{dataKey:"defenses",type:"number",hide:!0}),e.jsx(b,{cursor:!1,content:e.jsx(N,{hideLabel:!0})}),e.jsx(P,{dataKey:"defenses",fill:"var(--color-defenses)",radius:5})]})})}),e.jsx(v,{className:"flex-col items-start gap-2 text-sm",children:e.jsxs("div",{className:"flex gap-2 font-medium leading-none",children:[j," total programs active"]})})]})}export{R as OverallProgramActivity};
