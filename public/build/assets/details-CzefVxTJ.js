import{j as e,L as Z,S as ee,r as o}from"./app-BAKMM9W6.js";import{A as se,C as Ce}from"./app-layout-CHeZhPmm.js";import{T as Se,t as c}from"./index-C9JbnLWr.js";import{B as v}from"./button-CVeIta7K.js";import{I as D}from"./input-BRk-fvKd.js";import{B as Ae}from"./badge-D0sAGNiG.js";import{S as F}from"./separator-LRfcwlAa.js";import{C as Pe,e as Te,b as qe,c as De,d as Fe}from"./command-4azl6iTd.js";import{C as Re}from"./calendar-Cy0IhIYU.js";import{S as $e,a as Ee,b as Le,c as ze,e as te}from"./select-DtdDdDNe.js";import{P as ue,a as xe,b as he}from"./popover-PrBd-iYP.js";import{D as Ie,a as Me,b as Oe,c as Ue}from"./dialog-Fyk91gvx.js";import{c as Be}from"./utils-jAU0Cazi.js";import{A as Ve,a as He}from"./avatar-BvAeIlgK.js";import{T as ae,a as Je,b as re,c as ne}from"./tabs-DJFs2CDd.js";import{A as Ke}from"./arrow-left-BK7jsbo0.js";import{F as R}from"./file-text-Bhi2OKUW.js";import{C as L}from"./calendar-X1sSFtzx.js";import{C as We}from"./circle-check-big-wj1h3M4g.js";import{C as ie}from"./circle-x-CexCIQtI.js";import{C as le}from"./circle-arrow-left-Bj7i6wGx.js";import{U as de}from"./users-t5r6UxGv.js";import{L as oe}from"./loader-circle-Ci098EBy.js";import{c as Xe}from"./createLucideIcon-BSNBS9Xz.js";import{C as z}from"./clock-CxcCAnMI.js";import{S as ce}from"./signature-B_8p0Zf4.js";import{S as Ge}from"./send-CY1U2khq.js";import{U as Qe}from"./user-check-DLpV1gHv.js";import{U as Ye}from"./user-BYAYw-8u.js";import{C as Ze}from"./check-DCZqiU_u.js";import{f as $}from"./format-HX8DKPSU.js";import"./index-CEqJL0NP.js";import"./index-DZZQifJx.js";import"./index-Chzm2fti.js";import"./index-CUQ5MhIm.js";import"./index-DScCZkqp.js";import"./x-BVoq4DiS.js";import"./tooltip-B2Ch4P2D.js";import"./floating-ui.react-dom-CqLEll0E.js";import"./chevron-right-DZ7e7qvM.js";import"./dropdown-menu-D2EcCZ7C.js";import"./index-SVK1MPcU.js";import"./index-DUmeJSti.js";import"./index-BHprz6Pm.js";import"./index-C98k58Jz.js";import"./index-BqysFurs.js";import"./index-CEy3VqYv.js";import"./settings-CXr5fuO8.js";import"./graduation-cap-CyBvkmsT.js";import"./dollar-sign-BZcFe5e9.js";import"./badge-dollar-sign-Ciqfzy1N.js";import"./credit-card-DIRNAmsI.js";import"./info-D5wsL-jW.js";import"./sun-D0NfJtcj.js";import"./search-DuDncY0P.js";import"./en-US-BA9orzCf.js";import"./endOfWeek-QFyZPl43.js";import"./differenceInCalendarMonths-HUNRrXGm.js";import"./normalizeInterval-CdMCNNY-.js";import"./endOfMonth-CK_ShA5m.js";import"./isSameDay-DUlCFK42.js";import"./isSameMonth-CQd3m9St.js";import"./chevron-left-E1732S1e.js";import"./chevron-down-De7CcGjL.js";import"./index-tSynuKjl.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const es=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],me=Xe("Save",es);function ss({label:P,value:N,onChange:x,options:S,disabled:A,taken:t}){const[y,j]=o.useState(!1),[h,b]=o.useState(""),T=o.useMemo(()=>{if(!h)return S;const d=h.toLowerCase();return S.filter(p=>p.name.toLowerCase().includes(d)||p.email&&p.email.toLowerCase().includes(d))},[h,S]);return e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs font-medium",children:P}),e.jsxs(ue,{open:y,onOpenChange:d=>{j(d),d||b("")},children:[e.jsx(xe,{asChild:!0,children:e.jsxs("button",{type:"button",className:"w-full h-9 px-3 flex items-center justify-between rounded-md border bg-background text-sm text-left focus:outline-none focus:ring-2 focus:ring-primary/40 hover:bg-accent disabled:opacity-50",disabled:A,children:[e.jsx("span",{className:`truncate ${N?"":"text-muted-foreground"}`,children:N||`Select ${P}`}),e.jsx(Ce,{size:14,className:"opacity-50"})]})}),e.jsx(he,{className:"w-[320px] p-0",align:"start",sideOffset:4,onOpenAutoFocus:d=>d.preventDefault(),children:e.jsxs(Pe,{shouldFilter:!1,children:[e.jsx(Te,{value:h,onValueChange:b,placeholder:"Search...",className:"h-9",autoFocus:!0}),e.jsx(qe,{className:"py-8 text-sm text-muted-foreground text-center",children:"No matches."}),e.jsx(De,{className:"max-h-72 overflow-auto",children:T.map(d=>{const p=d.name===N,w=t.has(d.name)&&!p;return e.jsxs(Fe,{value:d.name,disabled:w,onSelect:()=>{w||(x(d.name),j(!1),b(""))},className:`flex flex-col items-start gap-0.5 px-3 py-2
                      ${p?"bg-muted":""}
                      ${w?"opacity-50 cursor-not-allowed":"cursor-pointer"}`,children:[e.jsxs("div",{className:"flex items-center w-full gap-2",children:[e.jsx(Ze,{size:14,className:p?"opacity-100 text-muted-foreground":"opacity-0"}),e.jsx("span",{className:"text-sm truncate",children:d.name})]}),d.email&&e.jsx("span",{className:"pl-5 text-[11px] text-muted-foreground truncate max-w-[250px]",children:d.email}),w&&!p&&e.jsx("span",{className:"pl-5 text-[10px] text-muted-foreground",children:"Already chosen"})]},d.id)})})]})})]})]})}function ht(P){var Y;const N=P||{},x=N.defenseRequest||null,S=N.userRole||"",A=[{title:"Dashboard",href:"/dashboard"},{title:"Defense Requests",href:"/defense-request"}];if(x!=null&&x.id){const s=(((Y=x.thesis_title)==null?void 0:Y.length)||0)>60?x.thesis_title.slice(0,57)+"...":x.thesis_title||`Request #${x.id}`;A.push({title:s,href:`/coordinator/defense-requests/${x.id}/details`})}if(!x)return e.jsxs(se,{breadcrumbs:A,children:[e.jsx(Z,{title:"Defense Request - Not Found"}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx("p",{className:"text-sm text-red-500",children:"No defense request loaded. Use the list page and click Details again."}),e.jsx(v,{variant:"outline",onClick:()=>ee.visit("/defense-request"),children:"Back to list"})]})]});const[t,y]=o.useState(x),[j,h]=o.useState({open:!1,action:null}),[b,T]=o.useState(!1),[d,p]=o.useState([]),[w,I]=o.useState(!1),[M,O]=o.useState(null);o.useEffect(()=>{let s=!0;async function a(){I(!0),O(null);const n=["/coordinator/defense/panel-members-all","/api/panel-members"];let r=!1;for(const i of n)try{const u=await fetch(i,{headers:{Accept:"application/json"}});if(!u.ok){console.warn("Panel member fetch failed",i,u.status);continue}const f=await u.json();s&&(p(Array.isArray(f)?f.filter(C=>C.type==="Panelist"):[]),r=!0);break}catch(u){console.warn("Fetch error",i,u)}!r&&s&&(p([]),O("Could not load panel members.")),s&&I(!1)}return a(),()=>{s=!1}},[]);const[m,pe]=o.useState({defense_chairperson:t.defense_chairperson??"",defense_panelist1:t.defense_panelist1??"",defense_panelist2:t.defense_panelist2??"",defense_panelist3:t.defense_panelist3??"",defense_panelist4:t.defense_panelist4??""}),[l,k]=o.useState({scheduled_date:t.scheduled_date??"",scheduled_time:t.scheduled_time??"",scheduled_end_time:t.scheduled_end_time??"",defense_mode:t.defense_mode??"",defense_venue:t.defense_venue??"",scheduling_notes:t.scheduling_notes??""}),[U,B]=o.useState(!1),[V,H]=o.useState(!1),fe=o.useMemo(()=>new Set(Object.values(m).filter(Boolean)),[m]),g=["Coordinator","Administrative Assistant","Dean"].includes(S);async function J(){var s;try{return await fetch("/sanctum/csrf-cookie",{credentials:"same-origin"}),((s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.content)||""}catch{return""}}async function E(s,a,n=!0){a.headers||(a.headers={}),a.headers["X-CSRF-TOKEN"]=await J();let r;try{r=await fetch(s,a)}catch{throw new Error("network")}if(r.status===419&&n){a.headers["X-CSRF-TOKEN"]=await J();try{r=await fetch(s,a)}catch{throw new Error("network")}}return r}async function je(){const s=c.loading("Saving panel assignments...");B(!0);try{const a=await E(`/coordinator/defense-requests/${t.id}/panels`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(m)}),n=a.headers.get("content-type")||"";let r={};try{n.includes("application/json")?r=await a.json():r={error:await a.text()}}catch{r={error:"Invalid response"}}a.ok&&r.ok?(y(i=>({...i,...r.request})),c.success("Panels saved",{id:s,description:[m.defense_chairperson,m.defense_panelist1,m.defense_panelist2,m.defense_panelist3,m.defense_panelist4].filter(Boolean).join(", ")})):c.error(r.error||`Failed (${a.status})`,{id:s})}catch{c.error("Network error saving panels",{id:s})}finally{B(!1)}}async function ge(){if(!l.scheduled_date||!l.scheduled_time||!l.scheduled_end_time||!l.defense_mode||!l.defense_venue){c.error("Please fill in all required scheduling fields.");return}if(l.scheduled_time&&l.scheduled_end_time){const[a,n]=l.scheduled_time.split(":").map(Number),[r,i]=l.scheduled_end_time.split(":").map(Number),u=a*60+n;if(r*60+i<=u){c.error("End time must be after start time.");return}}const s=c.loading("Saving schedule...");H(!0);try{const a=await E(`/coordinator/defense-requests/${t.id}/schedule-json`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(l)}),n=a.headers.get("content-type")||"";let r={};try{n.includes("application/json")?r=await a.json():r={error:await a.text()}}catch{r={error:"Invalid response"}}a.ok&&r.request?(y(i=>({...i,...r.request})),c.success("Schedule saved",{id:s,description:`${l.scheduled_date||""} ${l.scheduled_time||""}${l.scheduled_end_time?" - "+l.scheduled_end_time:""}`})):c.error(r.error||`Failed (${a.status})`,{id:s})}catch(a){a instanceof Error&&a.message==="network"?c.error("Network error saving schedule",{id:s}):c.error("Unknown error saving schedule",{id:s})}finally{H(!1)}}async function ve(s){if(!t.id)return;T(!0);let a="Pending";s==="approve"?a="Approved":s==="reject"?a="Rejected":s==="retrieve"&&(a="Pending");try{const n=await E(`/defense-requests/${t.id}/status`,{method:"PATCH",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({status:a})});let r={};try{r=await n.json()}catch{r={error:"Invalid response from server."}}n.ok?(r.request?y(r.request):y(i=>({...i,coordinator_status:a,workflow_state:r.workflow_state||i.workflow_state,workflow_history:r.workflow_history||i.workflow_history,status:r.status||i.status})),c.success(`Coordinator status set to ${a}`)):c.error((r==null?void 0:r.error)||`Failed to update status (${n.status})`)}catch(n){n instanceof Error&&n.message==="network"?c.error("Network error updating status. Please check your connection and try again."):c.error("Unknown error updating status.")}finally{T(!1),h({open:!1,action:null})}}function K(s){if(!s)return"—";try{return $(new Date(s),"PPP")}catch{return s}}function _(s){return s?/^https?:\/\//i.test(s)||s.startsWith("/storage/")?s:`/storage/${s.replace(/^\/?storage\//,"")}`:null}const W=[{label:"Adviser’s Endorsement",url:_(t.advisers_endorsement)},{label:"REC Endorsement",url:_(t.rec_endorsement)},{label:"Proof of Payment",url:_(t.proof_of_payment)},{label:"Manuscript",url:_(t.manuscript_proposal)},{label:"Similarity Index",url:_(t.similarity_index)},{label:"Avisee-Adviser File",url:_(t.avisee_adviser_attachment)},{label:"AI Detection Certificate",url:_(t.ai_detection_certificate)},{label:"Endorsement Form",url:_(t.endorsement_form)}];function be(s){var C;const a=s.event_type||s.action||s.status_change||s.status||s.type||"Event",n=s.description||s.details||s.note||s.notes||s.remarks||"",r=s.from_state||s.from||s.previous_state,i=s.to_state||s.to||s.new_state,u=s.created_at||s.timestamp||s.performed_at||s.date||"",f=s.user_name||((C=s.user)==null?void 0:C.name)||s.actor_name||s.actor||s.performed_by_name||s.performed_by||"";return{event:a,desc:n,from:r,to:i,created:u,userName:f}}const q="rounded-lg border p-5 space-y-3";function _e(s){var r,i,u,f;const a=((i=(r=s.first_name)==null?void 0:r.trim())==null?void 0:i[0])??"",n=((f=(u=s.last_name)==null?void 0:u.trim())==null?void 0:f[0])??"";return(a+n).toUpperCase()||"U"}function Ne(s){if(!s)return"";try{return $(new Date(s),"PPpp")}catch{return s}}const ye=[{key:"submitted",label:"Submitted",icon:e.jsx(Ge,{className:"h-5 w-5"})},{key:"adviser-approved",label:"Endorsed by Adviser",icon:e.jsx(Qe,{className:"h-5 w-5"})},{key:"coordinator-approved",label:"Approved by Coordinator",icon:e.jsx(ce,{className:"h-5 w-5"})},{key:"rejected",label:"Rejected by Coordinator",icon:e.jsx(ie,{className:"h-5 w-5"})},{key:"retrieved",label:"Retrieved (Set to Pending)",icon:e.jsx(le,{className:"h-5 w-5"})},{key:"panels-assigned",label:"Panels Assigned",icon:e.jsx(Ye,{className:"h-5 w-5"})},{key:"scheduled",label:"Scheduled",icon:e.jsx(z,{className:"h-5 w-5"})}];function we(s){return s=(s||"").toLowerCase(),s.includes("submit")?"submitted":s.includes("adviser")?"adviser-approved":s.includes("rejected")?"rejected":s.includes("retrieved")?"retrieved":s.includes("coordinator")?"coordinator-approved":s.includes("panel")?"panels-assigned":s.includes("schedule")?"scheduled":""}function X(s){if(!s)return"";const[a,n]=s.split(":"),r=new Date;return r.setHours(Number(a),Number(n)),$(r,"hh:mm a")}const[G,Q]=o.useState("details");return e.jsxs(se,{breadcrumbs:A,children:[e.jsx(Se,{position:"bottom-right",richColors:!0,closeButton:!0}),e.jsxs("div",{className:"p-5 space-y-6",children:[e.jsx(Z,{title:t.thesis_title||`Defense Request #${t.id}`}),e.jsxs("div",{className:"flex items-center justify-between gap-3 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v,{variant:"outline",onClick:()=>ee.visit("/defense-request"),className:"h-8 px-2",children:e.jsx(Ke,{className:"h-4 w-4"})}),e.jsx(ae,{value:G,onValueChange:s=>Q(s),children:e.jsxs(Je,{className:"h-8",children:[e.jsxs(re,{value:"details",className:"flex items-center gap-1 text-sm px-3",children:[e.jsx(R,{className:"h-4 w-4"})," Details"]}),e.jsxs(re,{value:"assign-schedule",className:"flex items-center gap-1 text-sm font-medium px-3",children:[e.jsx(L,{className:"h-4 w-4"}),"Assign & Schedule"]})]})})]}),g&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(v,{size:"sm",variant:"outline",onClick:()=>h({open:!0,action:"approve"}),disabled:b||t.coordinator_status==="Approved"||t.workflow_state==="completed",children:[e.jsx(We,{className:"h-4 w-4 mr-1 text-green-600"}),"Approve"]}),e.jsxs(v,{size:"sm",variant:"outline",onClick:()=>h({open:!0,action:"reject"}),disabled:b||t.coordinator_status==="Rejected"||t.coordinator_status==="Approved"||t.workflow_state==="completed",children:[e.jsx(ie,{className:"h-4 w-4 mr-1 text-red-600"}),"Reject"]}),e.jsxs(v,{size:"sm",variant:"outline",onClick:()=>h({open:!0,action:"retrieve"}),disabled:b||!["Rejected","Approved"].includes(t.coordinator_status||"")||t.workflow_state==="completed",children:[e.jsx(le,{className:"h-4 w-4 mr-1 text-blue-600"}),"Retrieve"]})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-5 mb-2",children:[e.jsx("div",{className:"w-full md:max-w-3xl mx-auto flex flex-col gap-5",children:e.jsxs(ae,{value:G,onValueChange:s=>Q(s),className:"w-full",children:[e.jsxs(ne,{value:"details",className:"space-y-5",children:[e.jsxs("div",{className:"rounded-xl border p-8 bg-white dark:bg-zinc-900",children:[e.jsxs("div",{className:"mb-1 flex flex-col md:flex-row md:items-center md:justify-between gap-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-semibold",children:t.thesis_title}),e.jsx("div",{className:"text-xs text-muted-foreground font-medium mt-0.5",children:"Thesis Title"})]}),e.jsx("div",{className:"flex flex-col md:items-end gap-1",children:t.coordinator_status&&e.jsxs("span",{className:`text-xs font-semibold px-2 py-0.5 rounded-full ${t.coordinator_status==="Approved"?"bg-green-100 text-green-600":t.coordinator_status==="Rejected"?"bg-red-100 text-red-600":t.coordinator_status==="Needs Signature"?"bg-blue-100 text-blue-600":t.coordinator_status==="Not Scheduled"?"bg-yellow-100 text-yellow-700":t.coordinator_status==="No Assigned Panelists"?"bg-orange-100 text-orange-600":"bg-gray-100 text-gray-600"}`,children:["Coordinator Status: ",t.coordinator_status]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-12 gap-y-6 mt-6",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"Presenter"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ve,{className:"h-8 w-8",children:e.jsx(He,{className:"text-base font-bold bg-zinc-200 dark:bg-zinc-800 text-zinc-700 dark:text-zinc-200",children:_e(t)})}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium text-sm leading-tight",children:[t.first_name," ",t.middle_name?`${t.middle_name} `:"",t.last_name]}),e.jsx("div",{className:"text-xs text-muted-foreground mt-0.5",children:t.school_id})]})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"Program"}),e.jsx("div",{className:"font-medium text-sm",children:t.program})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"Defense Type"}),e.jsx(Ae,{variant:"secondary",className:"text-xs font-medium",children:t.defense_type??"—"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"Scheduled Date"}),e.jsx("div",{className:"font-medium text-sm",children:K(t.scheduled_date)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"Time"}),e.jsx("div",{className:"font-medium text-sm",children:t.scheduled_time?`${X(t.scheduled_time)}${t.scheduled_end_time?" - "+X(t.scheduled_end_time):""}`:"—"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"Venue"}),e.jsx("div",{className:"font-medium text-sm",children:t.defense_venue||"—"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"Mode"}),e.jsx("div",{className:"font-medium text-sm",children:t.defense_mode?t.defense_mode==="face-to-face"?"Face-to-Face":"Online":"—"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"Notes"}),e.jsx("div",{className:"font-medium text-sm",children:t.scheduling_notes||"—"})]})]})]}),e.jsxs("div",{className:q,children:[e.jsxs("h2",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(de,{className:"h-4 w-4"})," Committee"]}),e.jsx(F,{}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-[11px] text-muted-foreground uppercase tracking-wide",children:"Adviser"}),e.jsx("div",{className:"font-medium",children:t.defense_adviser||"—"})]}),[{label:"Chairperson",v:m.defense_chairperson||t.defense_chairperson},{label:"Panelist 1",v:m.defense_panelist1||t.defense_panelist1},{label:"Panelist 2",v:m.defense_panelist2||t.defense_panelist2},{label:"Panelist 3",v:m.defense_panelist3||t.defense_panelist3},{label:"Panelist 4",v:m.defense_panelist4||t.defense_panelist4}].map(s=>e.jsxs("div",{children:[e.jsx("div",{className:"text-[11px] text-muted-foreground uppercase tracking-wide",children:s.label}),e.jsx("div",{className:"font-medium",children:s.v||"—"})]},s.label))]})]}),e.jsxs("div",{className:q,children:[e.jsxs("h2",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(R,{className:"h-4 w-4"})," Attachments"]}),e.jsx(F,{}),e.jsxs("div",{className:"space-y-2 text-sm",children:[W.filter(s=>!!s.url).length===0&&e.jsx("p",{className:"text-sm text-muted-foreground",children:"No attachments."}),W.filter(s=>!!s.url).map(s=>{var a;return e.jsxs("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 px-3 py-2 rounded-md border bg-white dark:bg-zinc-900 hover:bg-muted transition",children:[e.jsx(R,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:s.label}),e.jsx("span",{className:"text-xs text-muted-foreground ml-auto truncate max-w-[180px]",children:(a=s.url)==null?void 0:a.split("/").pop()})]},s.label)}),t.reference_no&&e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 rounded-md border bg-white dark:bg-zinc-900",children:[e.jsx(R,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"Reference No."}),e.jsx("span",{className:"ml-auto text-xs",children:t.reference_no})]})]})]})]}),e.jsxs(ne,{value:"assign-schedule",className:"space-y-5",children:[e.jsxs("div",{className:q,children:[e.jsxs("h2",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(de,{className:"h-4 w-4"})," Panel Assignment"]}),e.jsx(F,{}),e.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:[{label:"Chairperson",key:"defense_chairperson"},{label:"Panelist 1",key:"defense_panelist1"},{label:"Panelist 2",key:"defense_panelist2"},{label:"Panelist 3",key:"defense_panelist3"},{label:"Panelist 4",key:"defense_panelist4"}].map(({label:s,key:a})=>e.jsx(ss,{label:s,value:m[a],onChange:n=>pe(r=>({...r,[a]:n})),options:d,disabled:!g||w,taken:fe},a))}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsxs(v,{onClick:je,disabled:!g||U,className:"gap-2 dark:bg-rose-500 text-white hover:cursor-pointer",children:[U&&e.jsx(oe,{className:"animate-spin h-4 w-4"}),e.jsx(me,{className:"h-4 w-4"}),"Save Panel Assignment"]})}),M&&e.jsx("div",{className:"text-xs text-red-500 mt-2",children:M})]}),e.jsxs("div",{className:q,children:[e.jsxs("h2",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(L,{className:"h-4 w-4"})," Scheduling"]}),e.jsx(F,{}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"Date"}),e.jsxs(ue,{children:[e.jsx(xe,{asChild:!0,children:e.jsxs(v,{variant:"outline",className:Be("w-full justify-start text-left font-normal",!l.scheduled_date&&"text-muted-foreground"),disabled:!g,children:[e.jsx(L,{className:"mr-2 h-4 w-4"}),l.scheduled_date?K(l.scheduled_date):"Pick a date"]})}),e.jsx(he,{className:"w-auto p-0",align:"start",children:e.jsx(Re,{mode:"single",selected:l.scheduled_date?new Date(l.scheduled_date):void 0,onSelect:s=>{k(a=>({...a,scheduled_date:s?$(s,"yyyy-MM-dd"):""}))},initialFocus:!0})})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"Start Time"}),e.jsx(D,{type:"time",value:l.scheduled_time,onChange:s=>k(a=>({...a,scheduled_time:s.target.value})),disabled:!g})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"End Time"}),e.jsx(D,{type:"time",value:l.scheduled_end_time,onChange:s=>k(a=>({...a,scheduled_end_time:s.target.value})),disabled:!g})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"Mode"}),e.jsxs($e,{value:l.defense_mode,onValueChange:s=>k(a=>({...a,defense_mode:s})),disabled:!g,children:[e.jsx(Ee,{children:e.jsx(Le,{placeholder:"Select mode"})}),e.jsxs(ze,{children:[e.jsx(te,{value:"face-to-face",children:"Face-to-Face"}),e.jsx(te,{value:"online",children:"Online"})]})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"Venue"}),e.jsx(D,{value:l.defense_venue,onChange:s=>k(a=>({...a,defense_venue:s.target.value})),disabled:!g})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"Notes"}),e.jsx(D,{value:l.scheduling_notes,onChange:s=>k(a=>({...a,scheduling_notes:s.target.value})),disabled:!g})]})]}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsxs(v,{onClick:ge,disabled:!g||V,className:"gap-2 dark:bg-rose-500 dark:text-white hover:cursor-pointer",children:[V&&e.jsx(oe,{className:"animate-spin h-4 w-4"}),e.jsx(me,{className:"h-4 w-4"}),"Save Schedule"]})})]})]})]})}),e.jsx("div",{className:"w-full md:w-[340px] flex-shrink-0",children:e.jsxs("div",{className:"rounded-xl border p-5 bg-white dark:bg-zinc-900 sticky top-24 h-fit",children:[e.jsxs("h2",{className:"text-xs font-semibold mb-8 flex items-center gap-2",children:[e.jsx(z,{className:"h-4 w-4"})," Workflow Progress"]}),e.jsx("div",{className:"flex flex-col gap-0 relative",children:Array.isArray(t.workflow_history)&&t.workflow_history.length>0?t.workflow_history.map((s,a)=>{const{event:n,created:r,userName:i}=be(s),u=we(n),f=ye.find(ke=>ke.key===u)||{label:n.charAt(0).toUpperCase()+n.slice(1),icon:e.jsx(z,{className:"h-5 w-5 text-gray-500"})},C=Array.isArray(t.workflow_history)&&a===t.workflow_history.length-1;return e.jsxs("div",{className:"flex items-start gap-3 relative",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"w-9 h-9 rounded-md flex items-center justify-center bg-gray-100 text-gray-500",children:f.icon}),!C&&e.jsx("div",{className:"h-8 border-l-2 border-dotted border-gray-300 dark:border-zinc-700 mx-auto"})]}),e.jsxs("div",{className:"pb-4",children:[e.jsx("div",{className:"font-semibold text-xs",children:f.label}),e.jsxs("div",{className:"text-[11px] text-muted-foreground",children:[i&&e.jsx("span",{children:i}),r&&e.jsxs("span",{children:[" ","· ",Ne(r)]})]})]})]},a)}):e.jsx("div",{className:"text-xs text-muted-foreground",children:"No workflow history yet."})})]})})]}),e.jsxs("div",{className:"text-[11px] text-muted-foreground",children:["Last updated by:"," ",t.last_status_updated_by_name||t.last_status_updated_by||"—"," ",t.last_status_updated_at?`(${t.last_status_updated_at})`:""]})]}),e.jsx(Ie,{open:j.open,onOpenChange:s=>{s||h({open:!1,action:null})},children:e.jsxs(Me,{children:[e.jsx(Oe,{children:"Confirm Action"}),e.jsx(Ue,{children:j.action==="approve"?"Please review before approving.":"Apply this status change?"}),e.jsxs("div",{className:"mt-3 text-sm space-y-3",children:[e.jsxs("p",{children:["Set request to"," ",e.jsx("span",{className:"font-semibold",children:j.action==="approve"?"Approved":j.action==="reject"?"Rejected":"Pending"}),"?"]}),j.action==="approve"&&e.jsxs("div",{className:"flex flex-col items-center gap-3 rounded-md border bg-muted/40 p-5",children:[e.jsx("div",{className:"rounded-full bg-primary/10 p-4",children:e.jsx(ce,{className:"h-14 w-14 text-primary"})}),e.jsx("p",{className:"text-center text-sm leading-relaxed",children:"Approving this defense request authorizes the use of your signature on the official defense documents."})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[e.jsx(v,{variant:"ghost",onClick:()=>h({open:!1,action:null}),children:"Cancel"}),e.jsx(v,{onClick:()=>j.action&&ve(j.action),disabled:b,children:"Confirm"})]})]})})]})}export{ht as default};
