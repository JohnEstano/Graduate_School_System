import{r,a as z,j as e}from"./app-BDkuJsct.js";import{T as I,a as A,b as h,c as n,d as U,e as i}from"./table-CnA6sFiR.js";import{B as d}from"./button-DggClj9M.js";import{I as se}from"./input-BmPXXlp0.js";import{D as B,a as H,d as M,b as Q,c as W,e as Y}from"./dialog-DeUj0iLU.js";import{S as v}from"./skeleton-C1N4Z9e5.js";import{A as ae,a as te}from"./avatar-DpsgA3Kf.js";import{T as re,a as ne,b as $,c as q}from"./tabs-BOuSS6lC.js";import{T as le,t as o}from"./index-By5vkq0G.js";import{U as ie}from"./users-BTr8E8QO.js";import{M as y}from"./mail-C2Dt0zh5.js";import{L as V}from"./loader-circle-xEC7kKhV.js";import{C as ce}from"./check-BUlQxyEc.js";import{T as de}from"./trash-Jwbbrt74.js";import"./utils-jAU0Cazi.js";import"./index-B_a1aFVM.js";import"./index-DZZQifJx.js";import"./index-CWqpdCTP.js";import"./index-BhbofC_p.js";import"./index-D-bfryUZ.js";import"./x-CtfT_1vN.js";import"./createLucideIcon-CEmaZ7tj.js";import"./index-BdhkuEJx.js";import"./index-LRezjsDo.js";function oe(m){var f,p,x,g;const S=((p=(f=m.first_name)==null?void 0:f.trim())==null?void 0:p[0])??"",j=((g=(x=m.last_name)==null?void 0:x.trim())==null?void 0:g[0])??"";return(S+j).toUpperCase()||"U"}function Ue(){const[m,S]=r.useState([]),[j,f]=r.useState([]),[p,x]=r.useState(!1),[g,T]=r.useState(!0),[_,G]=r.useState(""),[me,xe]=r.useState(!1),[ue,he]=r.useState(null),[J,b]=r.useState(!1),[K,N]=r.useState(!1),[a,k]=r.useState(null),[c,w]=r.useState(!1);r.useEffect(()=>{P(),C()},[]);const P=async()=>{T(!0);try{const s=await z.get("/api/adviser/students");S(s.data||[])}catch(s){console.error("Failed to load students",s)}finally{T(!1)}},C=async()=>{x(!0);try{const s=await z.get("/api/adviser/pending-students");f(s.data||[])}catch(s){console.error("Failed to load pending",s)}finally{x(!1)}},X=async s=>{k(s),b(!0)},E=async s=>{if(a){w(!0);try{await z.post(`/api/adviser/pending-students/${a.id}/accept`,{send_email:s}),await P(),await C(),b(!1),k(null),s?o.success("Student accepted and email sent!"):o.success("Student accepted (no email sent)")}catch(l){console.error(l),o.error("Failed to accept student"),b(!1)}finally{w(!1)}}},Z=async s=>{k(s),N(!0)},L=async s=>{if(a){w(!0);try{await z.post(`/api/adviser/pending-students/${a.id}/reject`,{send_email:s}),await C(),N(!1),k(null),s?o.success("Student rejected and email sent"):o.success("Student rejected (no email sent)")}catch(l){console.error(l),o.error("Failed to reject student"),N(!1)}finally{w(!1)}}},u=_.toLowerCase(),ee=m.filter(s=>{var l,t,D,R,O;return(((l=s.student_number)==null?void 0:l.toLowerCase().includes(u))??!1)||(((t=s.first_name)==null?void 0:t.toLowerCase().includes(u))??!1)||(((D=s.last_name)==null?void 0:D.toLowerCase().includes(u))??!1)||(((R=s.email)==null?void 0:R.toLowerCase().includes(u))??!1)||(((O=s.program)==null?void 0:O.toLowerCase().includes(u))??!1)});if(g)return e.jsxs("div",{className:"w-full min-h-[70vh] bg-background flex flex-col gap-4 p-0 m-0",children:[e.jsx(v,{className:"h-6 w-1/6 rounded bg-muted dark:bg-muted mt-8 mx-8"}),e.jsx(v,{className:"h-12 w-3/4 rounded bg-muted dark:bg-muted mx-8"}),e.jsx(v,{className:"h-12 w-2/3 rounded bg-muted dark:bg-muted mx-8"}),e.jsx(v,{className:"h-[400px] w-full rounded bg-muted dark:bg-muted mt-4"})]});function F(s,l=!1){return s.length===0?e.jsx(h,{children:e.jsx(i,{colSpan:l?6:5,className:"py-8 text-center text-sm text-muted-foreground dark:text-zinc-400",children:"No students found."})}):s.map(t=>e.jsxs(h,{className:"dark:hover:bg-zinc-700",children:[e.jsxs(i,{className:"flex items-center gap-3 dark:text-zinc-200",children:[e.jsx(ae,{className:"h-8 w-8",children:e.jsx(te,{children:oe(t)})}),e.jsxs("span",{children:[t.first_name||""," ",t.middle_name?t.middle_name[0]+".":""," ",t.last_name||""]})]}),e.jsx(i,{className:"dark:text-zinc-200",children:t.student_number||"N/A"}),e.jsx(i,{className:"dark:text-zinc-200",children:t.email||"N/A"}),e.jsx(i,{className:"dark:text-zinc-200",children:t.program||"N/A"}),e.jsx(i,{className:"dark:text-zinc-200",children:t.coordinator_name||"N/A"}),l&&e.jsxs(i,{className:"flex gap-2 justify-center",children:[e.jsx(d,{variant:"outline",size:"icon",title:"Accept",onClick:()=>X(t),className:"text-green-600 border-green-300 hover:bg-green-50 hover:text-green-700",children:e.jsx(ce,{className:"w-4 h-4"})}),e.jsx(d,{variant:"outline",size:"icon",title:"Reject",onClick:()=>Z(t),className:"text-rose-600 border-rose-300 hover:bg-rose-50 hover:text-rose-700",children:e.jsx(de,{className:"w-4 h-4"})})]})]},t.id))}return e.jsxs("div",{className:`flex h-full flex-1 flex-col gap-4 overflow-auto rounded-xl pt-5 pr-7 pl-7 relative
      bg-background dark:bg-zinc-900 transition-colors`,children:[e.jsxs("div",{className:"w-full border border-border rounded-lg overflow-hidden mb-1 bg-white dark:bg-zinc-900 dark:border-zinc-700",children:[e.jsxs("div",{className:"flex flex-row items-center justify-between w-full p-3 border-b bg-white dark:bg-zinc-900 dark:border-zinc-700",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-10 w-10 flex items-center justify-center rounded-full bg-rose-500/10 border border-rose-500",children:e.jsx(ie,{className:"h-5 w-5 text-rose-400"})}),e.jsxs("div",{children:[e.jsx("span",{className:"text-base font-semibold text-zinc-900 dark:text-zinc-100",children:"My Students"}),e.jsx("span",{className:"block text-xs text-muted-foreground dark:text-zinc-400",children:"This section shows all students assigned to you."})]})]}),e.jsx("div",{})]}),e.jsx("div",{className:"flex flex-row items-center justify-between w-full p-3 border-t bg-white dark:bg-zinc-900 dark:border-zinc-700",children:e.jsx(se,{type:"text",placeholder:"Search...",value:_,onChange:s=>G(s.target.value),className:"max-w-xs text-sm py-1 h-8 bg-background dark:bg-background"})})]}),e.jsxs(re,{defaultValue:"assigned",className:"w-full",children:[e.jsxs(ne,{className:"mb-3",children:[e.jsxs($,{value:"assigned",className:"flex items-center gap-2",children:["Assigned",e.jsx("span",{className:"inline-flex items-center justify-center px-2 py-0.5 text-xs text-zinc-700 dark:text-zinc-100",children:m.length})]}),e.jsxs($,{value:"pending",className:"flex items-center gap-2",children:["Pending",e.jsx("span",{className:"inline-flex items-center justify-center px-2 py-0.5 text-xs text-zinc-700 dark:text-zinc-100",children:j.length})]})]}),e.jsx(q,{value:"pending",children:e.jsx("div",{className:"rounded-md overflow-x-auto w-full max-w-full border border-border bg-white dark:bg-zinc-900 dark:border-zinc-700",children:e.jsxs(I,{children:[e.jsx(A,{children:e.jsxs(h,{children:[e.jsx(n,{className:"dark:text-zinc-100",children:"Name"}),e.jsx(n,{className:"dark:text-zinc-100",children:"Student #"}),e.jsx(n,{className:"dark:text-zinc-100",children:"Email"}),e.jsx(n,{className:"dark:text-zinc-100",children:"Program"}),e.jsx(n,{className:"dark:text-zinc-100",children:"Program Coordinator"}),e.jsx(n,{className:"dark:text-zinc-100 text-center",children:"Actions"})]})}),e.jsx(U,{children:p?e.jsx(h,{children:e.jsx(i,{colSpan:6,className:"py-8 text-center text-sm text-muted-foreground dark:text-zinc-400",children:"Loading pending..."})}):F(j,!0)})]})})}),e.jsx(q,{value:"assigned",children:e.jsx("div",{className:"rounded-md overflow-x-auto w-full max-w-full border border-border bg-white dark:bg-zinc-900 dark:border-zinc-700",children:e.jsxs(I,{children:[e.jsx(A,{children:e.jsxs(h,{children:[e.jsx(n,{className:"dark:text-zinc-100",children:"Name"}),e.jsx(n,{className:"dark:text-zinc-100",children:"School ID"}),e.jsx(n,{className:"dark:text-zinc-100",children:"Email"}),e.jsx(n,{className:"dark:text-zinc-100",children:"Program"}),e.jsx(n,{className:"dark:text-zinc-100",children:"Program Coordinator"})]})}),e.jsx(U,{children:F(ee,!1)})]})})})]}),e.jsx(B,{open:J,onOpenChange:b,children:e.jsxs(H,{className:"sm:max-w-md",children:[e.jsxs(M,{children:[e.jsxs(Q,{className:"flex items-center gap-2",children:[e.jsx(y,{className:"h-5 w-5 text-green-500"}),"Send Acceptance Email?"]}),e.jsxs(W,{className:"pt-2 space-y-2",children:[e.jsx("p",{children:"You are accepting:"}),e.jsxs("div",{className:"bg-zinc-100 dark:bg-zinc-800 p-3 rounded-md space-y-1",children:[e.jsxs("p",{className:"font-semibold text-zinc-900 dark:text-zinc-100",children:[a==null?void 0:a.first_name," ",a==null?void 0:a.last_name]}),e.jsx("p",{className:"text-sm text-zinc-600 dark:text-zinc-400",children:a==null?void 0:a.email})]}),e.jsx("p",{className:"text-sm text-zinc-600 dark:text-zinc-400",children:"Would you like to send an acceptance email notification to the student?"})]})]}),e.jsxs(Y,{className:"gap-2 sm:gap-0",children:[e.jsx(d,{variant:"outline",onClick:()=>E(!1),disabled:c,children:"Skip Email"}),e.jsx(d,{onClick:()=>E(!0),disabled:c,className:"bg-green-600 hover:bg-green-700",children:c?e.jsxs(e.Fragment,{children:[e.jsx(V,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(y,{className:"mr-2 h-4 w-4"}),"Send Email"]})})]})]})}),e.jsx(B,{open:K,onOpenChange:N,children:e.jsxs(H,{className:"sm:max-w-md",children:[e.jsxs(M,{children:[e.jsxs(Q,{className:"flex items-center gap-2",children:[e.jsx(y,{className:"h-5 w-5 text-red-500"}),"Send Rejection Email?"]}),e.jsxs(W,{className:"pt-2 space-y-2",children:[e.jsx("p",{children:"You are rejecting:"}),e.jsxs("div",{className:"bg-zinc-100 dark:bg-zinc-800 p-3 rounded-md space-y-1",children:[e.jsxs("p",{className:"font-semibold text-zinc-900 dark:text-zinc-100",children:[a==null?void 0:a.first_name," ",a==null?void 0:a.last_name]}),e.jsx("p",{className:"text-sm text-zinc-600 dark:text-zinc-400",children:a==null?void 0:a.email})]}),e.jsx("p",{className:"text-sm text-zinc-600 dark:text-zinc-400",children:"Would you like to send a rejection email notification to the student?"})]})]}),e.jsxs(Y,{className:"gap-2 sm:gap-0",children:[e.jsx(d,{variant:"outline",onClick:()=>L(!1),disabled:c,children:"Skip Email"}),e.jsx(d,{onClick:()=>L(!0),disabled:c,className:"bg-red-600 hover:bg-red-700",children:c?e.jsxs(e.Fragment,{children:[e.jsx(V,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(y,{className:"mr-2 h-4 w-4"}),"Send Email"]})})]})]})}),e.jsx(le,{richColors:!0,position:"bottom-right"})]})}export{Ue as default};
