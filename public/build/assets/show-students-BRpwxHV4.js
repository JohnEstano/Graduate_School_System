import{r,a as N,j as e}from"./app-BubHmeqC.js";import{T as F,a as O,b as u,c as n,d as U,e as i}from"./table-CLIx8tAs.js";import{B as d}from"./button-CX84Ig4W.js";import{I as ee}from"./input-y4wBi6jo.js";import{D as I,a as H,e as M,b as B,c as q,f as Q}from"./dialog-ywfV6j7b.js";import{S as k}from"./skeleton-BRL72RKb.js";import{A as se,a as te}from"./avatar-DijVPJCE.js";import{T as ae,a as re,b as W,c as X}from"./tabs-DVolEiAR.js";import{U as ne}from"./users-wdb3-6X2.js";import{U as le}from"./user-check-DLoTdIld.js";import{L as Y}from"./loader-circle-bCBBg-Y7.js";import{M as $}from"./mail-CBNlKsrm.js";import{c as ie}from"./createLucideIcon-Biu-y2hB.js";import{C as ce}from"./check-CZ9c_sEg.js";import{T as de}from"./trash-151b-tZd.js";import"./utils-jAU0Cazi.js";import"./index-CAAZlwhj.js";import"./index-DZZQifJx.js";import"./index-Bsel9b7o.js";import"./index-PQN_369Y.js";import"./index-DyQT7xcZ.js";import"./x-DS6n0ElR.js";import"./index-CVQNv_Nf.js";import"./index-1EFpZ92o.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]],me=ie("UserX",oe);function xe(o){var f,j,m,p;const z=((j=(f=o.first_name)==null?void 0:f.trim())==null?void 0:j[0])??"",h=((p=(m=o.last_name)==null?void 0:m.trim())==null?void 0:p[0])??"";return(z+h).toUpperCase()||"U"}function Be(){const[o,z]=r.useState([]),[h,f]=r.useState([]),[j,m]=r.useState(!1),[p,S]=r.useState(!0),[C,V]=r.useState(""),[ue,he]=r.useState(!1),[fe,je]=r.useState(null),[G,w]=r.useState(!1),[J,y]=r.useState(!1),[s,g]=r.useState(null),[c,b]=r.useState(!1);r.useEffect(()=>{_(),v()},[]);const _=async()=>{S(!0);try{const t=await N.get("/api/adviser/students");z(t.data||[])}catch(t){console.error("Failed to load students",t)}finally{S(!1)}},v=async()=>{m(!0);try{const t=await N.get("/api/adviser/pending-students");f(t.data||[])}catch(t){console.error("Failed to load pending",t)}finally{m(!1)}},K=t=>{g({student:t,action:"accept"}),w(!0)},Z=t=>{g({student:t,action:"reject"}),y(!0)},T=async t=>{if(!(!s||s.action!=="accept")){b(!0);try{await N.post(`/api/adviser/pending-students/${s.student.id}/accept`,{send_email:t}),await _(),await v()}catch(l){console.error(l)}finally{b(!1),w(!1),g(null)}}},L=async t=>{if(!(!s||s.action!=="reject")){b(!0);try{await N.post(`/api/adviser/pending-students/${s.student.id}/reject`,{send_email:t}),await v()}catch(l){console.error(l)}finally{b(!1),y(!1),g(null)}}},x=C.toLowerCase(),A=o.filter(t=>{var l,a,D,P,R;return(((l=t.student_number)==null?void 0:l.toLowerCase().includes(x))??!1)||(((a=t.first_name)==null?void 0:a.toLowerCase().includes(x))??!1)||(((D=t.last_name)==null?void 0:D.toLowerCase().includes(x))??!1)||(((P=t.email)==null?void 0:P.toLowerCase().includes(x))??!1)||(((R=t.program)==null?void 0:R.toLowerCase().includes(x))??!1)});if(p)return e.jsxs("div",{className:"w-full min-h-[70vh] bg-background flex flex-col gap-4 p-0 m-0",children:[e.jsx(k,{className:"h-6 w-1/6 rounded bg-muted dark:bg-muted mt-8 mx-8"}),e.jsx(k,{className:"h-12 w-3/4 rounded bg-muted dark:bg-muted mx-8"}),e.jsx(k,{className:"h-12 w-2/3 rounded bg-muted dark:bg-muted mx-8"}),e.jsx(k,{className:"h-[400px] w-full rounded bg-muted dark:bg-muted mt-4"})]});function E(t,l=!1){return t.length===0?e.jsx(u,{children:e.jsx(i,{colSpan:l?6:5,className:"py-8 text-center text-sm text-muted-foreground dark:text-zinc-400",children:"No students found."})}):t.map(a=>e.jsxs(u,{className:"dark:hover:bg-zinc-700",children:[e.jsxs(i,{className:"flex items-center gap-3 dark:text-zinc-200",children:[e.jsx(se,{className:"h-8 w-8",children:e.jsx(te,{children:xe(a)})}),e.jsxs("span",{children:[a.first_name||""," ",a.middle_name?a.middle_name[0]+".":""," ",a.last_name||""]})]}),e.jsx(i,{className:"dark:text-zinc-200",children:a.student_number||"N/A"}),e.jsx(i,{className:"dark:text-zinc-200",children:a.email||"N/A"}),e.jsx(i,{className:"dark:text-zinc-200",children:a.program||"N/A"}),e.jsx(i,{className:"dark:text-zinc-200",children:a.coordinator_name||"N/A"}),l&&e.jsxs(i,{className:"flex gap-2 justify-center",children:[e.jsx(d,{variant:"outline",size:"icon",title:"Accept",onClick:()=>K(a),className:"text-green-600 border-green-300 hover:bg-green-50 hover:text-green-700",children:e.jsx(ce,{className:"w-4 h-4"})}),e.jsx(d,{variant:"outline",size:"icon",title:"Reject",onClick:()=>Z(a),className:"text-rose-600 border-rose-300 hover:bg-rose-50 hover:text-rose-700",children:e.jsx(de,{className:"w-4 h-4"})})]})]},a.id))}return e.jsxs("div",{className:`flex h-full flex-1 flex-col gap-4 overflow-auto rounded-xl pt-5 pr-7 pl-7 relative
      bg-background dark:bg-zinc-900 transition-colors`,children:[e.jsxs("div",{className:"w-full border border-border rounded-lg overflow-hidden mb-1 bg-white dark:bg-zinc-900 dark:border-zinc-700",children:[e.jsxs("div",{className:"flex flex-row items-center justify-between w-full p-3 border-b bg-white dark:bg-zinc-900 dark:border-zinc-700",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-10 w-10 flex items-center justify-center rounded-full bg-rose-500/10 border border-rose-500",children:e.jsx(ne,{className:"h-5 w-5 text-rose-400"})}),e.jsxs("div",{children:[e.jsx("span",{className:"text-base font-semibold text-zinc-900 dark:text-zinc-100",children:"My Students"}),e.jsx("span",{className:"block text-xs text-muted-foreground dark:text-zinc-400",children:"This section shows all students assigned to you."})]})]}),e.jsx("div",{})]}),e.jsx("div",{className:"flex flex-row items-center justify-between w-full p-3 border-t bg-white dark:bg-zinc-900 dark:border-zinc-700",children:e.jsx(ee,{type:"text",placeholder:"Search...",value:C,onChange:t=>V(t.target.value),className:"max-w-xs text-sm py-1 h-8 bg-background dark:bg-background"})})]}),e.jsxs(ae,{defaultValue:"assigned",className:"w-full",children:[e.jsxs(re,{className:"mb-3",children:[e.jsxs(W,{value:"assigned",className:"flex items-center gap-2",children:["Assigned",e.jsx("span",{className:"inline-flex items-center justify-center px-2 py-0.5 text-xs text-zinc-700 dark:text-zinc-100",children:o.length})]}),e.jsxs(W,{value:"pending",className:"flex items-center gap-2",children:["Pending",e.jsx("span",{className:"inline-flex items-center justify-center px-2 py-0.5 text-xs text-zinc-700 dark:text-zinc-100",children:h.length})]})]}),e.jsx(X,{value:"pending",children:e.jsx("div",{className:"rounded-md overflow-x-auto w-full max-w-full border border-border bg-white dark:bg-zinc-900 dark:border-zinc-700",children:e.jsxs(F,{children:[e.jsx(O,{children:e.jsxs(u,{children:[e.jsx(n,{className:"dark:text-zinc-100",children:"Name"}),e.jsx(n,{className:"dark:text-zinc-100",children:"Student #"}),e.jsx(n,{className:"dark:text-zinc-100",children:"Email"}),e.jsx(n,{className:"dark:text-zinc-100",children:"Program"}),e.jsx(n,{className:"dark:text-zinc-100",children:"Program Coordinator"}),e.jsx(n,{className:"dark:text-zinc-100 text-center",children:"Actions"})]})}),e.jsx(U,{children:j?e.jsx(u,{children:e.jsx(i,{colSpan:6,className:"py-8 text-center text-sm text-muted-foreground dark:text-zinc-400",children:"Loading pending..."})}):E(h,!0)})]})})}),e.jsx(X,{value:"assigned",children:e.jsx("div",{className:"rounded-md overflow-x-auto w-full max-w-full border border-border bg-white dark:bg-zinc-900 dark:border-zinc-700",children:e.jsxs(F,{children:[e.jsx(O,{children:e.jsxs(u,{children:[e.jsx(n,{className:"dark:text-zinc-100",children:"Name"}),e.jsx(n,{className:"dark:text-zinc-100",children:"School ID"}),e.jsx(n,{className:"dark:text-zinc-100",children:"Email"}),e.jsx(n,{className:"dark:text-zinc-100",children:"Program"}),e.jsx(n,{className:"dark:text-zinc-100",children:"Program Coordinator"})]})}),e.jsx(U,{children:E(A,!1)})]})})})]}),e.jsx(I,{open:G,onOpenChange:w,children:e.jsxs(H,{className:"sm:max-w-md",children:[e.jsxs(M,{children:[e.jsxs(B,{className:"flex items-center gap-2",children:[e.jsx(le,{className:"h-5 w-5 text-green-500"}),"Accept Student & Send Notification?"]}),e.jsxs(q,{className:"pt-2 space-y-2",children:[e.jsx("p",{children:"You are accepting this student:"}),e.jsxs("div",{className:"bg-zinc-100 dark:bg-zinc-800 p-3 rounded-md space-y-1",children:[e.jsxs("p",{className:"font-semibold text-zinc-900 dark:text-zinc-100",children:[s==null?void 0:s.student.first_name," ",s!=null&&s.student.middle_name?s.student.middle_name[0]+".":""," ",s==null?void 0:s.student.last_name]}),e.jsx("p",{className:"text-sm text-zinc-600 dark:text-zinc-400",children:s==null?void 0:s.student.email}),e.jsx("p",{className:"text-sm text-zinc-600 dark:text-zinc-400",children:s==null?void 0:s.student.program})]}),e.jsx("p",{className:"text-sm text-zinc-600 dark:text-zinc-400",children:"Would you like to send an acceptance email notification to the student?"})]})]}),e.jsxs(Q,{className:"gap-2 sm:gap-0",children:[e.jsx(d,{variant:"outline",onClick:()=>T(!1),disabled:c,children:"Skip Email"}),e.jsx(d,{onClick:()=>T(!0),disabled:c,className:"bg-green-600 hover:bg-green-700",children:c?e.jsxs(e.Fragment,{children:[e.jsx(Y,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]}):e.jsxs(e.Fragment,{children:[e.jsx($,{className:"mr-2 h-4 w-4"}),"Send Email"]})})]})]})}),e.jsx(I,{open:J,onOpenChange:y,children:e.jsxs(H,{className:"sm:max-w-md",children:[e.jsxs(M,{children:[e.jsxs(B,{className:"flex items-center gap-2",children:[e.jsx(me,{className:"h-5 w-5 text-rose-500"}),"Reject Student & Send Notification?"]}),e.jsxs(q,{className:"pt-2 space-y-2",children:[e.jsx("p",{children:"You are rejecting this student:"}),e.jsxs("div",{className:"bg-zinc-100 dark:bg-zinc-800 p-3 rounded-md space-y-1",children:[e.jsxs("p",{className:"font-semibold text-zinc-900 dark:text-zinc-100",children:[s==null?void 0:s.student.first_name," ",s!=null&&s.student.middle_name?s.student.middle_name[0]+".":""," ",s==null?void 0:s.student.last_name]}),e.jsx("p",{className:"text-sm text-zinc-600 dark:text-zinc-400",children:s==null?void 0:s.student.email}),e.jsx("p",{className:"text-sm text-zinc-600 dark:text-zinc-400",children:s==null?void 0:s.student.program})]}),e.jsx("p",{className:"text-sm text-zinc-600 dark:text-zinc-400",children:"Would you like to send a rejection email notification to the student?"})]})]}),e.jsxs(Q,{className:"gap-2 sm:gap-0",children:[e.jsx(d,{variant:"outline",onClick:()=>L(!1),disabled:c,children:"Skip Email"}),e.jsx(d,{onClick:()=>L(!0),disabled:c,className:"bg-rose-600 hover:bg-rose-700",children:c?e.jsxs(e.Fragment,{children:[e.jsx(Y,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]}):e.jsxs(e.Fragment,{children:[e.jsx($,{className:"mr-2 h-4 w-4"}),"Send Email"]})})]})]})})]})}export{Be as default};
