import{r as c,j as e,L as se}from"./app-CQngmq00.js";import{A as te}from"./app-layout-C76KB2Lm.js";import{C as D,a as F,b as V,c as k,d as ae}from"./card-C_emSl4Q.js";import{B as re}from"./badge-BsPMjMb7.js";import{B as N}from"./button-Cw9tQIeO.js";import{I as le}from"./input-izsDzGd9.js";import{S as T,a as E,b as I,c as P,e as u}from"./select-Dw8a4pct.js";import{D as ie,a as ne,e as ce,b as de,c as oe,f as me}from"./dialog-D-tH9FDm.js";import{n as xe}from"./normalizeInterval-CdMCNNY-.js";import{c as he}from"./en-US-BA9orzCf.js";import{a as W,e as pe}from"./endOfWeek-QFyZPl43.js";import{i as q}from"./isToday-2ODO8FsQ.js";import{c as ue}from"./createLucideIcon-pjYyoixj.js";import{C as B}from"./calendar-Bi5dAEy5.js";import{C as H}from"./clock-Cn1v7f4i.js";import{M as $}from"./map-pin-D21M7BMN.js";import{E as je}from"./eye-B6whRoNB.js";import{p as ge}from"./parseISO-CbXPh3Al.js";import{U as fe}from"./users-DZ67WViD.js";import{a as Ne,f as x}from"./format-HX8DKPSU.js";import"./index-CDDLQrUy.js";import"./index-DZZQifJx.js";import"./utils-jAU0Cazi.js";import"./index-BSk2xfhC.js";import"./index-DRp-GX9j.js";import"./index-BZgaE142.js";import"./x-B3RMhnUQ.js";import"./tooltip-BvePKNvs.js";import"./floating-ui.react-dom-DL84dtXf.js";import"./separator-CMC4qrzs.js";import"./index-ahz1tZ6M.js";import"./chevron-right-QGs8lTP5.js";import"./dropdown-menu-BQlfF7jf.js";import"./index-CgLqTVh4.js";import"./index-VBHUZLOo.js";import"./index-BfMlnZ5P.js";import"./index-Csh4Fj4k.js";import"./check-BEGkAg7k.js";import"./avatar-DUph8BC-.js";import"./settings-CDLWUJwV.js";import"./graduation-cap-DHFIPOzN.js";import"./file-text-Buh9X5tE.js";import"./dollar-sign-CkMbILE9.js";import"./send-BvMnN6yE.js";import"./credit-card-Cid_txJ6.js";import"./tabs-DJOYkXMD.js";import"./circle-check-big-PSYRp90q.js";import"./info-BJ9Jpdwx.js";import"./sun-5m6UvoyG.js";import"./index-BJk2QW0A.js";import"./chevron-down-Bg3q2iyP.js";import"./constructNow-Chb2L4Vx.js";import"./isSameDay-DUlCFK42.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],U=ue("TriangleAlert",ve);function ye(d,p){const{start:a,end:h}=xe(p==null?void 0:p.in,d);let o=+a>+h;const b=o?+a:+h,n=o?h:a;n.setHours(0,0,0,0);let w=1;const m=[];for(;+n<=b;)m.push(he(a,n)),n.setDate(n.getDate()+w),n.setHours(0,0,0,0);return o?m.reverse():m}function be(d,p,a){return W(d,-p,a)}function bs({scheduledDefenses:d,user:p}){const[a,h]=c.useState(new Date),[o,b]=c.useState("week"),[n,w]=c.useState(""),[m,z]=c.useState("all"),[v,K]=c.useState("all"),[r,Q]=c.useState(null),[G,C]=c.useState(!1),R=c.useMemo(()=>[...new Set(d.map(t=>t.program))].sort(),[d]),J=c.useMemo(()=>[...new Set(d.map(t=>t.defense_type))].sort(),[d]),_=c.useMemo(()=>d.filter(s=>{const t=n===""||s.student_name.toLowerCase().includes(n.toLowerCase())||s.thesis_title.toLowerCase().includes(n.toLowerCase())||s.school_id.toLowerCase().includes(n.toLowerCase()),l=m==="all"||s.program===m,i=v==="all"||s.defense_type===v;return t&&l&&i}),[d,n,m,v]),M=c.useMemo(()=>{const s=Ne(a,{weekStartsOn:0});return ye({start:s,end:pe(a,{weekStartsOn:0})})},[a]),X=c.useMemo(()=>{const s={};return _.forEach(t=>{const l=t.scheduled_date;s[l]||(s[l]=[]),s[l].push(t)}),Object.keys(s).forEach(t=>{s[t].sort((l,i)=>l.scheduled_time.localeCompare(i.scheduled_time))}),s},[_]),j=s=>{const t=x(s,"yyyy-MM-dd");return X[t]||[]},L=s=>{Q(s),C(!0)},Y=s=>{switch(s){case"scheduled":return"bg-blue-100 text-blue-800";case"completed":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},S=s=>s==="online"?"💻":"🏛️",O=s=>{const t=j(s),l=[];return t.forEach((i,y)=>{t.slice(y+1).forEach(g=>{if(i.scheduled_time===g.scheduled_time){const Z=i.panels_list.map(f=>f.name),ee=g.panels_list.map(f=>f.name),A=Z.some(f=>ee.includes(f))||i.defense_venue===g.defense_venue;A&&!l.includes(i)&&l.push(i),A&&!l.includes(g)&&l.push(g)}})}),l};return e.jsxs(te,{children:[e.jsx(se,{title:"Defense Schedule"}),e.jsx("div",{className:"py-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Defense Schedule"}),e.jsx("p",{className:"text-gray-600",children:"Manage and view all scheduled thesis defenses"})]}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs(T,{value:o,onValueChange:s=>b(s),children:[e.jsx(E,{className:"w-32",children:e.jsx(I,{})}),e.jsxs(P,{children:[e.jsx(u,{value:"week",children:"Week View"}),e.jsx(u,{value:"day",children:"Day View"})]})]})})]}),e.jsxs(D,{className:"mb-6",children:[e.jsx(F,{children:e.jsx(V,{className:"text-lg",children:"Filters & Search"})}),e.jsx(k,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{children:e.jsx(le,{placeholder:"Search student, thesis title...",value:n,onChange:s=>w(s.target.value),className:"w-full"})}),e.jsxs(T,{value:m,onValueChange:z,children:[e.jsx(E,{children:e.jsx(I,{placeholder:"All Programs"})}),e.jsxs(P,{children:[e.jsx(u,{value:"all",children:"All Programs"}),R.map(s=>e.jsx(u,{value:s,children:s},s))]})]}),e.jsxs(T,{value:v,onValueChange:K,children:[e.jsx(E,{children:e.jsx(I,{placeholder:"All Types"})}),e.jsxs(P,{children:[e.jsx(u,{value:"all",children:"All Types"}),J.map(s=>e.jsx(u,{value:s,children:s},s))]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("span",{className:"text-sm text-gray-600",children:["Total: ",_.length]})})]})})]}),e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(N,{variant:"outline",onClick:()=>h(be(a,o==="week"?7:1)),children:"Previous"}),e.jsx(N,{variant:"outline",onClick:()=>h(new Date),children:"Today"}),e.jsx(N,{variant:"outline",onClick:()=>h(W(a,o==="week"?7:1)),children:"Next"})]}),e.jsx("h2",{className:"text-xl font-semibold",children:o==="week"?`Week of ${x(M[0],"MMM d")} - ${x(M[6],"MMM d, yyyy")}`:x(a,"EEEE, MMMM d, yyyy")})]}),o==="week"?e.jsx("div",{className:"grid grid-cols-7 gap-1 bg-white rounded-lg border overflow-hidden",children:M.map(s=>{const t=j(s),l=O(s);return e.jsxs("div",{className:"min-h-[200px] border-r border-b",children:[e.jsxs("div",{className:`p-2 text-center border-b ${q(s)?"bg-blue-50 text-blue-700 font-semibold":"bg-gray-50"}`,children:[e.jsx("div",{className:"text-sm font-medium",children:x(s,"EEE")}),e.jsx("div",{className:`text-lg ${q(s)?"font-bold":""}`,children:x(s,"d")})]}),e.jsx("div",{className:"p-1 space-y-1",children:t.map(i=>{const y=l.includes(i);return e.jsxs("div",{className:`p-2 rounded text-xs cursor-pointer hover:opacity-80 transition-opacity
                                                            ${y?"bg-red-100 border border-red-300":"bg-blue-100 border border-blue-200"}
                                                        `,onClick:()=>L(i),children:[y&&e.jsxs("div",{className:"flex items-center gap-1 text-red-600 mb-1",children:[e.jsx(U,{className:"h-3 w-3"}),e.jsx("span",{className:"text-xs font-semibold",children:"CONFLICT"})]}),e.jsx("div",{className:"font-medium truncate",children:i.student_name}),e.jsx("div",{className:"text-gray-600",children:i.scheduled_time}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{children:S(i.defense_mode)}),e.jsx("span",{className:"truncate",children:i.defense_venue})]})]},i.id)})})]},s.toISOString())})}):e.jsxs(D,{children:[e.jsxs(F,{children:[e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(B,{className:"h-5 w-5"}),x(a,"EEEE, MMMM d, yyyy")]}),e.jsxs(ae,{children:[j(a).length," defense(s) scheduled"]})]}),e.jsx(k,{children:e.jsx("div",{className:"space-y-4",children:j(a).length===0?e.jsx("p",{className:"text-center py-8 text-gray-500",children:"No defenses scheduled for this day"}):j(a).map(s=>{const l=O(a).includes(s);return e.jsx(D,{className:l?"border-red-300 bg-red-50":"",children:e.jsx(k,{className:"p-4",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[l&&e.jsxs("div",{className:"flex items-center gap-2 text-red-600 mb-2",children:[e.jsx(U,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm font-semibold",children:"SCHEDULING CONFLICT"})]}),e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h3",{className:"font-semibold text-lg",children:s.student_name}),e.jsx(re,{className:Y(s.workflow_state),children:s.workflow_state.toUpperCase()})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsxs("p",{children:[e.jsx("strong",{children:"ID:"})," ",s.school_id]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Program:"})," ",s.program]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Type:"})," ",s.defense_type]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(H,{className:"h-4 w-4"}),e.jsx("span",{children:s.scheduled_time})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($,{className:"h-4 w-4"}),e.jsx("span",{children:s.defense_venue})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{children:S(s.defense_mode)}),e.jsx("span",{children:s.defense_mode})]})]})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("p",{className:"font-medium text-sm",children:"Thesis Title:"}),e.jsx("p",{className:"text-sm text-gray-700",children:s.thesis_title})]})]}),e.jsxs(N,{variant:"outline",size:"sm",onClick:()=>L(s),children:[e.jsx(je,{className:"h-4 w-4 mr-1"}),"Details"]})]})})},s.id)})})})]}),e.jsx(ie,{open:G,onOpenChange:C,children:e.jsxs(ne,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(ce,{children:[e.jsx(de,{children:"Defense Details"}),e.jsxs(oe,{children:["Complete information for ",r==null?void 0:r.student_name,"'s defense"]})]}),r&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Student Information"}),e.jsxs("p",{children:["Name: ",r.student_name]}),e.jsxs("p",{children:["ID: ",r.school_id]}),e.jsxs("p",{children:["Program: ",r.program]}),e.jsxs("p",{children:["Defense Type: ",r.defense_type]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Schedule Information"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(B,{className:"h-4 w-4"}),e.jsx("span",{children:x(ge(r.scheduled_date),"EEEE, MMMM d, yyyy")})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(H,{className:"h-4 w-4"}),e.jsx("span",{children:r.scheduled_time})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx($,{className:"h-4 w-4"}),e.jsx("span",{children:r.defense_venue})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{children:S(r.defense_mode)}),e.jsx("span",{children:r.defense_mode})]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium mb-2",children:"Thesis Title"}),e.jsx("p",{className:"text-sm bg-gray-50 p-3 rounded",children:r.thesis_title})]}),r.panels_list.length>0&&e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium mb-2 flex items-center gap-2",children:[e.jsx(fe,{className:"h-4 w-4"}),"Panel Members"]}),e.jsx("div",{className:"space-y-1",children:r.panels_list.map((s,t)=>e.jsxs("div",{className:"flex justify-between text-sm bg-gray-50 p-2 rounded",children:[e.jsxs("span",{className:"font-medium",children:[s.role,":"]}),e.jsx("span",{children:s.name})]},t))})]}),r.scheduling_notes&&e.jsxs("div",{children:[e.jsx("p",{className:"font-medium mb-2",children:"Scheduling Notes"}),e.jsx("p",{className:"text-sm bg-yellow-50 p-3 rounded border border-yellow-200",children:r.scheduling_notes})]})]}),e.jsx(me,{children:e.jsx(N,{variant:"outline",onClick:()=>C(!1),children:"Close"})})]})})]})})]})}export{bs as default};
