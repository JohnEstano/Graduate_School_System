import{r,j as e,L as T}from"./app-BAKMM9W6.js";import{A as k}from"./app-layout-CHeZhPmm.js";import{B as i}from"./button-CVeIta7K.js";import{C as E}from"./card-DwLtnUhU.js";import{I as y}from"./input-BRk-fvKd.js";import{T as O,t as l}from"./index-C9JbnLWr.js";import{D as F,a as R,b as L,c as P}from"./dialog-Fyk91gvx.js";import I from"./table-all-defense-batch-Cymy7rfh.js";import{S as q}from"./send-CY1U2khq.js";import{R as z}from"./refresh-cw-9-zbTljB.js";import{P as A}from"./plus-8HUCooS0.js";import{X as U}from"./x-BVoq4DiS.js";import"./index-CEqJL0NP.js";import"./index-DZZQifJx.js";import"./utils-jAU0Cazi.js";import"./index-Chzm2fti.js";import"./index-CUQ5MhIm.js";import"./index-DScCZkqp.js";import"./tooltip-B2Ch4P2D.js";import"./floating-ui.react-dom-CqLEll0E.js";import"./createLucideIcon-BSNBS9Xz.js";import"./separator-LRfcwlAa.js";import"./index-BHprz6Pm.js";import"./chevron-right-DZ7e7qvM.js";import"./dropdown-menu-D2EcCZ7C.js";import"./index-SVK1MPcU.js";import"./index-DUmeJSti.js";import"./index-C98k58Jz.js";import"./index-BqysFurs.js";import"./index-CEy3VqYv.js";import"./check-DCZqiU_u.js";import"./avatar-BvAeIlgK.js";import"./settings-CXr5fuO8.js";import"./graduation-cap-CyBvkmsT.js";import"./file-text-Bhi2OKUW.js";import"./dollar-sign-BZcFe5e9.js";import"./users-t5r6UxGv.js";import"./badge-dollar-sign-Ciqfzy1N.js";import"./credit-card-DIRNAmsI.js";import"./tabs-DJFs2CDd.js";import"./badge-D0sAGNiG.js";import"./circle-check-big-wj1h3M4g.js";import"./info-D5wsL-jW.js";import"./sun-D0NfJtcj.js";import"./table-B43wWAfS.js";import"./pencil-Dg4YcIf1.js";const X=[{value:"ready",label:"Ready for Finance",color:"bg-blue-100 text-blue-700 border-blue-200"},{value:"in_progress",label:"In Progress",color:"bg-yellow-100 text-yellow-700 border-yellow-200"},{value:"paid",label:"Paid",color:"bg-green-100 text-green-700 border-green-200"}];function Pe(){const[N,x]=r.useState([]),[h,v]=r.useState(""),[c,b]=r.useState([]),[n,o]=r.useState(!1),[C,m]=r.useState(!1),[p,j]=r.useState(""),[g,d]=r.useState(""),u=async()=>{o(!0);try{const t=await fetch("/aa/payment-batches");if(t.ok){const s=await t.json();x(s)}else l.error("Failed to fetch batches")}catch{l.error("Error fetching batches")}finally{o(!1)}};r.useEffect(()=>{u()},[]);const S=N.filter(t=>(!h||t.name.toLowerCase().includes(h.toLowerCase()))&&(!c.length||c.includes(t.status))),w=async()=>{var t;if(!p.trim()){d("Batch name is required");return}o(!0),d("");try{const s=await fetch("/aa/payment-batches",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((t=document.querySelector('meta[name="csrf-token"]'))==null?void 0:t.content)||""},body:JSON.stringify({name:p})});if(s.ok)m(!1),j(""),u(),l.success("Batch created");else{const a=await s.json();d((a==null?void 0:a.error)||"Failed to create batch")}}catch{d("Error creating batch")}finally{o(!1)}},B=async(t,s)=>{var a;o(!0);try{(await fetch(`/aa/payment-batches/${t}/status`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((a=document.querySelector('meta[name="csrf-token"]'))==null?void 0:a.content)||""},body:JSON.stringify({status:s})})).ok?(x(D=>D.map(f=>f.id===t?{...f,status:s}:f)),l.success("Status updated")):l.error("Failed to update status")}catch{l.error("Error updating status")}finally{o(!1)}};return e.jsxs(k,{breadcrumbs:[{title:"Dashboard",href:"/dashboard"},{title:"Defense Batches",href:"/assistant/defense-batch"}],children:[e.jsx(T,{title:"Defense Batches"}),e.jsx(O,{richColors:!0,position:"bottom-right"}),e.jsxs("div",{className:"flex flex-col gap-4 pt-5 pr-3 pl-3",children:[e.jsxs(E,{className:"p-4 flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-10 w-10 flex items-center justify-center rounded-full bg-blue-500/10 border border-blue-500",children:e.jsx(q,{className:"h-5 w-5 text-blue-500"})}),e.jsxs("div",{children:[e.jsx("span",{className:"text-base font-semibold",children:"Defense Batches"}),e.jsx("span",{className:"block text-xs text-muted-foreground",children:"Grouped defense requests for finance processing."})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(i,{variant:"outline",size:"sm",onClick:u,disabled:n,children:[e.jsx(z,{className:"h-4 w-4 mr-1"})," Refresh"]}),e.jsxs(i,{variant:"default",size:"sm",onClick:()=>m(!0),children:[e.jsx(A,{className:"h-4 w-4 mr-1"})," New Batch"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(y,{type:"text",placeholder:"Search batch name...",value:h,onChange:t=>v(t.target.value),className:"max-w-xs text-sm h-8",disabled:n}),e.jsxs("div",{className:"flex gap-1",children:[X.map(t=>e.jsx(i,{variant:c.includes(t.value)?"default":"outline",size:"sm",className:"h-8 px-3",onClick:()=>b(s=>s.includes(t.value)?s.filter(a=>a!==t.value):[...s,t.value]),children:t.label},t.value)),c.length>0&&e.jsxs(i,{variant:"ghost",size:"sm",onClick:()=>b([]),children:[e.jsx(U,{className:"h-4 w-4"})," Reset"]})]})]})]}),e.jsx(I,{batches:S,onUpdateStatus:B,isLoading:n})]}),e.jsx(F,{open:C,onOpenChange:m,children:e.jsxs(R,{children:[e.jsx(L,{children:"Create New Batch"}),e.jsx(P,{children:"Enter a name for the new batch."}),e.jsx(y,{value:p,onChange:t=>j(t.target.value),placeholder:"Batch name",className:"mt-2",disabled:n}),g&&e.jsx("div",{className:"text-red-600 text-xs mt-1",children:g}),e.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[e.jsx(i,{variant:"ghost",onClick:()=>m(!1),children:"Cancel"}),e.jsx(i,{onClick:w,disabled:n,children:"Create"})]})]})})]})}export{Pe as default};
