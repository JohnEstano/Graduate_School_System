import{r as c,j as e,S as M,a as re}from"./app-OOvd0qGy.js";import{d as Y}from"./dayjs.min-CtUKUHq-.js";import{P as I,a as H,b as O}from"./popover-Bp-FQuXL.js";import{I as le}from"./input-CzcDJDbH.js";import{T as U,a as V,b as j,c as l,d as X,e as r}from"./table-CmM6ti-o.js";import{B as i}from"./button-Bvl2ELDv.js";import{C as f}from"./checkbox-DvV6N4JH.js";import{B as b}from"./badge-9siNCstt.js";import{c as ie,T as ne,a as de,b as oe}from"./tooltip-BFmjF_jJ.js";import{t as P}from"./index-imi9ZEDw.js";import{D as ce,a as xe,e as pe,b as me,f as he}from"./dialog-DgFd6e46.js";import{T as Z,a as ue,b as G,c as J}from"./tabs-BvigrSxv.js";import{c as q}from"./createLucideIcon-Cvkj7Hkp.js";import{U as ge}from"./users-EStqJIUY.js";import{S as we}from"./search-BBppaIz6.js";import{C as K}from"./circle-plus-DPLF9e0I.js";import{X as Q}from"./x-DrNmi13E.js";import{C as je}from"./circle-check-big-Ddw5Ycw8.js";import{C as fe}from"./circle-x-Cfzvg8iR.js";import{C as be}from"./circle-arrow-left-eoVZyPRG.js";import{T as ye}from"./trash-2-CnrCBa_Y.js";import{P as Ne}from"./printer-wZNaoGBe.js";import{P as ve}from"./paperclip-D2cdFqeN.js";import"./index-DQ9rqnvl.js";import"./index-ChOW5_O6.js";import"./floating-ui.react-dom-BrG2AUyT.js";import"./index-4w5oLsoB.js";import"./utils-jAU0Cazi.js";import"./index-DZZQifJx.js";import"./index-B9sjBiRz.js";import"./index-kQq3evoo.js";import"./index-DcZRhvrv.js";import"./index-DnomuSoJ.js";import"./index-CQ9en90x.js";import"./check-CihXD7iu.js";import"./index-B2wwfcIF.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]],Ce=q("ArrowRightLeft",ke);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _e=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]],Ae=q("File",_e);function v(d){const x=d.middle_name?`${d.middle_name[0].toUpperCase()}. `:"";return`${d.first_name} ${x}${d.last_name}`}function W(d){const x=[{key:"manuscript_proposal",label:"Manuscript"},{key:"similarity_index",label:"Similarity"},{key:"rec_endorsement",label:"REC Endorsement"},{key:"proof_of_payment",label:"Proof of Payment"},{key:"advisers_endorsement",label:"Adviser Endorsement"},{key:"avisee_adviser_attachment",label:"Avisee-Adviser File"}];return e.jsx(ie,{children:e.jsx("div",{className:"flex gap-1",children:x.map(u=>d[u.key]?e.jsxs(ne,{children:[e.jsx(de,{asChild:!0,children:e.jsx("a",{href:`/storage/${d[u.key]}`,target:"_blank",rel:"noopener noreferrer",className:"group",onClick:C=>C.stopPropagation(),children:e.jsx("span",{className:"inline-flex items-center justify-center rounded bg-rose-500 hover:bg-rose-600 transition-colors w-7 h-7",children:e.jsx(ve,{className:"h-4 w-4 text-white"})})})}),e.jsx(oe,{side:"top",className:"text-xs bg-black text-white border-none shadow-lg",children:u.label})]},u.key):null)})})}function ps({defenseRequests:d=[],coordinator:x,title:u="All Defense Requirements",description:C="Review, approve, or reject defense requests from your advisees"}){const[T,ee]=c.useState(""),[o,k]=c.useState([]),[Se,R]=c.useState(null),[Pe,se]=c.useState(!1),[p,_]=c.useState([]),[m,A]=c.useState([]),[z,D]=c.useState(!1),[g,$]=c.useState(!1),[h,y]=c.useState(null),w=d.filter(s=>{var L;const t=v(s).toLowerCase(),a=((L=s.thesis_title)==null?void 0:L.toLowerCase())||"",N=T.toLowerCase();let n=t.includes(N)||a.includes(N);return p.length&&(n=n&&p.includes(s.priority||"")),m.length&&(n=n&&m.includes(s.defense_type||"")),n}),B=w.filter(s=>s.adviser_status==="Approved"),S=o.length===w.length&&w.length>0,E=()=>k(S?[]:w.map(s=>s.id)),F=s=>k(o.includes(s)?o.filter(t=>t!==s):[...o,s]);function te(){const s=d.filter(a=>o.includes(a.id)),t=window.open("","","height=900,width=1200");t&&(t.document.write(`
          <html>
            <head>
              <title>Print Selected</title>
              <style>
                body{font-family:Arial;padding:32px}
                h1{font-size:18px;margin:0 0 16px}
                table{border-collapse:collapse;width:100%}
                th,td{border:1px solid #ccc;padding:6px 8px;font-size:12px;text-align:left}
              </style>
            </head>
            <body>
              <h1>Defense Requests</h1>
              <table>
                <thead><tr><th>ID</th><th>Title</th><th>Presenter</th><th>Type</th><th>Status</th></tr></thead>
                <tbody>
                  ${s.map(a=>`<tr>
                    <td>${a.id}</td>
                    <td>${a.thesis_title}</td>
                    <td>${a.first_name} ${a.last_name}</td>
                    <td>${a.defense_type}</td>
                    <td>${a.adviser_status==="Approved"?"Endorsed":a.adviser_status||"—"}</td>
                  </tr>`).join("")}
                </tbody>
              </table>
              <script>window.print()<\/script>
            </body>
          </html>
        `),t.document.close())}const ae=async s=>{var a,N;$(!0);const t=P.loading(s==="approve"?"Approving selected...":s==="reject"?"Rejecting selected...":"Retrieving selected...");try{let n="";s==="approve"?n="/defense-requests/bulk-approve":s==="reject"?n="/defense-requests/bulk-reject":s==="retrieve"&&(n="/defense-requests/bulk-retrieve"),await re.post(n,{ids:o}),P.success(s==="approve"?"Requests approved and sent to your coordinator!":s==="reject"?"Requests rejected.":"Requests retrieved for review.",{id:t}),k([]),y(null),R(null),window.location.reload()}catch(n){P.error(((N=(a=n.response)==null?void 0:a.data)==null?void 0:N.error)||`Bulk ${s} failed.`,{id:t})}finally{$(!1)}};return e.jsxs("div",{className:"flex flex-col pb-5 w-full",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(Z,{defaultValue:"all",className:"w-auto",children:e.jsxs(ue,{className:"bg-zinc-100",children:[e.jsx(G,{value:"all",className:"px-4 py-1 font-medium",children:"All"}),e.jsx(G,{value:"endorsed",className:"px-4 py-1 font-medium",children:"Endorsed Submissions"})]})}),e.jsxs("div",{className:"flex items-center gap-2 bg-black text-white rounded px-3 py-2 text-xs font-medium shadow-sm",children:[e.jsxs("span",{className:"flex items-center gap-1",children:["Adviser ",e.jsx("span",{className:"font-semibold",children:"(You)"})]}),e.jsx(Ce,{className:"h-4 w-4 mx-2"}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ge,{className:"h-4 w-4 mr-1"}),"Coordinator",e.jsx("span",{className:"font-semibold ml-1",children:x?x.name:e.jsx("span",{className:"italic text-zinc-300",children:"No coordinator registered"})})]})]})]}),e.jsxs("div",{className:"w-full bg-white border border-zinc-200 rounded-lg overflow-hidden mb-4",children:[e.jsx("div",{className:"flex flex-row items-center justify-between w-full p-3 border-b bg-white",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-10 w-10 flex items-center justify-center rounded-full bg-blue-500/10 border border-blue-500",children:e.jsx(Ae,{className:"h-5 w-5 text-blue-400"})}),e.jsxs("div",{children:[e.jsx("span",{className:"text-base font-semibold",children:u}),e.jsx("span",{className:"block text-xs text-muted-foreground",children:C})]})]})}),e.jsx("div",{className:"flex items-center justify-between gap-2 px-4 py-3 border-b bg-white",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(le,{type:"text",startIcon:we,placeholder:"Search...",value:T,onChange:s=>ee(s.target.value),className:"max-w-xs text-sm py-1 h-8"}),e.jsxs(I,{open:z==="priority",onOpenChange:s=>D(s?"priority":!1),children:[e.jsx(H,{asChild:!0,children:e.jsxs(i,{variant:"outline",className:"h-8 px-3 rounded-md border-dashed text-xs flex items-center gap-1",children:[e.jsx(K,{className:"h-4 w-4 mr-1"}),"Priority",p.length>0&&e.jsx("span",{className:"ml-1 px-2 py-0.5 rounded-full text-xs bg-muted",children:p.length>1?`${p.length} selected`:p[0]})]})}),e.jsxs(O,{className:"w-44 p-1",side:"bottom",align:"start",children:[["Low","Medium","High"].map(s=>e.jsxs("div",{onClick:()=>_(t=>t.includes(s)?t.filter(a=>a!==s):[...t,s]),className:"flex items-center gap-2 p-2 rounded hover:bg-muted cursor-pointer",children:[e.jsx(f,{checked:p.includes(s)}),e.jsx("span",{className:"text-sm",children:s})]},s)),e.jsx(i,{size:"sm",variant:"ghost",className:"w-full mt-2",onClick:()=>_([]),children:"Clear"})]})]}),e.jsxs(I,{open:z==="type",onOpenChange:s=>D(s?"type":!1),children:[e.jsx(H,{asChild:!0,children:e.jsxs(i,{variant:"outline",className:"h-8 px-3 rounded-md border-dashed text-xs flex items-center gap-1",children:[e.jsx(K,{className:"h-4 w-4 mr-1"}),"Type",m.length>0&&e.jsx("span",{className:"ml-1 px-2 py-0.5 rounded-full text-xs bg-muted",children:m.length>1?`${m.length} selected`:m[0]})]})}),e.jsxs(O,{className:"w-44 p-1",side:"bottom",align:"start",children:[["Proposal","Prefinal","Final"].map(s=>e.jsxs("div",{onClick:()=>A(t=>t.includes(s)?t.filter(a=>a!==s):[...t,s]),className:"flex items-center gap-2 p-2 rounded hover:bg-muted cursor-pointer",children:[e.jsx(f,{checked:m.includes(s)}),e.jsx("span",{className:"text-sm",children:s})]},s)),e.jsx(i,{size:"sm",variant:"ghost",className:"w-full mt-2",onClick:()=>A([]),children:"Clear"})]})]}),(p.length>0||m.length>0)&&e.jsxs(i,{variant:"ghost",size:"sm",className:"h-8 px-3 flex items-center gap-1",onClick:()=>{_([]),A([])},children:[e.jsx(Q,{size:14})," Reset"]})]})})]}),e.jsxs(Z,{defaultValue:"all",className:"w-full mb-2",children:[e.jsx(J,{value:"all",className:"w-full",children:e.jsx("div",{className:"relative w-full max-w-full",children:e.jsx("div",{className:"overflow-x-auto w-full rounded-md border border-border bg-background",children:e.jsxs(U,{className:"min-w-[900px] w-full text-sm table-auto",children:[e.jsx(V,{children:e.jsxs(j,{children:[e.jsx(l,{className:"w-[40px] py-2",children:e.jsx(f,{checked:S,onCheckedChange:E,"aria-label":"Select all"})}),e.jsx(l,{className:"px-3 min-w-[180px] whitespace-nowrap",children:"Title"}),e.jsx(l,{className:"px-2 min-w-[120px] whitespace-nowrap",children:"Presenter"}),e.jsx(l,{className:"px-2 min-w-[100px] whitespace-nowrap",children:"Program"}),e.jsx(l,{className:"text-center px-2 min-w-[90px] whitespace-nowrap",children:"Type"}),e.jsx(l,{className:"px-2 min-w-[130px] text-center whitespace-nowrap",children:"Submitted"}),e.jsx(l,{className:"px-2 min-w-[180px] whitespace-nowrap",children:"Attachments"}),e.jsx(l,{className:"px-2 min-w-[120px] text-center whitespace-nowrap",children:"Adviser Status"}),e.jsx(l,{className:"px-2 min-w-[120px] text-center whitespace-nowrap",children:"Coordinator Status"})]})}),e.jsxs(X,{children:[w.map(s=>{const t=o.includes(s.id);return e.jsxs(j,{className:"hover:bg-muted/40 cursor-pointer",onClick:()=>M.visit(`/adviser/defense-requirements/${s.id}/details`),children:[e.jsx(r,{className:"px-2 py-2",children:e.jsx(f,{checked:t,onCheckedChange:()=>F(s.id),className:"action-btn",onClick:a=>a.stopPropagation()})}),e.jsx(r,{className:"px-3 py-2 font-medium truncate leading-tight align-middle whitespace-nowrap max-w-[220px]",title:s.thesis_title,children:s.thesis_title}),e.jsx(r,{className:"px-2 py-2 text-xs text-muted-foreground whitespace-nowrap align-middle max-w-[140px] truncate",title:v(s),children:v(s)}),e.jsx(r,{className:"px-2 py-2 text-xs text-muted-foreground whitespace-nowrap align-middle max-w-[100px] truncate",children:s.program||"—"}),e.jsx(r,{className:"px-2 py-2 text-center align-middle whitespace-nowrap",children:e.jsx(b,{variant:"outline",children:s.defense_type||"—"})}),e.jsx(r,{className:"px-2 py-2 text-xs text-muted-foreground whitespace-nowrap text-center align-middle max-w-[120px] truncate",children:s.created_at?Y(s.created_at).format("YYYY-MM-DD hh:mm A"):"—"}),e.jsx(r,{className:"px-2 py-2 max-w-[180px] truncate",children:e.jsx(W,{...s})}),e.jsx(r,{className:"px-2 py-2 text-xs whitespace-nowrap text-center align-middle",children:e.jsx(b,{className:s.adviser_status==="Endorsed"?"bg-green-100 text-green-700 border-green-200":s.adviser_status==="Rejected"?"bg-red-100 text-red-700 border-red-200":s.adviser_status==="Pending"?"bg-yellow-100 text-yellow-700 border-yellow-200":"bg-gray-100 text-gray-700 border-gray-200",children:s.adviser_status==="Approved"?"Endorsed":s.adviser_status||"—"})}),e.jsx(r,{className:"px-2 py-2 text-xs whitespace-nowrap text-center align-middle",children:e.jsx(b,{className:s.coordinator_status==="Approved"?"bg-green-100 text-green-700 border-green-200":s.coordinator_status==="Rejected"?"bg-red-100 text-red-700 border-red-200":s.coordinator_status==="Pending"?"bg-yellow-100 text-yellow-700 border-yellow-200":"bg-gray-100 text-gray-700 border-gray-200",children:s.coordinator_status||"—"})})]},s.id)}),w.length===0&&e.jsx(j,{children:e.jsx(r,{colSpan:9,className:"text-center py-10 text-muted-foreground",children:"No defense requests found."})})]})]})})})}),e.jsx(J,{value:"endorsed",className:"w-full",children:e.jsx("div",{className:"relative w-full max-w-full",children:e.jsx("div",{className:"overflow-x-auto w-full rounded-md border border-border bg-background",children:e.jsxs(U,{className:"min-w-[900px] w-full text-sm table-auto",children:[e.jsx(V,{children:e.jsxs(j,{children:[e.jsx(l,{className:"w-[40px] py-2",children:e.jsx(f,{checked:S,onCheckedChange:E,"aria-label":"Select all"})}),e.jsx(l,{className:"px-3 min-w-[180px] whitespace-nowrap",children:"Title"}),e.jsx(l,{className:"px-2 min-w-[120px] whitespace-nowrap",children:"Presenter"}),e.jsx(l,{className:"px-2 min-w-[100px] whitespace-nowrap",children:"Program"}),e.jsx(l,{className:"text-center px-2 min-w-[90px] whitespace-nowrap",children:"Type"}),e.jsx(l,{className:"px-2 min-w-[130px] text-center whitespace-nowrap",children:"Submitted"}),e.jsx(l,{className:"px-2 min-w-[180px] whitespace-nowrap",children:"Attachments"}),e.jsx(l,{className:"px-2 min-w-[120px] text-center whitespace-nowrap",children:"Adviser Status"}),e.jsx(l,{className:"px-2 min-w-[120px] text-center whitespace-nowrap",children:"Coordinator Status"})]})}),e.jsxs(X,{children:[B.map(s=>{const t=o.includes(s.id);return e.jsxs(j,{className:"hover:bg-muted/40 cursor-pointer",onClick:()=>M.visit(`/adviser/defense-requirements/${s.id}/details`),children:[e.jsx(r,{className:"px-2 py-2",children:e.jsx(f,{checked:t,onCheckedChange:()=>F(s.id),className:"action-btn",onClick:a=>a.stopPropagation()})}),e.jsx(r,{className:"px-3 py-2 font-medium truncate leading-tight align-middle whitespace-nowrap max-w-[220px]",title:s.thesis_title,children:s.thesis_title}),e.jsx(r,{className:"px-2 py-2 text-xs text-muted-foreground whitespace-nowrap align-middle max-w-[140px] truncate",title:v(s),children:v(s)}),e.jsx(r,{className:"px-2 py-2 text-xs text-muted-foreground whitespace-nowrap align-middle max-w-[100px] truncate",children:s.program||"—"}),e.jsx(r,{className:"px-2 py-2 text-center align-middle whitespace-nowrap",children:e.jsx(b,{variant:"outline",children:s.defense_type||"—"})}),e.jsx(r,{className:"px-2 py-2 text-xs text-muted-foreground whitespace-nowrap text-center align-middle max-w-[120px] truncate",children:s.created_at?Y(s.created_at).format("YYYY-MM-DD hh:mm A"):"—"}),e.jsx(r,{className:"px-2 py-2 max-w-[180px] truncate",children:e.jsx(W,{...s})}),e.jsx(r,{className:"px-2 py-2 text-xs whitespace-nowrap text-center align-middle",children:e.jsx(b,{className:s.adviser_status==="Endorsed"?"bg-green-100 text-green-700 border-green-200":s.adviser_status==="Rejected"?"bg-red-100 text-red-700 border-red-200":s.adviser_status==="Pending"?"bg-yellow-100 text-yellow-700 border-yellow-200":"bg-gray-100 text-gray-700 border-gray-200",children:s.adviser_status==="Approved"?"Endorsed":s.adviser_status||"—"})}),e.jsx(r,{className:"px-2 py-2 text-xs whitespace-nowrap text-center align-middle",children:e.jsx(b,{className:s.coordinator_status==="Approved"?"bg-green-100 text-green-700 border-green-200":s.coordinator_status==="Rejected"?"bg-red-100 text-red-700 border-red-200":s.coordinator_status==="Pending"?"bg-yellow-100 text-yellow-700 border-yellow-200":"bg-gray-100 text-gray-700 border-gray-200",children:s.coordinator_status||"—"})})]},s.id)}),B.length===0&&e.jsx(j,{children:e.jsx(r,{colSpan:9,className:"text-center py-10 text-muted-foreground",children:"No endorsed submissions found."})})]})]})})})})]}),o.length>0&&e.jsxs("div",{className:"fixed left-1/2 z-30 -translate-x-1/2 bottom-4 md:bottom-6 flex items-center gap-1 bg-white border border-border shadow-lg rounded-lg px-4 py-1 text-xs animate-in fade-in slide-in-from-bottom-2 dark:bg-muted dark:text-muted-foreground dark:border-border",children:[e.jsxs("span",{className:"font-semibold min-w-[70px] text-center",children:[o.length," selected"]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsxs(i,{variant:"ghost",size:"icon",className:"px-2 py-1 h-7 w-auto text-xs flex items-center gap-1",onClick:()=>y("approve"),"aria-label":"Approve",disabled:g,children:[e.jsx(je,{size:13,className:"text-green-500"}),e.jsx("span",{className:"hidden sm:inline",children:"Approve"})]}),e.jsxs(i,{variant:"ghost",size:"icon",className:"px-2 py-1 h-7 w-auto text-xs flex items-center gap-1",onClick:()=>y("reject"),"aria-label":"Reject",disabled:g,children:[e.jsx(fe,{size:13,className:"text-red-500"}),e.jsx("span",{className:"hidden sm:inline",children:"Reject"})]}),e.jsxs(i,{variant:"ghost",size:"icon",className:"px-2 py-1 h-7 w-auto text-xs flex items-center gap-1",onClick:()=>R("retrieve"),"aria-label":"Retrieve",children:[e.jsx(be,{size:13,className:"text-blue-500"}),e.jsx("span",{className:"hidden sm:inline",children:"Retrieve"})]}),e.jsxs(i,{variant:"ghost",size:"icon",className:"px-2 py-1 h-7 w-auto text-xs flex items-center gap-1",onClick:()=>se(!0),"aria-label":"Delete",children:[e.jsx(ye,{size:13}),e.jsx("span",{className:"hidden sm:inline",children:"Delete"})]}),e.jsxs(i,{variant:"ghost",size:"icon",className:"px-1 py-1 h-7 w-auto text-xs flex items-center gap-1",onClick:te,"aria-label":"Print",children:[e.jsx(Ne,{size:13}),e.jsx("span",{className:"hidden sm:inline",children:"Print"})]}),e.jsx(i,{variant:"ghost",size:"icon",className:"px-1 py-1 h-7 w-auto text-xs flex items-center",onClick:()=>k([]),"aria-label":"Clear selection",children:e.jsx(Q,{size:14})})]})]}),e.jsx(ce,{open:!!h,onOpenChange:s=>!g&&y(null),children:e.jsxs(xe,{children:[e.jsxs(pe,{children:[e.jsx(me,{children:h==="approve"?"Approve selected requests?":"Reject selected requests?"}),h==="approve"&&x&&e.jsxs("div",{className:"mt-2 text-xs text-muted-foreground",children:["These requests will be forwarded to your coordinator: ",e.jsx("span",{className:"font-semibold",children:x.name})]})]}),e.jsx("div",{className:"text-sm mb-2",children:h==="approve"?"Are you sure you want to approve and forward these requests to your coordinator?":"Are you sure you want to reject these requests? This cannot be undone."}),e.jsxs(he,{children:[e.jsx(i,{variant:"outline",onClick:()=>y(null),disabled:g,children:"Cancel"}),e.jsx(i,{onClick:()=>ae(h),disabled:g,className:"bg-rose-500 hover:bg-rose-600 text-white",children:g?h==="approve"?"Approving...":"Rejecting...":h==="approve"?"Approve":"Reject"})]})]})})]})}export{ps as default};
