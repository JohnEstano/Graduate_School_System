import{r as s,j as e}from"./app-CQngmq00.js";import{D as je,a as ye,e as Ne,b as Ce,c as Pe}from"./dialog-D-tH9FDm.js";import{B as E}from"./button-Cw9tQIeO.js";import"./index-DRp-GX9j.js";import{c as rt}from"./index-CDDLQrUy.js";import{c as Re}from"./utils-jAU0Cazi.js";import{S as se}from"./separator-CMC4qrzs.js";import{A as ae,b as le}from"./alert-Bmbp8jiW.js";import{L as ie}from"./label-CbqPBzn6.js";import{S as nt}from"./index-uG0LJcWd.js";import{t as v}from"./index-Vwkg4oTI.js";import{E as ot}from"./eye-B6whRoNB.js";import{S as st}from"./signature-CMYTxh5x.js";import{c as at}from"./createLucideIcon-pjYyoixj.js";import{L as $}from"./loader-circle-CWzTCUKj.js";import{S as lt}from"./send-BvMnN6yE.js";import{C as ce}from"./circle-alert-qBFnhNFa.js";import{C as de}from"./check-BEGkAg7k.js";import{P as it}from"./pencil-DZXKP1_R.js";import{F as ct}from"./file-text-Buh9X5tE.js";import{T as dt}from"./trash-2-BOv4JxAD.js";import"./index-BSk2xfhC.js";import"./index-BZgaE142.js";import"./x-B3RMhnUQ.js";import"./index-DZZQifJx.js";import"./index-ahz1tZ6M.js";import"./typeof-QjJsDpFa.js";import"./index-BGXDct6C.js";import"./index-Chjiymov.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ut=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],Te=at("Upload",ut);var mt=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],V=mt.reduce((t,n)=>{const r=rt(`Primitive.${n}`),a=s.forwardRef((o,l)=>{const{asChild:c,...d}=o,i=c?r:n;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(i,{...d,ref:l})});return a.displayName=`Primitive.${n}`,{...t,[n]:a}},{});function Ee(t,n){if(typeof t=="function")return t(n);t!=null&&(t.current=n)}function ft(...t){return n=>{let r=!1;const a=t.map(o=>{const l=Ee(o,n);return!r&&typeof l=="function"&&(r=!0),l});if(r)return()=>{for(let o=0;o<a.length;o++){const l=a[o];typeof l=="function"?l():Ee(t[o],null)}}}}function z(...t){return s.useCallback(ft(...t),t)}var ue=globalThis!=null&&globalThis.document?s.useLayoutEffect:()=>{};function ht(t,n){return s.useReducer((r,a)=>n[r][a]??r,t)}var G=t=>{const{present:n,children:r}=t,a=pt(n),o=typeof r=="function"?r({present:a.isPresent}):s.Children.only(r),l=z(a.ref,gt(o));return typeof r=="function"||a.isPresent?s.cloneElement(o,{ref:l}):null};G.displayName="Presence";function pt(t){const[n,r]=s.useState(),a=s.useRef(null),o=s.useRef(t),l=s.useRef("none"),c=t?"mounted":"unmounted",[d,i]=ht(c,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return s.useEffect(()=>{const u=Z(a.current);l.current=d==="mounted"?u:"none"},[d]),ue(()=>{const u=a.current,h=o.current;if(h!==t){const f=l.current,g=Z(u);t?i("MOUNT"):g==="none"||(u==null?void 0:u.display)==="none"?i("UNMOUNT"):i(h&&f!==g?"ANIMATION_OUT":"UNMOUNT"),o.current=t}},[t,i]),ue(()=>{if(n){let u;const h=n.ownerDocument.defaultView??window,p=g=>{const j=Z(a.current).includes(g.animationName);if(g.target===n&&j&&(i("ANIMATION_END"),!o.current)){const R=n.style.animationFillMode;n.style.animationFillMode="forwards",u=h.setTimeout(()=>{n.style.animationFillMode==="forwards"&&(n.style.animationFillMode=R)})}},f=g=>{g.target===n&&(l.current=Z(a.current))};return n.addEventListener("animationstart",f),n.addEventListener("animationcancel",p),n.addEventListener("animationend",p),()=>{h.clearTimeout(u),n.removeEventListener("animationstart",f),n.removeEventListener("animationcancel",p),n.removeEventListener("animationend",p)}}else i("ANIMATION_END")},[n,i]),{isPresent:["mounted","unmountSuspended"].includes(d),ref:s.useCallback(u=>{a.current=u?getComputedStyle(u):null,r(u)},[])}}function Z(t){return(t==null?void 0:t.animationName)||"none"}function gt(t){var a,o;let n=(a=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:a.get,r=n&&"isReactWarning"in n&&n.isReactWarning;return r?t.ref:(n=(o=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:o.get,r=n&&"isReactWarning"in n&&n.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}function xt(t,n=[]){let r=[];function a(l,c){const d=s.createContext(c),i=r.length;r=[...r,c];const u=p=>{var T;const{scope:f,children:g,...b}=p,j=((T=f==null?void 0:f[t])==null?void 0:T[i])||d,R=s.useMemo(()=>b,Object.values(b));return e.jsx(j.Provider,{value:R,children:g})};u.displayName=l+"Provider";function h(p,f){var j;const g=((j=f==null?void 0:f[t])==null?void 0:j[i])||d,b=s.useContext(g);if(b)return b;if(c!==void 0)return c;throw new Error(`\`${p}\` must be used within \`${l}\``)}return[u,h]}const o=()=>{const l=r.map(c=>s.createContext(c));return function(d){const i=(d==null?void 0:d[t])||l;return s.useMemo(()=>({[`__scope${t}`]:{...d,[t]:i}}),[d,i])}};return o.scopeName=t,[a,vt(o,...n)]}function vt(...t){const n=t[0];if(t.length===1)return n;const r=()=>{const a=t.map(o=>({useScope:o(),scopeName:o.scopeName}));return function(l){const c=a.reduce((d,{useScope:i,scopeName:u})=>{const p=i(l)[`__scope${u}`];return{...d,...p}},{});return s.useMemo(()=>({[`__scope${n.scopeName}`]:c}),[c])}};return r.scopeName=n.scopeName,r}function I(t){const n=s.useRef(t);return s.useEffect(()=>{n.current=t}),s.useMemo(()=>(...r)=>{var a;return(a=n.current)==null?void 0:a.call(n,...r)},[])}var bt=s.createContext(void 0);function wt(t){const n=s.useContext(bt);return t||n||"ltr"}function St(t,[n,r]){return Math.min(r,Math.max(n,t))}function W(t,n,{checkForDefaultPrevented:r=!0}={}){return function(o){if(t==null||t(o),r===!1||!o.defaultPrevented)return n==null?void 0:n(o)}}function jt(t,n){return s.useReducer((r,a)=>n[r][a]??r,t)}var me="ScrollArea",[_e,mr]=xt(me),[yt,A]=_e(me),Fe=s.forwardRef((t,n)=>{const{__scopeScrollArea:r,type:a="hover",dir:o,scrollHideDelay:l=600,...c}=t,[d,i]=s.useState(null),[u,h]=s.useState(null),[p,f]=s.useState(null),[g,b]=s.useState(null),[j,R]=s.useState(null),[T,F]=s.useState(0),[Y,X]=s.useState(0),[O,k]=s.useState(!1),[L,M]=s.useState(!1),S=z(n,C=>i(C)),N=wt(o);return e.jsx(yt,{scope:r,type:a,dir:N,scrollHideDelay:l,scrollArea:d,viewport:u,onViewportChange:h,content:p,onContentChange:f,scrollbarX:g,onScrollbarXChange:b,scrollbarXEnabled:O,onScrollbarXEnabledChange:k,scrollbarY:j,onScrollbarYChange:R,scrollbarYEnabled:L,onScrollbarYEnabledChange:M,onCornerWidthChange:F,onCornerHeightChange:X,children:e.jsx(V.div,{dir:N,...c,ref:S,style:{position:"relative","--radix-scroll-area-corner-width":T+"px","--radix-scroll-area-corner-height":Y+"px",...t.style}})})});Fe.displayName=me;var Le="ScrollAreaViewport",Ue=s.forwardRef((t,n)=>{const{__scopeScrollArea:r,children:a,nonce:o,...l}=t,c=A(Le,r),d=s.useRef(null),i=z(n,d,c.onViewportChange);return e.jsxs(e.Fragment,{children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:o}),e.jsx(V.div,{"data-radix-scroll-area-viewport":"",...l,ref:i,style:{overflowX:c.scrollbarXEnabled?"scroll":"hidden",overflowY:c.scrollbarYEnabled?"scroll":"hidden",...t.style},children:e.jsx("div",{ref:c.onContentChange,style:{minWidth:"100%",display:"table"},children:a})})]})});Ue.displayName=Le;var _="ScrollAreaScrollbar",Oe=s.forwardRef((t,n)=>{const{forceMount:r,...a}=t,o=A(_,t.__scopeScrollArea),{onScrollbarXEnabledChange:l,onScrollbarYEnabledChange:c}=o,d=t.orientation==="horizontal";return s.useEffect(()=>(d?l(!0):c(!0),()=>{d?l(!1):c(!1)}),[d,l,c]),o.type==="hover"?e.jsx(Nt,{...a,ref:n,forceMount:r}):o.type==="scroll"?e.jsx(Ct,{...a,ref:n,forceMount:r}):o.type==="auto"?e.jsx(ke,{...a,ref:n,forceMount:r}):o.type==="always"?e.jsx(fe,{...a,ref:n}):null});Oe.displayName=_;var Nt=s.forwardRef((t,n)=>{const{forceMount:r,...a}=t,o=A(_,t.__scopeScrollArea),[l,c]=s.useState(!1);return s.useEffect(()=>{const d=o.scrollArea;let i=0;if(d){const u=()=>{window.clearTimeout(i),c(!0)},h=()=>{i=window.setTimeout(()=>c(!1),o.scrollHideDelay)};return d.addEventListener("pointerenter",u),d.addEventListener("pointerleave",h),()=>{window.clearTimeout(i),d.removeEventListener("pointerenter",u),d.removeEventListener("pointerleave",h)}}},[o.scrollArea,o.scrollHideDelay]),e.jsx(G,{present:r||l,children:e.jsx(ke,{"data-state":l?"visible":"hidden",...a,ref:n})})}),Ct=s.forwardRef((t,n)=>{const{forceMount:r,...a}=t,o=A(_,t.__scopeScrollArea),l=t.orientation==="horizontal",c=re(()=>i("SCROLL_END"),100),[d,i]=jt("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return s.useEffect(()=>{if(d==="idle"){const u=window.setTimeout(()=>i("HIDE"),o.scrollHideDelay);return()=>window.clearTimeout(u)}},[d,o.scrollHideDelay,i]),s.useEffect(()=>{const u=o.viewport,h=l?"scrollLeft":"scrollTop";if(u){let p=u[h];const f=()=>{const g=u[h];p!==g&&(i("SCROLL"),c()),p=g};return u.addEventListener("scroll",f),()=>u.removeEventListener("scroll",f)}},[o.viewport,l,i,c]),e.jsx(G,{present:r||d!=="hidden",children:e.jsx(fe,{"data-state":d==="hidden"?"hidden":"visible",...a,ref:n,onPointerEnter:W(t.onPointerEnter,()=>i("POINTER_ENTER")),onPointerLeave:W(t.onPointerLeave,()=>i("POINTER_LEAVE"))})})}),ke=s.forwardRef((t,n)=>{const r=A(_,t.__scopeScrollArea),{forceMount:a,...o}=t,[l,c]=s.useState(!1),d=t.orientation==="horizontal",i=re(()=>{if(r.viewport){const u=r.viewport.offsetWidth<r.viewport.scrollWidth,h=r.viewport.offsetHeight<r.viewport.scrollHeight;c(d?u:h)}},10);return B(r.viewport,i),B(r.content,i),e.jsx(G,{present:a||l,children:e.jsx(fe,{"data-state":l?"visible":"hidden",...o,ref:n})})}),fe=s.forwardRef((t,n)=>{const{orientation:r="vertical",...a}=t,o=A(_,t.__scopeScrollArea),l=s.useRef(null),c=s.useRef(0),[d,i]=s.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),u=Xe(d.viewport,d.content),h={...a,sizes:d,onSizesChange:i,hasThumb:u>0&&u<1,onThumbChange:f=>l.current=f,onThumbPointerUp:()=>c.current=0,onThumbPointerDown:f=>c.current=f};function p(f,g){return Rt(f,c.current,d,g)}return r==="horizontal"?e.jsx(Pt,{...h,ref:n,onThumbPositionChange:()=>{if(o.viewport&&l.current){const f=o.viewport.scrollLeft,g=Ae(f,d,o.dir);l.current.style.transform=`translate3d(${g}px, 0, 0)`}},onWheelScroll:f=>{o.viewport&&(o.viewport.scrollLeft=f)},onDragScroll:f=>{o.viewport&&(o.viewport.scrollLeft=p(f,o.dir))}}):r==="vertical"?e.jsx(Tt,{...h,ref:n,onThumbPositionChange:()=>{if(o.viewport&&l.current){const f=o.viewport.scrollTop,g=Ae(f,d);l.current.style.transform=`translate3d(0, ${g}px, 0)`}},onWheelScroll:f=>{o.viewport&&(o.viewport.scrollTop=f)},onDragScroll:f=>{o.viewport&&(o.viewport.scrollTop=p(f))}}):null}),Pt=s.forwardRef((t,n)=>{const{sizes:r,onSizesChange:a,...o}=t,l=A(_,t.__scopeScrollArea),[c,d]=s.useState(),i=s.useRef(null),u=z(n,i,l.onScrollbarXChange);return s.useEffect(()=>{i.current&&d(getComputedStyle(i.current))},[i]),e.jsx(Ie,{"data-orientation":"horizontal",...o,ref:u,sizes:r,style:{bottom:0,left:l.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:l.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":te(r)+"px",...t.style},onThumbPointerDown:h=>t.onThumbPointerDown(h.x),onDragScroll:h=>t.onDragScroll(h.x),onWheelScroll:(h,p)=>{if(l.viewport){const f=l.viewport.scrollLeft+h.deltaX;t.onWheelScroll(f),$e(f,p)&&h.preventDefault()}},onResize:()=>{i.current&&l.viewport&&c&&a({content:l.viewport.scrollWidth,viewport:l.viewport.offsetWidth,scrollbar:{size:i.current.clientWidth,paddingStart:ee(c.paddingLeft),paddingEnd:ee(c.paddingRight)}})}})}),Tt=s.forwardRef((t,n)=>{const{sizes:r,onSizesChange:a,...o}=t,l=A(_,t.__scopeScrollArea),[c,d]=s.useState(),i=s.useRef(null),u=z(n,i,l.onScrollbarYChange);return s.useEffect(()=>{i.current&&d(getComputedStyle(i.current))},[i]),e.jsx(Ie,{"data-orientation":"vertical",...o,ref:u,sizes:r,style:{top:0,right:l.dir==="ltr"?0:void 0,left:l.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":te(r)+"px",...t.style},onThumbPointerDown:h=>t.onThumbPointerDown(h.y),onDragScroll:h=>t.onDragScroll(h.y),onWheelScroll:(h,p)=>{if(l.viewport){const f=l.viewport.scrollTop+h.deltaY;t.onWheelScroll(f),$e(f,p)&&h.preventDefault()}},onResize:()=>{i.current&&l.viewport&&c&&a({content:l.viewport.scrollHeight,viewport:l.viewport.offsetHeight,scrollbar:{size:i.current.clientHeight,paddingStart:ee(c.paddingTop),paddingEnd:ee(c.paddingBottom)}})}})}),[Et,Me]=_e(_),Ie=s.forwardRef((t,n)=>{const{__scopeScrollArea:r,sizes:a,hasThumb:o,onThumbChange:l,onThumbPointerUp:c,onThumbPointerDown:d,onThumbPositionChange:i,onDragScroll:u,onWheelScroll:h,onResize:p,...f}=t,g=A(_,r),[b,j]=s.useState(null),R=z(n,S=>j(S)),T=s.useRef(null),F=s.useRef(""),Y=g.viewport,X=a.content-a.viewport,O=I(h),k=I(i),L=re(p,10);function M(S){if(T.current){const N=S.clientX-T.current.left,C=S.clientY-T.current.top;u({x:N,y:C})}}return s.useEffect(()=>{const S=N=>{const C=N.target;(b==null?void 0:b.contains(C))&&O(N,X)};return document.addEventListener("wheel",S,{passive:!1}),()=>document.removeEventListener("wheel",S,{passive:!1})},[Y,b,X,O]),s.useEffect(k,[a,k]),B(b,L),B(g.content,L),e.jsx(Et,{scope:r,scrollbar:b,hasThumb:o,onThumbChange:I(l),onThumbPointerUp:I(c),onThumbPositionChange:k,onThumbPointerDown:I(d),children:e.jsx(V.div,{...f,ref:R,style:{position:"absolute",...f.style},onPointerDown:W(t.onPointerDown,S=>{S.button===0&&(S.target.setPointerCapture(S.pointerId),T.current=b.getBoundingClientRect(),F.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",g.viewport&&(g.viewport.style.scrollBehavior="auto"),M(S))}),onPointerMove:W(t.onPointerMove,M),onPointerUp:W(t.onPointerUp,S=>{const N=S.target;N.hasPointerCapture(S.pointerId)&&N.releasePointerCapture(S.pointerId),document.body.style.webkitUserSelect=F.current,g.viewport&&(g.viewport.style.scrollBehavior=""),T.current=null})})})}),q="ScrollAreaThumb",We=s.forwardRef((t,n)=>{const{forceMount:r,...a}=t,o=Me(q,t.__scopeScrollArea);return e.jsx(G,{present:r||o.hasThumb,children:e.jsx(At,{ref:n,...a})})}),At=s.forwardRef((t,n)=>{const{__scopeScrollArea:r,style:a,...o}=t,l=A(q,r),c=Me(q,r),{onThumbPositionChange:d}=c,i=z(n,p=>c.onThumbChange(p)),u=s.useRef(void 0),h=re(()=>{u.current&&(u.current(),u.current=void 0)},100);return s.useEffect(()=>{const p=l.viewport;if(p){const f=()=>{if(h(),!u.current){const g=_t(p,d);u.current=g,d()}};return d(),p.addEventListener("scroll",f),()=>p.removeEventListener("scroll",f)}},[l.viewport,h,d]),e.jsx(V.div,{"data-state":c.hasThumb?"visible":"hidden",...o,ref:i,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...a},onPointerDownCapture:W(t.onPointerDownCapture,p=>{const g=p.target.getBoundingClientRect(),b=p.clientX-g.left,j=p.clientY-g.top;c.onThumbPointerDown({x:b,y:j})}),onPointerUp:W(t.onPointerUp,c.onThumbPointerUp)})});We.displayName=q;var he="ScrollAreaCorner",ze=s.forwardRef((t,n)=>{const r=A(he,t.__scopeScrollArea),a=!!(r.scrollbarX&&r.scrollbarY);return r.type!=="scroll"&&a?e.jsx(Dt,{...t,ref:n}):null});ze.displayName=he;var Dt=s.forwardRef((t,n)=>{const{__scopeScrollArea:r,...a}=t,o=A(he,r),[l,c]=s.useState(0),[d,i]=s.useState(0),u=!!(l&&d);return B(o.scrollbarX,()=>{var p;const h=((p=o.scrollbarX)==null?void 0:p.offsetHeight)||0;o.onCornerHeightChange(h),i(h)}),B(o.scrollbarY,()=>{var p;const h=((p=o.scrollbarY)==null?void 0:p.offsetWidth)||0;o.onCornerWidthChange(h),c(h)}),u?e.jsx(V.div,{...a,ref:n,style:{width:l,height:d,position:"absolute",right:o.dir==="ltr"?0:void 0,left:o.dir==="rtl"?0:void 0,bottom:0,...t.style}}):null});function ee(t){return t?parseInt(t,10):0}function Xe(t,n){const r=t/n;return isNaN(r)?0:r}function te(t){const n=Xe(t.viewport,t.content),r=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,a=(t.scrollbar.size-r)*n;return Math.max(a,18)}function Rt(t,n,r,a="ltr"){const o=te(r),l=o/2,c=n||l,d=o-c,i=r.scrollbar.paddingStart+c,u=r.scrollbar.size-r.scrollbar.paddingEnd-d,h=r.content-r.viewport,p=a==="ltr"?[0,h]:[h*-1,0];return He([i,u],p)(t)}function Ae(t,n,r="ltr"){const a=te(n),o=n.scrollbar.paddingStart+n.scrollbar.paddingEnd,l=n.scrollbar.size-o,c=n.content-n.viewport,d=l-a,i=r==="ltr"?[0,c]:[c*-1,0],u=St(t,i);return He([0,c],[0,d])(u)}function He(t,n){return r=>{if(t[0]===t[1]||n[0]===n[1])return n[0];const a=(n[1]-n[0])/(t[1]-t[0]);return n[0]+a*(r-t[0])}}function $e(t,n){return t>0&&t<n}var _t=(t,n=()=>{})=>{let r={left:t.scrollLeft,top:t.scrollTop},a=0;return function o(){const l={left:t.scrollLeft,top:t.scrollTop},c=r.left!==l.left,d=r.top!==l.top;(c||d)&&n(),r=l,a=window.requestAnimationFrame(o)}(),()=>window.cancelAnimationFrame(a)};function re(t,n){const r=I(t),a=s.useRef(0);return s.useEffect(()=>()=>window.clearTimeout(a.current),[]),s.useCallback(()=>{window.clearTimeout(a.current),a.current=window.setTimeout(r,n)},[r,n])}function B(t,n){const r=I(n);ue(()=>{let a=0;if(t){const o=new ResizeObserver(()=>{cancelAnimationFrame(a),a=window.requestAnimationFrame(r)});return o.observe(t),()=>{window.cancelAnimationFrame(a),o.unobserve(t)}}},[t,r])}var Ft=Fe,Lt=Ue,Ut=ze;function De({className:t,children:n,...r}){return e.jsxs(Ft,{"data-slot":"scroll-area",className:Re("relative",t),...r,children:[e.jsx(Lt,{"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1",children:n}),e.jsx(Ot,{}),e.jsx(Ut,{})]})}function Ot({className:t,orientation:n="vertical",...r}){return e.jsx(Oe,{"data-slot":"scroll-area-scrollbar",orientation:n,className:Re("flex touch-none p-px transition-colors select-none",n==="vertical"&&"h-full w-2.5 border-l border-l-transparent",n==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent",t),...r,children:e.jsx(We,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"})})}function fr({open:t,onOpenChange:n,defenseRequest:r,coordinatorId:a,coordinatorName:o="Coordinator",onEndorseComplete:l}){const[c,d]=s.useState("preview"),[i,u]=s.useState(null),[h,p]=s.useState(null),[f,g]=s.useState(!1),[b,j]=s.useState(!1),[R,T]=s.useState([]),[F,Y]=s.useState(null),[X,O]=s.useState(!1),[k,L]=s.useState(!1),[M,S]=s.useState(!1),N=s.useRef(null),[C,K]=s.useState(null),[pe,ge]=s.useState(!1),[Be,J]=s.useState(!1),xe=s.useRef(null),[ve,Ye]=s.useState([]),[Q,be]=s.useState(null);function H(){var m;return((m=document.querySelector('meta[name="csrf-token"]'))==null?void 0:m.content)||""}s.useEffect(()=>{t?(Ve(),ne()):(i&&i.startsWith("blob:")&&window.URL.revokeObjectURL(i),u(null),p(null),d("preview"),K(null),J(!1))},[t]),s.useEffect(()=>{t&&ve.length>0&&Q&&!i&&!f&&we()},[t,ve,Q]);async function Ve(){var m;try{const x=await fetch("/api/document-templates");if(x.ok){const w=await x.json();Ye(w);const y=((m=r==null?void 0:r.defense_type)==null?void 0:m.toLowerCase())||"",P=w.find(U=>{const D=U.name.toLowerCase();return y.includes("prefinal")||y.includes("pre-final")?D.includes("prefinal")||D.includes("pre-final"):y.includes("final")?D.includes("final")&&!D.includes("prefinal"):!1});P?be(P):w.length>0&&be(w[0])}}catch(x){console.error("Failed to load templates:",x)}}async function ne(){O(!0);try{const m=await fetch("/api/signatures");if(m.ok){const x=await m.json();T(x);const w=x.find(y=>y.active);Y(w||null)}}catch(m){console.error("Failed to load signatures:",m)}finally{O(!1)}}async function we(){if(!Q){v.error("No template selected");return}if(!(r!=null&&r.id)){v.error("Invalid defense request");return}g(!0);try{const m=await fetch("/api/generate-document",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/pdf","X-CSRF-TOKEN":H()},body:JSON.stringify({template_id:Q.id,defense_request_id:r.id,fields:{}})});if(!m.ok){v.error("Failed to generate document"),g(!1);return}const x=await m.blob(),w=window.URL.createObjectURL(x);u(w),v.success('Endorsement form generated successfully! Review and click "Endorse" to submit.')}catch(m){console.error("Generate error:",m),v.error("Failed to generate endorsement form")}finally{g(!1)}}async function Ge(){if(!N.current)return;const m=N.current.getCanvas(),x=m.toDataURL("image/png");S(!0);try{(await fetch("/api/signatures",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":H()},body:JSON.stringify({image_base64:x,label:"Drawn Signature",natural_width:m.width,natural_height:m.height})})).ok?(v.success("Signature saved successfully!"),L(!1),ne()):v.error("Failed to save signature")}catch(w){console.error("Save signature error:",w),v.error("Failed to save signature")}finally{S(!1)}}async function Ke(m){try{(await fetch(`/api/signatures/${m}/activate`,{method:"PATCH",headers:{"X-CSRF-TOKEN":H()}})).ok?(v.success("Signature activated!"),ne()):v.error("Failed to activate signature")}catch(x){console.error("Activate signature error:",x),v.error("Failed to activate signature")}}async function Je(m){var w;const x=(w=m.target.files)==null?void 0:w[0];if(x){if(!x.type.includes("pdf")){v.error("Please upload a PDF file");return}K(x),v.success('File selected. Click "Use This File" to continue.')}}function Qe(m){m.preventDefault(),J(!0)}function Ze(m){m.preventDefault(),J(!1)}function qe(m){var w;m.preventDefault(),J(!1);const x=(w=m.dataTransfer.files)==null?void 0:w[0];if(x){if(!x.type.includes("pdf")){v.error("Please upload a PDF file");return}K(x),v.success('File selected. Click "Use This File" to continue.')}}async function et(){if(!(!C||!(r!=null&&r.id))){ge(!0);try{const m=new Blob([C],{type:"application/pdf"}),x=window.URL.createObjectURL(m);u(x),v.success('Endorsement form uploaded successfully! Review and click "Endorse" to submit.'),d("preview")}catch(m){console.error("Upload error:",m),v.error("Failed to upload endorsement form")}finally{ge(!1)}}}async function tt(){if(!i){v.error("Please generate or upload an endorsement form first");return}if(!F){v.error("Please set an active signature first");return}j(!0);try{console.log("🚀 Starting endorsement process...");let m=!1;if(C){console.log("📤 Uploading user-selected file:",C.name);const y=new FormData;y.append("endorsement_form",C);const P=await fetch(`/api/defense-requests/${r.id}/upload-endorsement`,{method:"POST",headers:{"X-CSRF-TOKEN":H(),Accept:"application/json"},body:y});if(console.log("📥 Upload response status:",P.status),P.ok){const U=await P.json();console.log("✅ Upload successful:",U),m=!0}else{const U=await P.text();console.error("❌ Upload failed:",P.status,U),v.error("Failed to save endorsement form: "+P.statusText),j(!1);return}}else if(i){console.log("📤 Uploading generated PDF blob...");try{const P=await(await fetch(i)).blob();console.log("📦 Blob created:",P.type,P.size,"bytes");const U=new FormData;U.append("endorsement_form",P,"endorsement-form.pdf");const D=await fetch(`/api/defense-requests/${r.id}/upload-endorsement`,{method:"POST",headers:{"X-CSRF-TOKEN":H(),Accept:"application/json"},body:U});if(console.log("📥 Upload response status:",D.status),D.ok){const oe=await D.json();console.log("✅ Upload successful:",oe),m=!0}else{const oe=await D.text();console.error("❌ Upload failed:",D.status,oe),v.error("Failed to save endorsement form: "+D.statusText),j(!1);return}}catch(y){console.error("❌ Error saving generated PDF:",y),v.error("Failed to save endorsement form"),j(!1);return}}if(!m){console.error("❌ No endorsement form was saved"),v.error("Failed to save endorsement form"),j(!1);return}console.log("✅ Endorsement form saved successfully, updating adviser status...");const x={adviser_status:"Approved"};a&&(x.coordinator_user_id=a),console.log("📤 Updating adviser status with payload:",x);const w=await fetch(`/adviser/defense-requirements/${r.id}/adviser-status`,{method:"PATCH",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":H()},body:JSON.stringify(x)});if(console.log("📥 Adviser status update response:",w.status),w.ok){const y=await w.json();console.log("✅ Endorsement successful:",y),l&&await l(),n(!1),v.success(`Request endorsed successfully and forwarded to ${o}!`)}else{const y=await w.json();console.error("❌ Adviser status update failed:",y),v.error(y.message||"Failed to endorse request")}}catch(m){console.error("❌ Endorse error:",m),v.error("Failed to endorse request")}finally{j(!1)}}function Se(){if(N.current){const m=N.current.getCanvas(),x=m.getContext("2d");if(x){const y=m.height-80;x.save(),x.strokeStyle="#d1d5db",x.lineWidth=1,x.beginPath(),x.moveTo(40,y),x.lineTo(m.width-40,y),x.stroke(),x.restore()}}}return e.jsxs(e.Fragment,{children:[e.jsx(je,{open:t,onOpenChange:n,children:e.jsx(ye,{className:"max-w-full w-[90vw] h-[90vh] p-0 gap-0 flex flex-col overflow-hidden",children:e.jsxs("div",{className:"flex flex-1 min-h-0",children:[e.jsxs("div",{className:"w-72 border-r bg-muted/30 flex flex-col shrink-0",children:[e.jsx("div",{className:"p-6 pb-4 shrink-0",children:e.jsxs(Ne,{children:[e.jsx(Ce,{className:"text-lg",children:"Endorse Request"}),e.jsx(Pe,{className:"text-xs mt-2",children:"Review and endorse the defense request"})]})}),e.jsx(se,{}),e.jsx(De,{className:"flex-1 min-h-0",children:e.jsxs("div",{className:"px-6 py-4 space-y-6",children:[e.jsxs("nav",{className:"space-y-1",children:[e.jsxs(E,{variant:c==="preview"?"secondary":"ghost",className:"w-full justify-start",onClick:()=>d("preview"),children:[e.jsx(ot,{className:"mr-2 h-4 w-4"}),"Preview"]}),e.jsxs(E,{variant:c==="signature"?"secondary":"ghost",className:"w-full justify-start",onClick:()=>d("signature"),children:[e.jsx(st,{className:"mr-2 h-4 w-4"}),"Signature"]}),e.jsxs(E,{variant:c==="upload"?"secondary":"ghost",className:"w-full justify-start",onClick:()=>d("upload"),children:[e.jsx(Te,{className:"mr-2 h-4 w-4"}),"Upload File"]})]}),e.jsx(se,{}),e.jsxs("div",{className:"space-y-2 text-xs",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-muted-foreground",children:"Student"}),e.jsxs("div",{className:"font-semibold",children:[r==null?void 0:r.first_name," ",r==null?void 0:r.last_name]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-muted-foreground",children:"Defense Type"}),e.jsx("div",{className:"font-semibold",children:r==null?void 0:r.defense_type})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-muted-foreground",children:"Coordinator"}),e.jsx("div",{className:"font-semibold",children:o})]})]})]})}),e.jsx(se,{}),e.jsx("div",{className:"p-6 pt-4 shrink-0",children:e.jsx(E,{className:"w-full",size:"lg",disabled:!i||!F||b,onClick:tt,children:b?e.jsxs(e.Fragment,{children:[e.jsx($,{className:"mr-2 h-4 w-4 animate-spin"}),"Endorsing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(lt,{className:"mr-2 h-4 w-4"}),"Endorse to Coordinator"]})})})]}),e.jsx("div",{className:"flex-1 flex flex-col min-w-0 overflow-hidden",children:e.jsx(De,{className:"flex-1",children:e.jsxs("div",{className:"p-8 max-w-5xl mx-auto",children:[f&&e.jsxs("div",{className:"flex flex-col items-center justify-center h-[600px] space-y-4",children:[e.jsx($,{className:"h-12 w-12 animate-spin text-primary"}),e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Generating Document..."}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Please wait while we prepare your endorsement form"})]})]}),!f&&c==="preview"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Document Preview"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Review the generated endorsement form"})]}),i&&e.jsxs(E,{variant:"outline",size:"sm",onClick:()=>{i.startsWith("blob:")&&window.URL.revokeObjectURL(i),u(null),we()},disabled:f,children:[e.jsx($,{className:`mr-2 h-4 w-4 ${f?"animate-spin":""}`}),"Regenerate"]})]}),i?e.jsx("div",{className:"border rounded-lg overflow-hidden",style:{height:"700px"},children:e.jsx("iframe",{src:i,className:"w-full h-full",title:"Document Preview"})}):e.jsxs(ae,{children:[e.jsx(ce,{className:"h-4 w-4"}),e.jsx(le,{children:"Document is being generated automatically. Please wait..."})]})]}),c==="signature"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Manage Signature"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"View, draw, or upload your signature"})]}),F&&e.jsxs("div",{className:"border rounded-lg p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(ie,{className:"text-sm font-medium",children:"Active Signature"}),e.jsx(de,{className:"h-4 w-4 text-green-600"})]}),e.jsx("div",{className:"bg-muted/50 rounded-lg p-4 flex items-center justify-center",children:e.jsx("img",{src:`/storage/${F.image_path}`,alt:"Active signature",className:"max-h-24 object-contain"})})]}),e.jsxs("div",{className:"border rounded-lg p-4 space-y-3",children:[e.jsx(ie,{className:"text-sm font-medium",children:"Draw New Signature"}),e.jsxs(E,{variant:"outline",className:"w-full",onClick:()=>L(!0),children:[e.jsx(it,{className:"mr-2 h-4 w-4"}),"Draw Signature"]})]}),e.jsxs("div",{className:"border rounded-lg p-4 space-y-3",children:[e.jsx(ie,{className:"text-sm font-medium",children:"All Signatures"}),X?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx($,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):R.length>0?e.jsx("div",{className:"grid grid-cols-2 gap-3",children:R.map(m=>e.jsxs("div",{className:`border rounded-lg p-3 space-y-2 ${m.active?"ring-2 ring-primary":""}`,children:[e.jsx("div",{className:"bg-muted/50 rounded p-2 flex items-center justify-center min-h-[60px]",children:e.jsx("img",{src:`/storage/${m.image_path}`,alt:"Signature",className:"max-h-12 object-contain"})}),e.jsx(E,{variant:m.active?"secondary":"outline",size:"sm",className:"w-full",onClick:()=>Ke(m.id),disabled:m.active,children:m.active?"Active":"Set Active"})]},m.id))}):e.jsxs(ae,{children:[e.jsx(ce,{className:"h-4 w-4"}),e.jsx(le,{children:"No signatures found. Draw one to get started."})]})]})]}),c==="upload"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Upload Custom File"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Upload your own endorsement form PDF"})]}),e.jsxs(ae,{children:[e.jsx(ce,{className:"h-4 w-4"}),e.jsx(le,{children:"If you prefer to use your own endorsement form, you can upload it here instead of generating one."})]}),e.jsxs("div",{className:`border-2 border-dashed rounded-lg p-12 text-center space-y-4 transition-colors ${Be?"border-primary bg-primary/5":"border-muted-foreground/25"}`,onDragOver:Qe,onDragLeave:Ze,onDrop:qe,children:[e.jsx(Te,{className:"h-16 w-16 mx-auto text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-base font-medium",children:C?C.name:"Drag and drop your PDF here"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"or click to browse"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"PDF files only, max 10MB"})]}),e.jsx("input",{ref:xe,type:"file",accept:".pdf",onChange:Je,className:"hidden"}),e.jsxs(E,{variant:"outline",size:"lg",onClick:()=>{var m;return(m=xe.current)==null?void 0:m.click()},children:[e.jsx(ct,{className:"mr-2 h-4 w-4"}),"Choose File"]})]}),C&&e.jsx(E,{size:"lg",className:"w-full",onClick:et,disabled:pe,children:pe?e.jsxs(e.Fragment,{children:[e.jsx($,{className:"mr-2 h-4 w-4 animate-spin"}),"Uploading..."]}):e.jsxs(e.Fragment,{children:[e.jsx(de,{className:"mr-2 h-4 w-4"}),"Use This File"]})})]})]})})})]})})}),e.jsx(je,{open:k,onOpenChange:L,children:e.jsxs(ye,{className:"max-w-4xl",children:[e.jsxs(Ne,{children:[e.jsx(Ce,{children:"Draw Your Signature"}),e.jsx(Pe,{children:"Draw your signature below. This will replace any existing signatures."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"border rounded-lg p-4 bg-muted/30",children:e.jsx(nt,{ref:N,penColor:"black",backgroundColor:"rgba(0,0,0,0)",minWidth:2,maxWidth:4,velocityFilterWeight:.7,canvasProps:{width:690,height:300,className:"border border-border rounded bg-background w-full",style:{cursor:"crosshair"}},onEnd:Se})}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsxs(E,{variant:"outline",onClick:()=>{var m;(m=N.current)==null||m.clear(),Se()},children:[e.jsx(dt,{className:"mr-2 h-4 w-4"}),"Clear"]}),e.jsx(E,{variant:"outline",onClick:()=>L(!1),children:"Cancel"}),e.jsx(E,{onClick:Ge,disabled:M,children:M?e.jsxs(e.Fragment,{children:[e.jsx($,{className:"mr-2 h-4 w-4 animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(de,{className:"mr-2 h-4 w-4"}),"Save Signature"]})})]})]})]})})]})}export{fr as default};
