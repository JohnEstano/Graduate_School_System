import{K as E,r as o,j as e,L as P,a as R}from"./app-OOvd0qGy.js";import{A as U,a as B}from"./avatar-DboJvblb.js";import{B as S}from"./button-Bvl2ELDv.js";import{A as z}from"./app-layout-4BSfGYAy.js";import{S as $}from"./layout-PRKQfSf1.js";import{A as D,a as K,b as T}from"./alert-D5RZvq8L.js";import{I as k}from"./input-CzcDJDbH.js";import{t as l}from"./index-imi9ZEDw.js";import{I as q}from"./info-CIHMpyv0.js";import"./index-kQq3evoo.js";import"./index-B9sjBiRz.js";import"./index-DQ9rqnvl.js";import"./utils-jAU0Cazi.js";import"./index-ChOW5_O6.js";import"./index-DZZQifJx.js";import"./index-B2wwfcIF.js";import"./index-4w5oLsoB.js";import"./x-DrNmi13E.js";import"./createLucideIcon-Cvkj7Hkp.js";import"./tooltip-BFmjF_jJ.js";import"./floating-ui.react-dom-BrG2AUyT.js";import"./separator-Cye1ujSm.js";import"./chevron-right-BsU_TN8l.js";import"./dropdown-menu-JMbXV8S0.js";import"./index-DcZRhvrv.js";import"./index-C9drr0Qb.js";import"./index-CQ9en90x.js";import"./index-C7ezi2Q7.js";import"./settings-BGemkvqC.js";import"./graduation-cap-CCWiuwHf.js";import"./file-text-DLuaZQHd.js";import"./dollar-sign-4LNVBfuJ.js";import"./users-EStqJIUY.js";import"./credit-card-Bfq-rBsk.js";import"./tabs-BvigrSxv.js";import"./badge-9siNCstt.js";import"./circle-check-big-Ddw5Ycw8.js";import"./sun-Ch86N1Y-.js";const G=[{title:"Profile settings",href:"/settings/profile"}];function H(i){var t,d,a,x;const h=((d=(t=i.first_name)==null?void 0:t.trim())==null?void 0:d[0])??"",u=((x=(a=i.last_name)==null?void 0:a.trim())==null?void 0:x[0])??"";return(h+u).toUpperCase()||"U"}function J(i){return i.display_name??i.name??[i.first_name,i.middle_name?`${i.middle_name[0].toUpperCase()}.`:"",i.last_name].filter(Boolean).join(" ")}function Ie({mustVerifyEmail:i,status:h}){const{auth:u}=E().props,t=u.user,d=Array.isArray(t.advisers)?t.advisers[0]??null:null,[a,x]=o.useState(t.adviser_code??""),[g,j]=o.useState(!1),[N,b]=o.useState(""),[p,y]=o.useState(""),[_,A]=o.useState(!1),[C,w]=o.useState(""),[v,I]=o.useState(()=>{const s=Array.isArray(t.coordinators)?t.coordinators:[];if(s.length>0){const r=s[0];return{name:r.name||[r.first_name,r.middle_name?`${r.middle_name[0]}.`:"",r.last_name].filter(Boolean).join(" "),email:r.email}}return null}),L=async()=>{var r,m,c;A(!0),w("");const s=l.loading("Registering coordinator...");try{const f=await R.post("/api/adviser/register-with-coordinator-code",{coordinator_code:p});if(l.success("Coordinator registered successfully!",{id:s}),(r=f.data)!=null&&r.coordinator){const n=f.data.coordinator;I({name:n.name||[n.first_name,n.middle_name?`${n.middle_name[0]}.`:"",n.last_name].filter(Boolean).join(" "),email:n.email}),y("")}}catch(f){l.dismiss(s),w(((c=(m=f.response)==null?void 0:m.data)==null?void 0:c.error)||"Registration failed.")}finally{A(!1)}},F=async()=>{var r,m;j(!0),b("");const s=l.loading("Registering adviser...");try{const c=await R.post("/api/adviser/register-with-code",{adviser_code:a});l.success("Adviser registered successfully!",{id:s}),window.location.reload()}catch(c){l.dismiss(s),b(((m=(r=c.response)==null?void 0:r.data)==null?void 0:m.error)||"Registration failed.")}finally{j(!1)}};return e.jsxs(z,{breadcrumbs:G,children:[e.jsx(P,{title:"Profile settings"}),e.jsx($,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs(D,{className:"bg-rose-50 dark:bg-rose-950 border-rose-200 dark:border-rose-900 text-rose-900 dark:text-rose-100 flex items-start gap-3 px-6 py-5 rounded-xl",children:[e.jsx(q,{className:"h-5 w-5 text-rose-500 dark:text-rose-400 mt-1 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx(K,{className:"font-semibold mb-1",children:"Notice"}),e.jsx(T,{children:"Account details and information are fetched directly from the official myUIC portal database. Use the official myUIC portal if you wish to change any of the user information."})]})]}),e.jsxs("div",{className:"flex flex-row items-center gap-6 mb-8",children:[e.jsx(U,{className:"h-20 w-20",children:e.jsx(B,{className:"text-3xl font-bold bg-zinc-200 dark:bg-zinc-800 text-zinc-700 dark:text-zinc-200",children:H(t)})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-semibold",children:J(t)}),e.jsx("div",{className:"text-muted-foreground text-sm",children:t.email})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-12 gap-y-6 mt-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"First Name"}),e.jsx("div",{className:"font-medium text-base",children:t.first_name})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"Last Name"}),e.jsx("div",{className:"font-medium text-base",children:t.last_name})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"School ID"}),e.jsx("div",{className:"font-medium text-base",children:t.school_id??"—"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"Role"}),e.jsx("div",{className:"font-medium text-base",children:t.role??"—"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"Email"}),e.jsx("div",{className:"font-medium text-base",children:t.email??"—"})]}),t.program&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"Program"}),e.jsx("div",{className:"font-medium text-base",children:t.program})]}),t.role==="Student"&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"Adviser"}),d?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"font-medium text-base",children:d.name}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:d.email})]}):e.jsxs("div",{className:"flex flex-row gap-2 mt-2 items-center",children:[e.jsx(k,{type:"text",placeholder:"Paste adviser code here",value:typeof a=="string"?a:"",onChange:s=>x(s.target.value),disabled:g,className:"w-48"}),e.jsx(S,{onClick:F,disabled:g||!a,variant:"default",className:"px-4",children:"Register Adviser"}),N&&e.jsx("div",{className:"text-xs text-rose-500 mt-1",children:N})]})]}),(t.role==="Adviser"||t.role==="Faculty")&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"Adviser Code"}),e.jsx("div",{className:" font-medium text-base",children:a?String(a):"—"}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Share this code with your students so they can register you as their adviser."})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"Coordinator"}),v?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"font-medium text-base",children:v.name}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:v.email})]}):e.jsxs("div",{className:"flex flex-row gap-2 mt-2 items-center",children:[e.jsx(k,{type:"text",placeholder:"Paste coordinator code here",value:p,onChange:s=>y(s.target.value),disabled:_,className:"w-48"}),e.jsx(S,{onClick:L,disabled:_||!p,variant:"default",className:"px-4",children:"Register Coordinator"}),C&&e.jsx("div",{className:"text-xs text-rose-500 mt-1",children:C})]})]})]})]}),i&&t.email_verified_at===null&&e.jsx("div",{className:"mt-6",children:h==="verification-link-sent"&&e.jsx("div",{className:"mt-2 text-sm font-medium text-green-600",children:"A new verification link has been sent to your email address."})}),e.jsx("div",{className:"h-24"})]})})]})}export{Ie as default};
