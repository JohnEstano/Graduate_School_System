import{K as T,r,j as e,$ as W,R as q}from"./app-BDkuJsct.js";import _ from"./defense-status-widget-CPGNSfO6.js";import L from"./weekly-defense-schedule-widget-tElMdAaa.js";import U from"./quick-actions-widget-Dik1XIA1.js";import F from"./exam-eligibility-widget-BT6jR99r.js";import{C as $}from"./card-BJFJPDio.js";import{C as I}from"./clipboard-list-DFItBkgn.js";import{C as M}from"./calendar-days-Dp2eL-bU.js";import{U as P}from"./users-BTr8E8QO.js";import{U as H}from"./user-plus-Cc8-99X-.js";import{S as B,M as G}from"./sun-B3PIUh1_.js";import{C as K}from"./circle-alert-BxXeSR-n.js";import"./graduation-cap-Cszrlop1.js";import"./createLucideIcon-CEmaZ7tj.js";import"./chevron-right-BpKiIXqV.js";import"./hourglass-BE6hGw0v.js";import"./x-CtfT_1vN.js";import"./check-BUlQxyEc.js";import"./calendar-CI-DWPmu.js";import"./skeleton-C1N4Z9e5.js";import"./utils-jAU0Cazi.js";import"./format-Cze4Gw5q.js";import"./parseISO-Bx-IO3P2.js";import"./isSameDay-DsAL-Hdb.js";import"./tooltip-CWM4FSMS.js";import"./index-BhbofC_p.js";import"./index-B_a1aFVM.js";import"./floating-ui.react-dom-w0Q93DA2.js";import"./user-round-BfbMCXUO.js";import"./settings-BITCJcnj.js";import"./badge-dollar-sign-Ck-V3fgX.js";import"./book-open-D0xLe0hN.js";import"./receipt-YZTtq_ps.js";function Q(){return new Date().toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"})}function Y(){const s=new Date().getHours();return s>=6&&s<18}function J(s){if(!(s!=null&&s.advisers)||!Array.isArray(s.advisers)||s.advisers.length===0)return null;const t=s.advisers[0];return{name:t.name||[t.first_name,t.middle_name?`${t.middle_name[0].toUpperCase()}.`:"",t.last_name].filter(Boolean).join(" "),email:t.email}}function $e(){var b,v;const s=T().props,{auth:{user:t},defenseRequirement:y,defenseRequest:O}=s,m=s.defenseRequests??[],[g,f]=r.useState([]),[V,X]=r.useState([]),[w,Z]=r.useState([]),[c,h]=r.useState(!0),[ee,te]=r.useState(!0),[k,N]=r.useState(!0),[S,z]=r.useState(new Date().getDay()),D=[{label:"Sun",value:0},{label:"Mon",value:1},{label:"Tue",value:2},{label:"Wed",value:3},{label:"Thu",value:4},{label:"Fri",value:5},{label:"Sat",value:6}];r.useEffect(()=>{const a=l=>{let i=l.filter(n=>{const d=n.submitted_by;return d===(t==null?void 0:t.id)||d===String(t==null?void 0:t.id)});i.length===0&&(i=l);const p=[...i].sort((n,d)=>{const A=n.created_at?new Date(n.created_at).getTime():0;return(d.created_at?new Date(d.created_at).getTime():0)-A});f(p)};(async()=>{h(!0);try{const l=await fetch("/defense-request",{headers:{Accept:"application/json"}});if(!l.ok)throw new Error("bad");const i=await l.json(),p=Array.isArray(i)?i:i.defenseRequests??[];a(p)}catch{f([])}finally{h(!1)}})()},[t==null?void 0:t.id]);const u=m&&m.length>0?m:g;(b=s.recentPayment)==null||b.amount;const x=J(t),R=[{title:"Defense Submissions",value:g.length,description:"Total defense requests submitted",icon:e.jsx(I,{}),iconTheme:"bg-rose-100 text-rose-600 dark:bg-rose-900 dark:text-rose-300"},{title:"Today's Schedules",value:w.length,description:"Events scheduled for today",icon:e.jsx(M,{}),iconTheme:"bg-blue-100 text-blue-600 dark:bg-blue-900 dark:text-blue-300"},{title:"Exam Eligibility",value:e.jsx(F,{simple:!0}),description:"Check if you are eligible for exams",icon:e.jsx(P,{}),iconTheme:"bg-green-100 text-green-600 dark:bg-green-900 dark:text-green-300"},{title:"Adviser",value:x?e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-sm truncate",children:x.name}),e.jsx("div",{className:"text-xs text-gray-400 dark:text-gray-500",children:x.email})]}):e.jsx("span",{className:"text-xs text-gray-400 dark:text-gray-500",children:"No adviser assigned"}),description:"",icon:e.jsx(H,{}),iconTheme:"bg-yellow-100 text-yellow-600 dark:bg-yellow-900 dark:text-yellow-300"}],[o,se]=r.useState(null),[ae,C]=r.useState(!1),[re,E]=r.useState(!0);return r.useEffect(()=>{if(!o)return;const a=()=>{C(o.scrollLeft>0),E(o.scrollLeft+o.clientWidth<o.scrollWidth-5)};return o.addEventListener("scroll",a),a(),()=>o.removeEventListener("scroll",a)},[o]),e.jsx("div",{className:"flex h-full flex-1 flex-col gap-4 overflow-auto bg-white dark:bg-background",children:c?e.jsxs("div",{className:"w-full min-h-[70vh] bg-zinc-100 dark:bg-zinc-900 flex flex-col gap-4 p-0 m-0",children:[e.jsx("div",{className:"h-6 w-1/6 rounded bg-zinc-300 dark:bg-zinc-800 mt-8 mx-8"}),e.jsx("div",{className:"h-12 w-3/4 rounded bg-zinc-300 dark:bg-zinc-800 mx-8"}),e.jsx("div",{className:"h-12 w-2/3 rounded bg-zinc-300 dark:bg-zinc-800 mx-8"}),e.jsx("div",{className:"h-[500px] w-full rounded bg-zinc-300 dark:bg-zinc-800 mt-4"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-4 md:mb-6 mt-4 md:mt-5 px-4 md:px-7",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center gap-4 md:gap-0 relative overflow-hidden",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("span",{className:"flex items-center text-xs font-semibold text-gray-700 dark:text-gray-200 mb-1 md:mb-2 relative z-10",children:[Y()?e.jsx(B,{className:"mr-1 size-3 md:size-4 text-rose-500"}):e.jsx(G,{className:"mr-1 size-3 md:size-4 text-rose-500"}),Q()]}),e.jsxs("h1",{className:"text-xl md:text-2xl lg:text-3xl font-extrabold text-gray-900 dark:text-white relative z-10",children:["Hi, ",t==null?void 0:t.name,"!"]}),e.jsxs("span",{className:"text-xs text-zinc-500 font-extrabold mt-2 md:mt-3 relative z-10",children:[(t==null?void 0:t.role)??"Student",(t==null?void 0:t.school_id)&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mx-1",children:"/"}),e.jsx("span",{className:"font-bold",children:t.school_id})]})]})]}),e.jsxs("div",{className:"hidden md:flex items-center",children:[e.jsx("div",{className:"h-12 w-px mx-4 bg-gray-300 dark:bg-gray-700 opacity-60"}),e.jsx("div",{className:"mr-8",children:e.jsx(U,{userRole:t==null?void 0:t.role})})]})]})}),((v=t==null?void 0:t.advisers)==null?void 0:v.length)===0&&k&&e.jsx("div",{className:"mx-4 md:mx-7 my-3",children:e.jsxs("div",{className:"bg-rose-50 dark:bg-rose-950 border border-rose-200 dark:border-rose-900 text-rose-900 dark:text-rose-100 flex items-start gap-2 md:gap-3 px-4 md:px-6 py-4 md:py-5 rounded-xl relative",children:[e.jsx(K,{className:"h-4 w-4 md:h-5 md:w-5 text-rose-500 dark:text-rose-400 mt-0.5 md:mt-1 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 pr-6",children:[e.jsx("span",{className:"font-semibold text-sm md:text-base mb-1 block",children:"You are not registered to an adviser yet."}),e.jsxs("span",{className:"text-xs md:text-sm",children:["Contact your coordinator for assistance.",e.jsx(W,{href:"/settings/profile",className:"ml-2 underline text-rose-600 dark:text-rose-300 font-medium hover:text-rose-700 dark:hover:text-rose-200",children:"Go to Settings"})]})]}),e.jsx("button",{onClick:()=>N(!1),className:"absolute top-2 right-2 md:top-3 md:right-4 px-1.5 md:px-2 py-0.5 md:py-1 text-sm md:text-base rounded hover:bg-rose-100 dark:hover:bg-rose-900 text-rose-600 dark:text-rose-200","aria-label":"Close",children:"âœ•"})]})}),e.jsx("div",{className:"w-full max-w-screen-xl mx-0 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 md:gap-4 px-4 md:px-7 mb-4 md:mb-6 justify-start",children:R.map((a,j)=>{var l;return e.jsxs($,{className:"col-span-1 rounded-lg md:rounded-xl border border-gray-200 dark:border-zinc-800 bg-white dark:bg-zinc-900 shadow-sm flex flex-col justify-between p-0 min-h-0 h-auto transition hover:shadow-md",style:{minWidth:0},children:[e.jsxs("div",{className:"flex items-center justify-between px-4 md:px-5 pt-3 md:pt-4 pb-0",children:[e.jsx("div",{className:"text-xs md:text-sm font-extrabold text-gray-800 dark:text-zinc-100 leading-tight",children:a.title}),e.jsx("div",{className:`rounded-full p-1 md:p-1.5 flex items-center justify-center flex-shrink-0 ${a.iconTheme}`,children:q.cloneElement(a.icon,{className:"size-3 md:size-4 font-extrabold "+(((l=a.iconTheme)==null?void 0:l.split(" ").find(i=>i.startsWith("text-")))??"")})})]}),e.jsxs("div",{className:"flex flex-col px-4 md:px-5 pb-3 md:pb-4 pt-1 md:pt-2",children:[e.jsx("span",{className:"text-xl md:text-2xl font-bold text-gray-900 dark:text-white leading-none",children:a.value}),e.jsx("span",{className:"text-xs text-gray-400 dark:text-gray-500 mt-1 truncate",children:a.description})]})]},j)})}),e.jsxs("div",{className:"flex flex-col gap-4 md:gap-6 bg-gray-100 dark:bg-muted mx-2 md:mx-4 rounded-lg md:rounded-xl mt-2 mb-2 px-3 md:px-5 py-4 md:py-8",children:[e.jsxs("div",{className:"w-full mb-2 flex flex-col lg:flex-row gap-4",children:[e.jsx(L,{weekDays:D,selectedDay:S,setSelectedDay:z,approvedDefenses:u,referenceDate:new Date,loading:c,studentId:t==null?void 0:t.id}),e.jsx(_,{recentRequests:u,loading:c})]}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2"})]})]})})}export{$e as default};
