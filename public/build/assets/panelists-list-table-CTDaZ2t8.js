import{r as i,j as e,a as A}from"./app-CQngmq00.js";import{T as te,a as ne,b as w,c as h,d as ie,e as o}from"./table-BEEQP98I.js";import{C as O}from"./checkbox-D0LzfNbG.js";import{B as c}from"./button-Cw9tQIeO.js";import{D as I,a as $,e as E,b as V,f as M}from"./dialog-D-tH9FDm.js";import{T as le,a as ae,b as B,c as F}from"./tabs-DJOYkXMD.js";import{U as re}from"./users-DZ67WViD.js";import{P as ce}from"./pencil-DZXKP1_R.js";import{T as oe}from"./trash-2-BOv4JxAD.js";import{U as de}from"./user-BhdOBJYb.js";import{M as me}from"./mail-AVeYXekB.js";import{M as xe}from"./message-circle-fdLXSFOs.js";import{R as he}from"./refresh-cw-CxrNwiuK.js";import{L as pe}from"./loader-circle-CWzTCUKj.js";import"./utils-jAU0Cazi.js";import"./index-ahz1tZ6M.js";import"./index-DRp-GX9j.js";import"./index-VBHUZLOo.js";import"./index-CgLqTVh4.js";import"./index-BJk2QW0A.js";import"./index-Csh4Fj4k.js";import"./check-BEGkAg7k.js";import"./createLucideIcon-pjYyoixj.js";import"./index-CDDLQrUy.js";import"./index-DZZQifJx.js";import"./index-BSk2xfhC.js";import"./index-BZgaE142.js";import"./x-B3RMhnUQ.js";function Ge({panelists:p,paymentRates:G,onEdit:H,onDelete:P,selected:d,setSelected:C,loading:a=!1}){const W=p.map(s=>s.id),q=s=>C(s?W:[]),J=(s,n)=>C(n?[...d,s]:d.filter(l=>l!==s)),[K,f]=i.useState(!1),[z,T]=i.useState(null),Q=s=>{T(s),f(!0)},D=()=>{f(!1),T(null)},X=()=>{z!==null&&(P(z),D())},[g,j]=i.useState(!1),[t,b]=i.useState(null),[r,N]=i.useState([]),[y,L]=i.useState(!1),[Y,S]=i.useState("assignments"),[m,v]=i.useState([]),Z=s=>{b(s),N(s.assignments??[]),S("assignments"),j(!0),A.get(`/api/coordinator/panelists/${s.id}/pending`).then(n=>v(n.data)).catch(()=>v([]))},ee=async()=>{if(t){L(!0);try{const n=(await A.get(`/api/coordinator/panelists/${t.id}`)).data;N(n.assignments??[]),b(l=>l?{...l,...n}:n)}finally{L(!1)}}};i.useEffect(()=>{g||(b(null),N([]),v([]))},[g]);function u(s){if(!s)return"";const n=String(s).toLowerCase().replace(/[\s-]/g,"");return n.includes("prefinal")?"Prefinal":n.includes("proposal")?"Proposal":n.includes("final")?"Final":s}function se(s,n,l){const x=(s||"").trim().toLowerCase(),R=(n||"").trim().toLowerCase(),_=u(l||"").toLowerCase();if(!x||!R||!_)return null;const U=G.find(k=>String(k.program_level).trim().toLowerCase()===x&&String(k.type).trim().toLowerCase()===R&&u(k.defense_type).toLowerCase()===_);return U?Number(U.amount):null}return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"rounded-md overflow-x-auto border border-border bg-background w-full max-w-full",style:{minWidth:"700px"},children:e.jsxs(te,{className:"w-full text-sm table-fixed",children:[e.jsx(ne,{children:e.jsxs(w,{children:[e.jsx(h,{className:"w-12",children:e.jsx(O,{checked:d.length>0&&d.length===p.length,onCheckedChange:s=>q(!!s),disabled:a})}),e.jsx(h,{className:"px-3 min-w-[120px]",children:"Name"}),e.jsx(h,{className:"px-2 min-w-[120px]",children:"Email"}),e.jsx(h,{className:"px-2 min-w-[80px] text-center",children:"Assigned Defenses"}),e.jsx(h,{className:"text-center px-2",children:"Actions"})]})}),e.jsx(ie,{children:p.length===0?e.jsx(w,{children:e.jsx(o,{colSpan:5,className:"py-8 text-center text-sm text-muted-foreground",children:"No panelists found."})}):p.map(s=>e.jsxs(w,{className:"hover:bg-muted/40 cursor-pointer transition",children:[e.jsx(o,{children:e.jsx(O,{checked:d.includes(s.id),onCheckedChange:n=>J(s.id,!!n),disabled:a})}),e.jsx(o,{className:"px-3 py-2 font-medium truncate leading-tight align-middle",children:s.name}),e.jsx(o,{className:"px-2 py-2 text-xs text-muted-foreground whitespace-nowrap align-middle",children:s.email}),e.jsx(o,{className:"px-2 py-2 text-center align-middle",children:s.assignments?s.assignments.length:0}),e.jsx(o,{className:"px-2 py-2 text-center",children:e.jsxs("div",{className:"flex justify-center gap-2",children:[e.jsx(c,{variant:"outline",size:"icon","aria-label":"View panelist",onClick:()=>Z(s),disabled:a,children:e.jsx(re,{size:18})}),e.jsx(c,{variant:"outline",size:"icon","aria-label":"Edit panelist",onClick:()=>H(s),disabled:a,children:e.jsx(ce,{size:18})}),e.jsx(c,{variant:"outline",size:"icon","aria-label":"Delete panelist",onClick:()=>Q(s.id),disabled:a,children:e.jsx(oe,{size:18})})]})})]},s.id))})]})}),e.jsx(I,{open:g,onOpenChange:s=>j(s),children:e.jsxs($,{className:"max-w-2xl dark:bg-zinc-800",style:{minWidth:"520px",maxWidth:"640px"},children:[e.jsxs(E,{children:[e.jsx(V,{className:"dark:text-zinc-100",children:"Panelist Information"}),e.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[e.jsx("div",{className:"h-12 w-12 flex items-center justify-center rounded-full bg-rose-500/10 border border-rose-500",children:e.jsx(de,{className:"h-7 w-7 text-rose-500"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-sm text-zinc-900 dark:text-zinc-100",children:t==null?void 0:t.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-300",children:t==null?void 0:t.email}),e.jsxs("button",{className:"px-2 py-1 rounded hover:bg-zinc-100 dark:hover:bg-zinc-700 text-zinc-600 dark:text-zinc-300 text-xs flex items-center gap-1 cursor-pointer transition",style:{height:"22px"},title:"Send Gmail",onClick:()=>{t!=null&&t.email&&window.open(`https://mail.google.com/mail/?view=cm&fs=1&to=${encodeURIComponent(t.email)}`,"_blank")},children:[e.jsx(me,{size:14,className:"text-zinc-500 dark:text-zinc-300"}),"Gmail"]}),e.jsxs("button",{className:"px-2 py-1 rounded hover:bg-zinc-100 dark:hover:bg-zinc-700 text-zinc-600 dark:text-zinc-300 text-xs flex items-center gap-1 cursor-pointer transition",style:{height:"22px"},title:"Open Google Chat",onClick:()=>{t!=null&&t.email&&window.open(`https://mail.google.com/chat/u/0/#chat/user/${encodeURIComponent(t.email)}`,"_blank")},children:[e.jsx(xe,{size:14,className:"text-zinc-500 dark:text-zinc-300"}),"Chat"]})]})]})]})]}),e.jsx("div",{className:"mt-4",children:e.jsxs(le,{value:Y,onValueChange:s=>S(s),children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs(ae,{children:[e.jsxs(B,{value:"assignments",children:["Assigned",e.jsx("span",{className:"ml-2 px-2 py-0.5 rounded-full bg-zinc-100 dark:bg-zinc-700 text-zinc-700 dark:text-zinc-100 text-[11px] font-medium",children:(r==null?void 0:r.length)??0})]}),e.jsxs(B,{value:"pending",children:["Pending",e.jsx("span",{className:"ml-2 px-2 py-0.5 rounded-full bg-zinc-100 dark:bg-zinc-700 text-zinc-700 dark:text-zinc-100 text-[11px] font-medium",children:(m==null?void 0:m.length)??0})]})]}),e.jsxs(c,{variant:"outline",size:"sm",className:"ml-2",onClick:ee,disabled:y,title:"Refresh defenses",children:[e.jsx(he,{className:`mr-1 h-4 w-4 ${y?"animate-spin":""}`}),"Refresh"]})]}),e.jsx(F,{value:"assignments",children:e.jsx("div",{className:"overflow-y-auto overflow-x-auto min-w=[400px] rounded bg-white dark:bg-zinc-900 px-2 py-2",style:{height:"240px"},children:y?e.jsxs("div",{className:"text-xs flex items-center justify-center h-full dark:text-zinc-300",children:[e.jsx(pe,{className:"mr-2 h-4 w-4 animate-spin"})," Loading defenses..."]}):((r==null?void 0:r.length)??0)===0?e.jsx("div",{className:"text-gray-500 text-xs flex items-center justify-center h-full dark:text-gray-400",children:"No defenses assigned to this panelist."}):e.jsx("ul",{className:"divide-y",children:r.map(s=>{const n=(s==null?void 0:s.receivable)!=null&&s.receivable!==""?Number(s.receivable):null,l=se(s==null?void 0:s.program_level,(s==null?void 0:s.type)??(s==null?void 0:s.role),s==null?void 0:s.defense_type),x=n??l;return e.jsx("li",{className:"py-3 px-2 flex items-start gap-3 text-sm",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-sm",children:(s==null?void 0:s.thesis_title)??"Untitled Thesis"}),e.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-300 mt-1",children:["Role: ",e.jsx("b",{className:"mx-1",children:(s==null?void 0:s.role)??(t==null?void 0:t.role)??"-"}),"• Type: ",e.jsx("b",{className:"mx-1",children:u(s==null?void 0:s.defense_type)}),"• Receivable: ",e.jsx("b",{className:"mx-1",children:x!=null?`₱${x.toLocaleString()}`:"-"})]})]})},s.id)})})})}),e.jsx(F,{value:"pending",children:e.jsx("div",{className:"overflow-y-auto overflow-x-auto min-w=[400px] rounded bg-white dark:bg-zinc-900 px-2 py-2",style:{height:"240px"},children:m.length===0?e.jsx("div",{className:"text-gray-500 text-xs flex items-center justify-center h-full dark:text-gray-400",children:"No pending defenses for this panelist."}):e.jsx("ul",{className:"divide-y",children:m.map(s=>e.jsx("li",{className:"py-3 px-2 flex items-start gap-3 text-sm",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-sm",children:s.thesis_title??"Untitled Thesis"}),e.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-300 mt-1",children:["Role: ",e.jsx("b",{className:"mx-1",children:s.role??"-"}),"• Type: ",e.jsx("b",{className:"mx-1",children:u(s.defense_type)})]})]})},s.id))})})})]})}),e.jsx(M,{children:e.jsx("div",{className:"flex w-full justify-end gap-2",children:e.jsx(c,{variant:"ghost",onClick:()=>j(!1),children:"Close"})})})]})}),e.jsx(I,{open:K,onOpenChange:f,children:e.jsxs($,{className:"bg-background text-muted-foreground",children:[e.jsx(E,{children:e.jsx(V,{children:"Confirm Delete"})}),e.jsx("div",{className:"text-muted-foreground text-sm",children:"This will delete the panelist. This action cannot be undone."}),e.jsxs(M,{children:[e.jsx(c,{variant:"ghost",onClick:D,disabled:a,children:"Cancel"}),e.jsx(c,{onClick:X,disabled:a,className:"text-white",children:"Delete"})]})]})})]})}export{Ge as default};
