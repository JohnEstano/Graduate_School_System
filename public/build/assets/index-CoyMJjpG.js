import{K as Y,r as a,j as e,L as G,S as j,a as J}from"./app-OOvd0qGy.js";import{A as V}from"./app-layout-4BSfGYAy.js";import{B as n}from"./button-Bvl2ELDv.js";import{I as W}from"./input-CzcDJDbH.js";import Z from"./panelists-list-table-BhmgPO5m.js";import ee from"./panelists-form-modal-INF3aacc.js";import se from"./honorarium-rates-dialog-DkF-GsUs.js";import{T as te,t as l}from"./index-imi9ZEDw.js";import{P as D,a as R,b as T}from"./popover-Bp-FQuXL.js";import{C as O}from"./checkbox-DvV6N4JH.js";import{U as re}from"./users-EStqJIUY.js";import{S as ae}from"./settings-2-DpyFWYVH.js";import{U as ie}from"./user-plus-BV69VFuF.js";import{S as le}from"./search-BBppaIz6.js";import{C as U}from"./circle-plus-DPLF9e0I.js";import{X as B}from"./x-DrNmi13E.js";import{T as ne}from"./trash-2-CnrCBa_Y.js";import{C as oe}from"./circle-check-big-Ddw5Ycw8.js";import{C as ce}from"./circle-x-Cfzvg8iR.js";import"./index-ChOW5_O6.js";import"./index-DZZQifJx.js";import"./utils-jAU0Cazi.js";import"./index-B2wwfcIF.js";import"./index-DQ9rqnvl.js";import"./index-4w5oLsoB.js";import"./tooltip-BFmjF_jJ.js";import"./floating-ui.react-dom-BrG2AUyT.js";import"./createLucideIcon-Cvkj7Hkp.js";import"./separator-Cye1ujSm.js";import"./index-B9sjBiRz.js";import"./chevron-right-BsU_TN8l.js";import"./dropdown-menu-JMbXV8S0.js";import"./index-DcZRhvrv.js";import"./index-kQq3evoo.js";import"./index-C9drr0Qb.js";import"./index-CQ9en90x.js";import"./index-C7ezi2Q7.js";import"./avatar-DboJvblb.js";import"./settings-BGemkvqC.js";import"./graduation-cap-CCWiuwHf.js";import"./file-text-DLuaZQHd.js";import"./dollar-sign-4LNVBfuJ.js";import"./credit-card-Bfq-rBsk.js";import"./tabs-BvigrSxv.js";import"./badge-9siNCstt.js";import"./info-CIHMpyv0.js";import"./sun-Ch86N1Y-.js";import"./table-CmM6ti-o.js";import"./dialog-DgFd6e46.js";import"./label-CWMX11o4.js";import"./index-DnomuSoJ.js";import"./check-CihXD7iu.js";const de=[{title:"Dashboard",href:"/dashboard"},{title:"Panelists",href:"/panelists"}],me=["Chairperson","Panel Member"],pe=["Proposal","Prefinal","Final"];function ms(){const{panelists:N=[],honorariumSpecs:A=[]}=Y().props,[P,u]=a.useState(N),[p,x]=a.useState([]),[M,h]=a.useState(!1),[H,f]=a.useState(null),[b,k]=a.useState(""),[d,m]=a.useState(!1),[v,g]=a.useState(!1),[$,E]=a.useState(!1),[S,y]=a.useState([]),[I,F]=a.useState(!1),[o,C]=a.useState([]),[c,w]=a.useState([]);a.useEffect(()=>{u(N)},[N]),a.useEffect(()=>{y(A)},[A]);const _=a.useMemo(()=>{const s=b.trim().toLowerCase();let r=P;return o.length>0&&(r=r.filter(t=>Array.isArray(t.assignments)&&t.assignments.some(i=>i.role&&o.includes(i.role))||!Array.isArray(t.assignments)&&o.includes(t.role))),c.length>0&&(r=r.filter(t=>{const i=Array.isArray(t.assignments)&&t.assignments.length>0;return c.includes("Assigned")&&i||c.includes("Not Assigned")&&!i})),s&&(r=r.filter(t=>t.name.toLowerCase().includes(s)||t.email.toLowerCase().includes(s)||t.status.toLowerCase().includes(s))),r},[b,P,o,c]);function q(s,r,t){g(!0),r?j.put(`/panelists/${r}`,s,{preserveScroll:!0,onSuccess:i=>{l.success("Panelist updated"),h(!1),f(null),u(Array.isArray(i.props.panelists)?i.props.panelists:[]),g(!1),t&&t()},onError:()=>{l.error("Failed to update panelist"),g(!1),t&&t()}}):j.post("/panelists",s,{preserveScroll:!0,onSuccess:i=>{l.success("Panelist added"),h(!1),f(null),u(Array.isArray(i.props.panelists)?i.props.panelists:[]),g(!1),t&&t()},onError:()=>{l.error("Failed to add panelist"),g(!1),t&&t()}})}function X(s){m(!0),j.delete(`/panelists/${s}`,{preserveScroll:!0,onSuccess:r=>{l.success("Panelist deleted"),x(t=>t.filter(i=>i!==s)),u(Array.isArray(r.props.panelists)?r.props.panelists:[]),m(!1)},onError:()=>{l.error("Failed to delete panelist"),m(!1)}})}function K(){p.length!==0&&window.confirm("Delete selected panelists?")&&(m(!0),j.post("/panelists/bulk-delete",{ids:p},{preserveScroll:!0,onSuccess:s=>{l.success("Panelists deleted"),x([]),u(Array.isArray(s.props.panelists)?s.props.panelists:[]),m(!1)},onError:()=>{l.error("Failed to bulk delete"),m(!1)}}))}function z(s){p.length!==0&&(m(!0),j.post("/panelists/bulk-status",{ids:p,status:s},{preserveScroll:!0,onSuccess:r=>{l.success("Panelists status updated"),x([]),u(Array.isArray(r.props.panelists)?r.props.panelists:[]),m(!1)},onError:()=>{l.error("Failed to update status"),m(!1)}}))}const L={};for(const s of me){L[s]={};for(const r of pe)L[s][r]=S.find(t=>t.role===s&&t.defense_type===r)||{id:0,role:s,defense_type:r,amount:""}}async function Q(){F(!0);try{const s=await J.put("/panelists/honorarium-specs",{specs:S});l.success("Honorarium rates updated"),s.data&&Array.isArray(s.data.honorariumSpecs)&&y(s.data.honorariumSpecs)}catch{l.error("Failed to update rates")}finally{F(!1)}}return e.jsxs(V,{breadcrumbs:de,children:[e.jsx(G,{title:"Panelists"}),e.jsx(te,{richColors:!0,position:"bottom-right"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 overflow-auto rounded-xl pt-5 pr-7 pl-7 relative",children:[e.jsxs("div",{className:"w-full bg-white border border-border rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"flex flex-row items-center justify-between w-full p-3 border-b bg-white",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-10 w-10 flex items-center justify-center rounded-full bg-rose-500/10 border border-rose-500",children:e.jsx(re,{className:"h-5 w-5 text-rose-400"})}),e.jsxs("div",{children:[e.jsx("span",{className:"text-base font-semibold",children:"Panelists"}),e.jsx("span",{className:"block text-xs text-muted-foreground",children:"This section shows all defense panelists. Add, search, and manage panelists."})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(n,{variant:"ghost",onClick:()=>E(!0),className:"h-9 flex items-center gap-2",children:[e.jsx(ae,{className:"h-4 w-4"}),"Edit Honorarium Rates"]}),e.jsxs(n,{onClick:()=>{h(!0),f(null)},disabled:v||d,children:[e.jsx(ie,{className:"h-4 w-4"}),"  ",v?"Loading...":"Add Panel"]})]})]}),e.jsx("div",{className:"flex items-center justify-between gap-2 px-4 py-3 border-b bg-white",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(W,{type:"text",startIcon:le,placeholder:"Search...",value:b,onChange:s=>k(s.target.value),className:"max-w-xs text-sm h-8",disabled:d}),e.jsxs(D,{children:[e.jsx(R,{asChild:!0,children:e.jsxs(n,{variant:"outline",className:"h-8 px-3 rounded-md border-dashed text-xs flex items-center gap-1",children:[e.jsx(U,{className:"h-4 w-4 mr-1"}),"Role",o.length>0&&e.jsx("span",{className:"ml-1 px-2 py-0.5 rounded-full text-xs bg-muted",children:o.length>1?`${o.length} selected`:o[0]})]})}),e.jsxs(T,{className:"w-44 p-1",side:"bottom",align:"start",children:[["Chairperson","Panel Member"].map(s=>e.jsxs("div",{onClick:()=>C(r=>r.includes(s)?r.filter(t=>t!==s):[...r,s]),className:"flex items-center gap-2 p-2 rounded hover:bg-muted cursor-pointer",children:[e.jsx(O,{checked:o.includes(s)}),e.jsx("span",{className:"text-sm",children:s})]},s)),e.jsx(n,{size:"sm",variant:"ghost",className:"w-full mt-2",onClick:()=>C([]),children:"Clear"})]})]}),e.jsxs(D,{children:[e.jsx(R,{asChild:!0,children:e.jsxs(n,{variant:"outline",className:"h-8 px-3 rounded-md border-dashed text-xs flex items-center gap-1",children:[e.jsx(U,{className:"h-4 w-4 mr-1"}),"Status",c.length>0&&e.jsx("span",{className:"ml-1 px-2 py-0.5 rounded-full text-xs bg-muted",children:c.length>1?`${c.length} selected`:c[0]})]})}),e.jsxs(T,{className:"w-44 p-1",side:"bottom",align:"start",children:[["Assigned","Not Assigned"].map(s=>e.jsxs("div",{onClick:()=>w(r=>r.includes(s)?r.filter(t=>t!==s):[...r,s]),className:"flex items-center gap-2 p-2 rounded hover:bg-muted cursor-pointer",children:[e.jsx(O,{checked:c.includes(s)}),e.jsx("span",{className:"text-sm",children:s})]},s)),e.jsx(n,{size:"sm",variant:"ghost",className:"w-full mt-2",onClick:()=>w([]),children:"Clear"})]})]}),(o.length>0||c.length>0||b.trim())&&e.jsxs(n,{variant:"ghost",size:"sm",className:"h-8 px-3 flex items-center gap-1",onClick:()=>{C([]),w([]),k("")},children:[e.jsx(B,{size:14})," Reset"]})]})})]}),e.jsx(Z,{panelists:_,honorariumSpecs:S,onEdit:s=>{f(s),h(!0)},onDelete:X,selected:p,setSelected:x,loading:d}),p.length>0&&e.jsxs("div",{className:"fixed left-1/2 z-30 -translate-x-1/2 bottom-4 md:bottom-6 flex items-center gap-1 bg-white border border-border shadow-lg rounded-lg px-4 py-1 text-xs animate-in fade-in slide-in-from-bottom-2 dark:bg-muted dark:text-muted-foreground dark:border-border",children:[e.jsxs("span",{className:"font-semibold min-w-[70px] text-center",children:[p.length," selected"]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsxs(n,{variant:"ghost",size:"icon",className:"px-2 py-1 h-7 w-auto text-xs flex items-center gap-1",onClick:K,"aria-label":"Delete",disabled:d,children:[e.jsx(ne,{size:13}),e.jsx("span",{className:"hidden sm:inline",children:d?"Deleting...":"Delete"})]}),e.jsxs(n,{variant:"ghost",size:"icon",className:"px-2 py-1 h-7 w-auto text-xs flex items-center gap-1",onClick:()=>z("Assigned"),"aria-label":"Set Assigned",disabled:d,children:[e.jsx(oe,{size:13,className:"text-green-500"}),e.jsx("span",{className:"hidden sm:inline",children:d?"Updating...":"Set Assigned"})]}),e.jsxs(n,{variant:"ghost",size:"icon",className:"px-2 py-1 h-7 w-auto text-xs flex items-center gap-1",onClick:()=>z("Not Assigned"),"aria-label":"Set Not Assigned",disabled:d,children:[e.jsx(ce,{size:13,className:"text-red-500"}),e.jsx("span",{className:"hidden sm:inline",children:d?"Updating...":"Set Not Assigned"})]}),e.jsx(n,{variant:"ghost",size:"icon",className:"px-1 py-1 h-7 w-auto text-xs flex items-center",onClick:()=>x([]),"aria-label":"Clear selection",children:e.jsx(B,{size:14})})]})]}),e.jsx(ee,{open:M,editing:H,onClose:()=>{h(!1),f(null)},onSubmit:q,loading:v}),e.jsx(se,{open:$,onOpenChange:E,honorariumSpecs:S,onChange:y,onSave:Q,saving:I})]})]})}export{ms as default};
