import{r as a,a as f,j as e}from"./app-BFhJ_rhz.js";import{T as E,a as O,b,c as h,d as I,e as c}from"./table-qP7NH3UJ.js";import{B as m}from"./button-CKae6SRa.js";import{I as M}from"./input-BIzgsiDe.js";import{D as N,f as k,a as z,b as y,c as C,e as S}from"./dialog-D7W9x4ad.js";import{S as j}from"./skeleton-DzsJStbB.js";import{A as B,a as H}from"./avatar-Hezgfi3W.js";import{U}from"./users-DEbcMkR_.js";import{S as V}from"./search-BRnI7D0o.js";import{c as _}from"./createLucideIcon-KZz7-iiu.js";import{C as F}from"./check-C9G5qvCx.js";import"./utils-jAU0Cazi.js";import"./index-XUnuFccv.js";import"./index-DZZQifJx.js";import"./index-B3ixvT_X.js";import"./index-BxKqTWPD.js";import"./index-D0wd6wGz.js";import"./x-CnUa_NpO.js";import"./index-Cts8AH-1.js";import"./index-DECR1Bfi.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],q=_("Copy",$);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]],Q=_("Trash",P);function W(){const[t,l]=a.useState(""),[x,r]=a.useState(!1);a.useEffect(()=>{fetch("/api/adviser/code").then(i=>i.json()).then(i=>l(i.adviser_code))},[]);const d=()=>{navigator.clipboard.writeText(t),r(!0),setTimeout(()=>r(!1),1500)};return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"text",value:t,readOnly:!0,className:"border rounded px-3 py-1 font-mono w-[120px] text-base bg-transparent",style:{minWidth:"100px"}}),e.jsx(m,{variant:"outline",size:"icon",onClick:d,disabled:!t,className:"border-gray-300 h-8 w-8","aria-label":"Copy adviser code",children:x?e.jsx(F,{size:16}):e.jsx(q,{size:16})})]})}function Y(t){var r,d,i,n;const l=((d=(r=t.first_name)==null?void 0:r.trim())==null?void 0:d[0])??"",x=((n=(i=t.last_name)==null?void 0:i.trim())==null?void 0:n[0])??"";return(l+x).toUpperCase()||"U"}function pe(){const[t,l]=a.useState([]),[x,r]=a.useState(!1),[d,i]=a.useState(!0),[n,T]=a.useState(""),[g,w]=a.useState(""),[L,u]=a.useState(!1),[o,p]=a.useState(null);a.useEffect(()=>{f.get("/api/adviser/students").then(s=>l(s.data)).finally(()=>i(!1))},[]);const v=t.filter(s=>s.student_number.toLowerCase().includes(n.toLowerCase())||s.first_name.toLowerCase().includes(n.toLowerCase())||s.last_name.toLowerCase().includes(n.toLowerCase())||s.email.toLowerCase().includes(n.toLowerCase())||s.program.toLowerCase().includes(n.toLowerCase())),R=async()=>{await f.post("/api/adviser/students",{email:g});const s=await f.get("/api/adviser/students");l(s.data),r(!1),w("")},D=async()=>{o&&(await f.delete(`/api/adviser/students/${o.id}`),l(t.filter(s=>s.id!==o.id)),u(!1),p(null))};return d?e.jsxs("div",{className:"w-full min-h-[70vh] bg-zinc-100 flex flex-col gap-4 p-0 m-0",children:[e.jsx(j,{className:"h-6 w-1/6 rounded bg-zinc-300 mt-8 mx-8"}),e.jsx(j,{className:"h-12 w-3/4 rounded bg-zinc-300 mx-8"}),e.jsx(j,{className:"h-12 w-2/3 rounded bg-zinc-300 mx-8"}),e.jsx(j,{className:"h-[400px] w-full rounded bg-zinc-300 mt-4"})]}):e.jsxs("div",{className:`flex h-full flex-1 flex-col gap-4 overflow-auto rounded-xl pt-5 pr-7 pl-7 relative
      bg-white dark:bg-zinc-900 transition-colors`,children:[e.jsxs("div",{className:`w-full border border-border rounded-lg overflow-hidden mb-1
        bg-white dark:bg-zinc-800 dark:border-zinc-700`,children:[e.jsxs("div",{className:`flex flex-row items-center justify-between w-full p-3 border-b
          bg-white dark:bg-zinc-800 dark:border-zinc-700`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-10 w-10 flex items-center justify-center rounded-full bg-rose-500/10 border border-rose-500",children:e.jsx(U,{className:"h-5 w-5 text-rose-400"})}),e.jsxs("div",{children:[e.jsx("span",{className:"text-base font-semibold",children:"My Students"}),e.jsx("span",{className:"block text-xs text-muted-foreground",children:"This page lists all students registered under your advisership. You can add, search, and manage students here."})]})]}),e.jsxs(N,{open:x,onOpenChange:r,children:[e.jsx(k,{asChild:!0,children:e.jsx(m,{className:"h-8 px-4 py-1 text-sm",onClick:()=>r(!0),children:"Register a Student"})}),e.jsxs(z,{children:[e.jsx(y,{children:e.jsx(C,{children:"Register a Student"})}),e.jsx("div",{className:"flex flex-col gap-3 mt-2",children:e.jsx("input",{type:"email",placeholder:"Student Email",value:g,onChange:s=>w(s.target.value),className:"border px-2 py-1 rounded text-sm"})}),e.jsx(S,{className:"mt-4",children:e.jsx(m,{onClick:R,children:"Register"})})]})]})]}),e.jsxs("div",{className:`flex flex-row items-center justify-between w-full p-3 border-t
          bg-white dark:bg-zinc-800 dark:border-zinc-700`,children:[e.jsx(M,{type:"text",startIcon:V,placeholder:"Search...",value:n,onChange:s=>T(s.target.value),className:"max-w-xs text-sm py-1 h-8"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"font-semibold text-sm whitespace-nowrap",children:"Shareable Adviser Code:"}),e.jsx(W,{})]})]})]}),e.jsx("div",{className:`rounded-md overflow-x-auto w-full max-w-full border border-border
        bg-white dark:bg-zinc-800 dark:border-zinc-700`,children:e.jsxs(E,{children:[e.jsx(O,{children:e.jsxs(b,{children:[e.jsx(h,{className:"dark:text-zinc-300",children:"Name"}),e.jsx(h,{className:"dark:text-zinc-300",children:"Student #"}),e.jsx(h,{className:"dark:text-zinc-300",children:"Email"}),e.jsx(h,{className:"dark:text-zinc-300",children:"Program"}),e.jsx(h,{className:"dark:text-zinc-300",children:"Actions"})]})}),e.jsx(I,{children:v.length===0?e.jsx(b,{children:e.jsx(c,{colSpan:5,className:"py-8 text-center text-sm text-muted-foreground dark:text-zinc-400",children:"No students found."})}):v.map(s=>e.jsxs(b,{className:"dark:hover:bg-zinc-700",children:[e.jsxs(c,{className:"flex items-center gap-3 dark:text-zinc-200",children:[e.jsx(B,{className:"h-8 w-8",children:e.jsx(H,{children:Y(s)})}),e.jsxs("span",{children:[s.first_name," ",s.middle_name?s.middle_name[0]+".":""," ",s.last_name]})]}),e.jsx(c,{className:"dark:text-zinc-200",children:s.student_number}),e.jsx(c,{className:"dark:text-zinc-200",children:s.email}),e.jsx(c,{className:"dark:text-zinc-200",children:s.program}),e.jsx(c,{children:e.jsxs(N,{open:L&&(o==null?void 0:o.id)===s.id,onOpenChange:A=>{A||(u(!1),p(null))},children:[e.jsx(k,{asChild:!0,children:e.jsx(m,{variant:"outline",size:"icon",className:"border-zinc-300 dark:border-zinc-500 dark:text-zinc-300","aria-label":"Remove student",onClick:()=>{p(s),u(!0)},children:e.jsx(Q,{size:18})})}),e.jsxs(z,{children:[e.jsx(y,{children:e.jsx(C,{children:"Remove Student"})}),e.jsxs("div",{className:"py-2 dark:text-zinc-200",children:["Are you sure you want to remove ",e.jsxs("b",{children:[s.first_name," ",s.last_name]})," from your advisership?"]}),e.jsxs(S,{children:[e.jsx(m,{variant:"outline",onClick:()=>{u(!1),p(null)},className:"mr-2 bg-white text-zinc-900 border-zinc-300 dark:bg-zinc-900 dark:text-zinc-100 dark:border-zinc-600",children:"Cancel"}),e.jsx(m,{onClick:D,className:"bg-rose-500 hover:bg-rose-600 text-white border-none dark:bg-rose-500 dark:hover:bg-rose-600 dark:text-white",children:"Confirm"})]})]})]})})]},s.id))})]})})]})}export{W as AdviserCodeBox,pe as default};
