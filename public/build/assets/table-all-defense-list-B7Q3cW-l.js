import{r as k,j as e,S}from"./app-CQngmq00.js";import{B as c}from"./button-Cw9tQIeO.js";import{T as L,a as E,b as _,c as n,d as F,e as s}from"./table-BEEQP98I.js";import{C as T}from"./checkbox-D0LzfNbG.js";import{B as x}from"./badge-BsPMjMb7.js";import{T as m,a as h,b as g,c as f}from"./tooltip-BvePKNvs.js";import{g as q}from"./program-abbreviations-BcvFCzIW.js";import{D as H,a as I,b as U,c as M}from"./dialog-D-tH9FDm.js";import{E as J}from"./eye-B6whRoNB.js";import{D as P}from"./dollar-sign-CkMbILE9.js";import{H as D}from"./hourglass-Ck8E1KPu.js";import{B as R}from"./banknote-DWaOIUXL.js";import{C as A}from"./circle-check-B6ukRmdw.js";import{C as K}from"./clock-Cn1v7f4i.js";import"./index-CDDLQrUy.js";import"./index-DZZQifJx.js";import"./utils-jAU0Cazi.js";import"./index-ahz1tZ6M.js";import"./index-DRp-GX9j.js";import"./index-VBHUZLOo.js";import"./index-CgLqTVh4.js";import"./index-BJk2QW0A.js";import"./index-Csh4Fj4k.js";import"./check-BEGkAg7k.js";import"./createLucideIcon-pjYyoixj.js";import"./floating-ui.react-dom-DL84dtXf.js";import"./index-BSk2xfhC.js";import"./index-BZgaE142.js";import"./x-B3RMhnUQ.js";function X(r){return r==="completed"?e.jsxs(x,{className:"bg-green-100 text-green-700 border-green-200 flex items-center gap-1",children:[e.jsx(A,{className:"h-3 w-3"}),"Completed"]}):r==="paid"?e.jsxs(x,{className:"bg-emerald-100 text-emerald-700 border-emerald-200 flex items-center gap-1",children:[e.jsx(R,{className:"h-3 w-3"}),"Paid"]}):r==="ready_for_finance"?e.jsxs(x,{className:"bg-blue-100 text-blue-700 border-blue-200 flex items-center gap-1",children:[e.jsx(P,{className:"h-3 w-3"}),"Ready for Finance"]}):r==="in_progress"?e.jsxs(x,{className:"bg-amber-100 text-amber-700 border-amber-200 flex items-center gap-1",children:[e.jsx(D,{className:"h-3 w-3"}),"In Progress"]}):e.jsxs(x,{className:"bg-yellow-100 text-yellow-700 border-yellow-200 flex items-center gap-1",children:[e.jsx(K,{className:"h-3 w-3"}),"Pending"]})}function W(r){return r==="completed"?"bg-green-500":r==="paid"?"bg-emerald-500":r==="ready_for_finance"?"bg-blue-500":r==="in_progress"?"bg-amber-500":"bg-yellow-500"}function Oe({paged:r,setPaged:w,columns:a,selected:j,toggleSelectOne:$,headerChecked:z,toggleSelectAll:O,toggleSort:G,sortDir:Q,onPriorityChange:V,onViewDetails:N,onRowApprove:Y,onRowReject:Z,onRowRetrieve:ee,highlightMissingDateMode:te,hideActions:ae,hideSelect:b,isSidebarCollapsed:ie=!1,sidebarWidth:se=260,totalCount:ne}){var v,C;const[o,l]=k.useState({open:!1,ids:[],action:null}),[B,y]=k.useState(!1);return e.jsxs("div",{className:"w-full box-border overflow-x-auto max-w-full border border-zinc-200 rounded-md bg-background transition-all duration-200",children:[e.jsx("div",{className:"min-w-full",children:e.jsxs(L,{className:"w-full text-sm table-auto",children:[e.jsx(E,{children:e.jsxs(_,{children:[!b&&e.jsx(n,{className:"w-[56px] py-2 sticky left-0 z-20 bg-background",style:{boxShadow:"2px 0 4px -2px rgba(0,0,0,0.04)",paddingLeft:"12px",paddingRight:"12px"},children:e.jsx(T,{checked:z,onCheckedChange:O})}),a.title&&e.jsx(n,{className:"px-3 min-w-[180px]",children:"Thesis Title"}),a.presenter&&e.jsx(n,{className:"px-2 min-w-[120px]",children:"Presenter"}),a.adviser&&e.jsx(n,{className:"px-2 min-w-[120px]",children:"Adviser"}),a.submitted_at&&e.jsx(n,{className:"px-2 min-w-[120px]",children:"Submitted At"}),a.program&&e.jsx(n,{className:"px-2 min-w-[100px]",children:"Program"}),a.coordinator&&e.jsx(n,{className:"px-2 min-w-[140px]",children:"Program Coordinator"}),a.scheduled_date&&e.jsx(n,{className:"px-2 min-w-[120px]",children:"Scheduled Date"}),a.amount_paid&&e.jsx(n,{className:"px-2 min-w-[120px]",children:"Amount"}),a.reference_no&&e.jsx(n,{className:"px-2 min-w-[120px]",children:"Reference/OR No."}),a.priority&&e.jsx(n,{className:"px-2 min-w-[80px]",children:"Priority"}),a.status&&e.jsx(n,{className:"px-2 min-w-[100px] text-center",children:"AA Status"}),a.actions&&e.jsx(n,{className:"px-2 min-w-[80px] text-center sticky right-0 z-20 bg-background",style:{boxShadow:"-2px 0 4px -2px rgba(0,0,0,0.04)"},children:"Actions"})]})}),e.jsxs(F,{children:[r.map(t=>{const p=j==null?void 0:j.includes(t.id),u=i=>{const d=i.target.tagName;d==="BUTTON"||d==="INPUT"||d==="SELECT"||i.target.closest(".action-btn")||i.target.closest(".priority-dropdown")||(N?N(t.id):S.visit(`/assistant/all-defense-list/${t.id}/details`))};return e.jsxs(_,{className:"hover:bg-muted/40 cursor-pointer",onClick:u,children:[!b&&e.jsx(s,{className:"px-3 py-2 sticky left-0 z-10 bg-background",style:{boxShadow:"2px 0 4px -2px rgba(0,0,0,0.04)",paddingLeft:"12px",paddingRight:"12px"},children:e.jsx(T,{checked:p,onCheckedChange:()=>$(t.id),className:"action-btn",onClick:i=>i.stopPropagation()})}),a.title&&e.jsx(s,{className:"px-3 py-2 font-medium truncate leading-tight align-middle",title:t.thesis_title,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full flex-shrink-0 ${W(t.aa_verification_status)}`}),e.jsx(x,{variant:"outline",className:"flex-shrink-0",children:t.defense_type||"—"}),e.jsx("span",{className:"truncate",children:t.thesis_title&&t.thesis_title.length>32?t.thesis_title.slice(0,32)+"…":t.thesis_title})]})}),a.presenter&&e.jsxs(s,{className:"px-2 py-2 text-xs text-muted-foreground whitespace-nowrap align-middle",title:`${t.first_name} ${t.middle_name?t.middle_name+" ":""}${t.last_name}`,children:[t.first_name," ",t.middle_name?t.middle_name[0]+". ":"",t.last_name]}),a.adviser&&e.jsx(s,{className:"px-2 py-2 text-xs text-muted-foreground whitespace-nowrap align-middle",children:t.adviser||"—"}),a.submitted_at&&e.jsx(s,{className:"px-2 py-2 text-xs text-muted-foreground whitespace-nowrap align-middle",children:t.submitted_at?(()=>{try{return new Date(t.submitted_at).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return t.submitted_at}})():"—"}),a.program&&e.jsx(s,{className:"px-2 py-2 text-xs text-muted-foreground whitespace-nowrap align-middle",title:t.program||"—",children:q(t.program||"—")}),a.coordinator&&e.jsx(s,{className:"px-2 py-2 text-xs text-muted-foreground whitespace-nowrap align-middle",children:t.coordinator||"—"}),a.scheduled_date&&e.jsx(s,{className:"px-2 py-2 text-xs text-muted-foreground whitespace-nowrap align-middle",children:t.scheduled_date?new Date(t.scheduled_date).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"—"}),a.amount_paid&&e.jsx(s,{className:"px-2 py-2 text-xs text-muted-foreground whitespace-nowrap align-middle",children:t.amount!=null?`₱${Number(t.amount).toLocaleString(void 0,{minimumFractionDigits:2})}`:"—"}),a.reference_no&&e.jsx(s,{className:"px-2 py-2 text-xs text-muted-foreground whitespace-nowrap align-middle",children:t.reference_no||"—"}),a.priority&&e.jsx(s,{className:"px-2 py-2 text-xs text-muted-foreground whitespace-nowrap align-middle",children:t.priority}),a.status&&e.jsx(s,{className:"px-2 py-2 text-xs whitespace-nowrap text-center align-middle",children:X(t.aa_verification_status)}),a.actions&&e.jsx(s,{className:"px-2 py-2 text-xs text-center align-middle sticky right-0 z-10 bg-background",style:{boxShadow:"-2px 0 4px -2px rgba(0,0,0,0.04)"},children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(m,{children:e.jsxs(h,{children:[e.jsx(g,{asChild:!0,children:e.jsx(c,{size:"sm",variant:"outline",className:"action-btn h-8 w-8 p-0",onClick:i=>{i.stopPropagation(),S.visit(`/assistant/all-defense-list/${t.id}/details`)},children:e.jsx(J,{className:"h-4 w-4"})})}),e.jsx(f,{children:"View Details"})]})}),t.aa_verification_status!=="completed"&&t.aa_verification_status!=="ready_for_finance"&&e.jsx(m,{children:e.jsxs(h,{children:[e.jsx(g,{asChild:!0,children:e.jsx(c,{size:"sm",variant:"outline",className:"action-btn h-8 w-8 p-0",onClick:i=>{i.stopPropagation(),t.aa_verification_id&&l({open:!0,ids:[t.aa_verification_id],action:"ready_for_finance"})},children:e.jsx(P,{className:"h-4 w-4 text-blue-600"})})}),e.jsx(f,{children:"Ready for Finance"})]})}),t.aa_verification_status!=="completed"&&t.aa_verification_status!=="in_progress"&&e.jsx(m,{children:e.jsxs(h,{children:[e.jsx(g,{asChild:!0,children:e.jsx(c,{size:"sm",variant:"outline",className:"action-btn h-8 w-8 p-0",onClick:i=>{i.stopPropagation(),t.aa_verification_id&&l({open:!0,ids:[t.aa_verification_id],action:"in_progress"})},children:e.jsx(D,{className:"h-4 w-4 text-amber-600"})})}),e.jsx(f,{children:"In Progress"})]})}),t.aa_verification_status!=="completed"&&t.aa_verification_status!=="paid"&&e.jsx(m,{children:e.jsxs(h,{children:[e.jsx(g,{asChild:!0,children:e.jsx(c,{size:"sm",variant:"outline",className:"action-btn h-8 w-8 p-0",onClick:i=>{i.stopPropagation(),t.aa_verification_id&&l({open:!0,ids:[t.aa_verification_id],action:"paid"})},children:e.jsx(R,{className:"h-4 w-4 text-emerald-600"})})}),e.jsx(f,{children:"Paid"})]})}),t.aa_verification_status!=="completed"&&e.jsx(m,{children:e.jsxs(h,{children:[e.jsx(g,{asChild:!0,children:e.jsx(c,{size:"sm",className:"action-btn h-8 w-8 p-0 bg-green-600 hover:bg-green-700 text-white",onClick:i=>{i.stopPropagation(),l({open:!0,ids:[t.aa_verification_id??0],action:"completed"})},children:e.jsx(A,{className:"h-4 w-4"})})}),e.jsx(f,{children:"Mark as Completed"})]})})]})})]},t.id)}),r.length===0&&e.jsx(_,{children:e.jsx(s,{colSpan:Object.keys(a).length+(b?0:1),className:"py-32 text-center text-sm text-muted-foreground",children:"no results"})})]})]})}),e.jsx(H,{open:o.open,onOpenChange:t=>l(p=>({...p,open:t})),children:e.jsxs(I,{children:[e.jsx(U,{children:"Confirm Status Change"}),e.jsx(M,{children:o.ids.length>1?`Are you sure you want to set ${o.ids.length} requests to ${(v=o.action)==null?void 0:v.replace("_"," ")}?`:`Are you sure you want to set this request to ${(C=o.action)==null?void 0:C.replace("_"," ")}?`}),e.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[e.jsx(c,{variant:"ghost",onClick:()=>l({open:!1,ids:[],action:null}),children:"Cancel"}),e.jsx(c,{disabled:B,onClick:async()=>{var p,u;y(!0);let t;o.ids.length===1?t=await fetch(`/aa/payment-verifications/${o.ids[0]}/status`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((p=document.querySelector('meta[name="csrf-token"]'))==null?void 0:p.content)||""},body:JSON.stringify({status:o.action})}):t=await fetch("/aa/payment-verifications/bulk-update",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((u=document.querySelector('meta[name="csrf-token"]'))==null?void 0:u.content)||""},body:JSON.stringify({verification_ids:o.ids,status:o.action})}),y(!1),l({open:!1,ids:[],action:null}),t.ok&&w?w(i=>i.map(d=>o.ids.includes(d.aa_verification_id??-1)?{...d,aa_verification_status:o.action}:d)):alert("Failed to update status. Please try again.")},children:"Confirm"})]})]})})]})}export{Oe as default};
