import{K as q,r as s,j as e,R as A,$ as E}from"./app-BFhJ_rhz.js";import T from"./defense-status-widget-B40KxOaz.js";import W from"./weekly-defense-schedule-widget-HX0iuG20.js";import{B as _,Q as P}from"./quick-actions-widget-DtxdUDfo.js";import{C as $,a as L,b as B,c as G}from"./card-DBC-Y-7_.js";import v from"./unified-dashboard-layout-Dv5uIaEj.js";import{C as M}from"./clipboard-list-CPIQpMom.js";import{C as Q}from"./calendar-days-Dpy-fNAL.js";import{C as F}from"./circle-alert-D1cIR00J.js";import"./graduation-cap-CXqZ0t7s.js";import"./createLucideIcon-KZz7-iiu.js";import"./chevron-right-DjSSbn5Y.js";import"./hourglass-DgiREuGd.js";import"./x-CnUa_NpO.js";import"./check-C9G5qvCx.js";import"./calendar-CgC1wT9Q.js";import"./users-DEbcMkR_.js";import"./skeleton-DzsJStbB.js";import"./utils-jAU0Cazi.js";import"./format-HX8DKPSU.js";import"./en-US-BA9orzCf.js";import"./isSameDay-DUlCFK42.js";import"./parseISO-CbXPh3Al.js";import"./tooltip-I1_k_sJu.js";import"./index-BxKqTWPD.js";import"./index-XUnuFccv.js";import"./floating-ui.react-dom-cBbMY6yK.js";import"./user-round-DUtLRF0P.js";import"./settings-HgSYffZJ.js";import"./receipt-DOktdA3j.js";import"./book-open-Bm6ABnRf.js";import"./separator-BY26pNcl.js";import"./index-DECR1Bfi.js";import"./sun-zhaV4S8O.js";function Ee(){var g,f;const n=q().props,{auth:{user:t},defenseRequirement:H,defenseRequest:I}=n,d=n.defenseRequests??[],[c,p]=s.useState([]),[K,U]=s.useState([]),[j,Y]=s.useState([]),[m,h]=s.useState(!0),[J,O]=s.useState(!0),[y,N]=s.useState(!0),[w,k]=s.useState(new Date().getDay()),S=[{label:"Sun",value:0},{label:"Mon",value:1},{label:"Tue",value:2},{label:"Wed",value:3},{label:"Thu",value:4},{label:"Fri",value:5},{label:"Sat",value:6}];s.useEffect(()=>{const r=o=>{let a=o.filter(l=>{const i=l.submitted_by;return i===(t==null?void 0:t.id)||i===String(t==null?void 0:t.id)});a.length===0&&(a=o);const x=[...a].sort((l,i)=>{const C=l.created_at?new Date(l.created_at).getTime():0;return(i.created_at?new Date(i.created_at).getTime():0)-C});p(x)};(async()=>{h(!0);try{const o=await fetch("/defense-request",{headers:{Accept:"application/json"}});if(!o.ok)throw new Error("bad");const a=await o.json(),x=Array.isArray(a)?a:a.defenseRequests??[];r(x)}catch{p([])}finally{h(!1)}})()},[t==null?void 0:t.id]);const D=d&&d.length>0?d:c,R=((g=n.recentPayment)==null?void 0:g.amount)??0,z=[{title:"Defense Submissions",value:c.length,description:"Total defense requests submitted",icon:e.jsx(M,{className:"size-7"})},{title:"Today's Schedules",value:j.length,description:"Events scheduled for today",icon:e.jsx(Q,{className:"size-7"})},{title:"Recent Payment",value:`₱${R.toLocaleString()}`,description:"Most recent payment made",icon:e.jsx(_,{className:"size-7"})}],u=t!=null&&t.school_id?`${(t==null?void 0:t.role)??"Student"} / ${t.school_id}`:(t==null?void 0:t.role)??"Student";return m?e.jsx(v,{user:t,customGreeting:u,children:e.jsxs("div",{className:"w-full min-h-[70vh] bg-zinc-100 dark:bg-zinc-900 flex flex-col gap-4 p-0 m-0",children:[e.jsx("div",{className:"h-6 w-1/6 rounded bg-zinc-300 dark:bg-zinc-800 mt-8 mx-8"}),e.jsx("div",{className:"h-12 w-3/4 rounded bg-zinc-300 dark:bg-zinc-800 mx-8"}),e.jsx("div",{className:"h-12 w-2/3 rounded bg-zinc-300 dark:bg-zinc-800 mx-8"}),e.jsx("div",{className:"h-[500px] w-full rounded bg-zinc-300 dark:bg-zinc-800 mt-4"})]})}):e.jsxs(v,{user:t,customGreeting:u,children:[e.jsx("div",{className:"absolute top-6 right-8",children:e.jsx(P,{userRole:t==null?void 0:t.role})}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-3 px-7",children:z.map((r,b)=>e.jsxs($,{className:"border border-1 bg-white dark:bg-muted rounded-xl shadow-none flex flex-row items-center min-h-[70px] py-4 px-5",children:[e.jsxs("div",{className:"flex flex-col justify-center flex-1",children:[e.jsx(L,{className:"pb-1 px-0",children:e.jsx(B,{className:"text-xs font-semibold text-gray-600 dark:text-gray-300",children:r.title})}),e.jsxs(G,{className:"px-0 py-0",children:[e.jsx("div",{className:"mb-0.5",children:e.jsx("span",{className:"text-2xl font-bold text-gray-900 dark:text-white leading-tight",children:r.value})}),e.jsx("div",{className:"text-[11px] text-gray-400 dark:text-gray-500 mt-0.5",children:r.description})]})]}),e.jsx("div",{className:"flex items-center justify-center ml-3 w-[40px] h-[40px]",children:A.cloneElement(r.icon,{className:"text-rose-500 dark:text-rose-400 size-7"})})]},b))}),((f=t==null?void 0:t.advisers)==null?void 0:f.length)===0&&y&&e.jsx("div",{className:"mx-7 my-3",children:e.jsxs("div",{className:"bg-rose-50 dark:bg-rose-950 border border-rose-200 dark:border-rose-900 text-rose-900 dark:text-rose-100 flex items-start gap-3 px-6 py-5 rounded-xl relative",children:[e.jsx(F,{className:"h-5 w-5 text-rose-500 dark:text-rose-400 mt-1 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"font-semibold mb-1 block",children:"You have not registered an adviser yet."}),e.jsxs("span",{className:"text-sm",children:["Please register with your adviser using their code or contact your adviser for assistance.",e.jsx(E,{href:"/settings/profile",className:"ml-2 underline text-rose-600 dark:text-rose-300 font-medium hover:text-rose-700 dark:hover:text-rose-200",children:"Go to Settings"})]})]}),e.jsx("button",{onClick:()=>N(!1),className:"absolute top-3 right-4 px-2 py-1 text-base rounded hover:bg-rose-100 dark:hover:bg-rose-900 text-rose-600 dark:text-rose-200","aria-label":"Close",children:"✕"})]})}),e.jsxs("div",{className:"flex flex-col gap-6 bg-gray-100 dark:bg-muted ms-4 me-4 rounded-xl mt-2 mb-2 px-5 py-8",children:[e.jsxs("div",{className:"w-full mb-2 flex flex-col md:flex-row gap-4",children:[e.jsx(W,{weekDays:S,selectedDay:w,setSelectedDay:k,approvedDefenses:D,referenceDate:new Date,loading:m,studentId:t==null?void 0:t.id}),e.jsx(T,{recentRequests:c,loading:m})]}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2"})]})]})}export{Ee as default};
