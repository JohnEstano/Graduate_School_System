import{r as i,j as e,a as x}from"./app-cp5Xxmuq.js";import{D as E,a as O,b as F,c as T,d as I,e as M}from"./dialog-BrgoPxJ8.js";import{B as l}from"./button-HcUz4N3c.js";import{I as u}from"./input-CozWEoae.js";import{L as m}from"./label-BLxT7CIS.js";import{P as $,a as z,b as A,C as L}from"./calendar-BnO3dmDg.js";import{S as B,a as R,b as V,c as H,d as j}from"./select-TPdSJVhR.js";import{C as J}from"./check-BKTDNJDu.js";import{C as G}from"./calendar-CPOz5vlg.js";import{P as K}from"./plus-Bna1wD4l.js";import{f as g}from"./format-HX8DKPSU.js";import"./index-DbUO4osX.js";import"./index-BwY1skv1.js";import"./index-BiaJJerR.js";import"./index-BkV9g7de.js";import"./utils-jAU0Cazi.js";import"./x-ChVMmgUr.js";import"./createLucideIcon-fPg6f676.js";import"./index-DZZQifJx.js";import"./floating-ui.react-dom-CclZEsZs.js";import"./en-US-BA9orzCf.js";import"./endOfWeek-QFyZPl43.js";import"./differenceInCalendarMonths-HUNRrXGm.js";import"./normalizeInterval-CdMCNNY-.js";import"./endOfMonth-CK_ShA5m.js";import"./isSameDay-DUlCFK42.js";import"./isSameMonth-CQd3m9St.js";import"./chevron-left-Lq9k-s81.js";import"./chevron-right-u5yeAyLv.js";import"./chevron-down-CRKR2eDe.js";import"./index-DGSzJOj5.js";import"./index-w2GBgPnQ.js";import"./index-KWoA_zXX.js";import"./index-B7grp9yP.js";import"./index-DjkDYLy3.js";function _e({request:a,open:v,onOpenChange:p}){const[n,d]=i.useState({date:"",modeDefense:"",chairperson:"",advisersEndorsement:null,recEndorsement:null,proofOfPayment:null,referenceNo:null}),[o,f]=i.useState([""]),[b,h]=i.useState(!1),[c,D]=i.useState(void 0),[N,P]=i.useState(!1);function y(s){d({...n,[s.target.name]:s.target.value})}function C(s,t){f(r=>r.map((_,k)=>k===s?t:_))}function S(){o.length<4&&f(s=>[...s,""])}async function w(s){if(s&&s.preventDefault(),!n.date||!n.modeDefense||!n.chairperson||!o[0]){alert("Please fill out all required fields.");return}const t={firstName:a.first_name,middleName:a.middle_name||"",lastName:a.last_name,schoolId:a.school_id,program:a.program,thesisTitle:a.thesis_title,date:n.date,modeDefense:n.modeDefense,defenseType:a.defense_type,defenseAdviser:a.defense_adviser||a.adviser||"",defenseChairperson:n.chairperson,defensePanelist1:o[0]||"",defensePanelist2:o[1]||"",defensePanelist3:o[2]||"",defensePanelist4:o[3]||"",recEndorsement:a.rec_endorsement||"",proofOfPayment:a.proof_of_payment||"",referenceNo:a.reference_no||""};try{await x.post("/defense-request",t),P(!0)}catch(r){x.isAxiosError(r)&&r.response?alert("Failed to submit endorsement: "+JSON.stringify(r.response.data)):alert("Failed to submit endorsement.")}}return e.jsx(E,{open:v,onOpenChange:p,children:e.jsxs(O,{className:"max-w-lg w-full",children:[e.jsxs(F,{children:[e.jsx(T,{children:"Endorse Defense Request"}),e.jsx(I,{children:"Fill out the schedule and panel details for this defense."})]}),N?e.jsxs("div",{className:"flex flex-col items-center gap-6 py-12",children:[e.jsx(J,{size:48,className:"text-green-500"}),e.jsx("div",{className:"text-lg font-semibold",children:"Endorsement Submitted!"}),e.jsx(l,{onClick:()=>p(!1),children:"Done"})]}):e.jsxs("form",{id:"endorse-defense-form",onSubmit:w,children:[e.jsxs("div",{className:"max-h-[60vh] overflow-auto space-y-4 py-4 px-2",children:[e.jsxs("div",{children:[e.jsx(m,{className:"mb-1 block text-sm",children:"Date of Defense"}),e.jsxs($,{open:b,onOpenChange:h,children:[e.jsx(z,{asChild:!0,children:e.jsxs(l,{variant:"outline",type:"button",className:"w-full justify-between h-9 text-sm px-3",children:[c?g(c,"PPP"):"Select date",e.jsx(G,{className:"ml-2 h-4 w-4 opacity-50"})]})}),e.jsx(A,{side:"bottom",align:"start",sideOffset:4,className:"pointer-events-auto z-50 w-auto p-0",children:e.jsx("div",{onClick:s=>s.stopPropagation(),children:e.jsx(L,{mode:"single",selected:c,onSelect:s=>{D(s||void 0),d(t=>({...t,date:s?g(s,"yyyy-MM-dd"):""})),h(!1)},captionLayout:"dropdown"})})})]})]}),e.jsxs("div",{children:[e.jsx(m,{className:"mb-1 block text-sm",children:"Mode of Defense"}),e.jsxs(B,{value:n.modeDefense,onValueChange:s=>d(t=>({...t,modeDefense:s})),required:!0,name:"modeDefense",children:[e.jsx(R,{className:"w-full h-9 text-sm px-3","aria-label":"Mode of Defense",children:e.jsx(V,{placeholder:"Select mode"})}),e.jsxs(H,{children:[e.jsx(j,{value:"Face-to-face",children:"Face-to-face"}),e.jsx(j,{value:"Online",children:"Online"})]})]})]}),e.jsxs("div",{children:[e.jsx(m,{className:"mb-1 block text-sm",children:"Chairperson"}),e.jsx(u,{name:"chairperson",value:n.chairperson,onChange:y,required:!0,placeholder:"Chairperson",className:"h-9 text-sm px-3"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-1 w-full",children:[e.jsx(m,{className:"mb-1 block text-sm",children:"Panelists"}),e.jsx(l,{type:"button",variant:"ghost",size:"icon",className:"h-7 w-7",onClick:S,disabled:o.length>=4,"aria-label":"Add Panelist",children:e.jsx(K,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"space-y-2",children:o.map((s,t)=>e.jsx(u,{name:`panelist${t+1}`,value:s,onChange:r=>C(t,r.target.value),required:t<2,placeholder:`Panelist ${t+1}${t>1,""}`,className:"h-9 text-sm px-3"},t))})]})]}),e.jsx(M,{className:"pt-4",children:e.jsx(l,{type:"submit",form:"endorse-defense-form",className:"bg-rose-500 text-white h-9 text-sm px-6",children:"Submit Endorsement"})})]})]})})}export{_e as default};
