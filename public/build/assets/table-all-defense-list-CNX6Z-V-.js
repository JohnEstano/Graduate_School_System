import{r as _,j as e,S as T}from"./app-DW0Mt5c9.js";import{B as m}from"./button-BZf0VdIO.js";import{T as D,a as A,b as u,c as s,d as P,e as i}from"./table-CYsX4eCK.js";import{C as N}from"./checkbox-fbuYKHl8.js";import{B as p}from"./badge-B7OUzsXL.js";import{g as R}from"./program-abbreviations-BcvFCzIW.js";import{D as L,a as O,b as $,c as z}from"./dialog-D7L72BhV.js";import{C as B}from"./circle-check-C1QAq6HU.js";import{C as E}from"./circle-alert-CV2dla6l.js";import"./index-RzYQM1sh.js";import"./index-DZZQifJx.js";import"./utils-jAU0Cazi.js";import"./index-xrb8sl6P.js";import"./index-DHu7YzAG.js";import"./index-I9YLalqX.js";import"./index-dxfJWdT_.js";import"./index-D1ThX8Vn.js";import"./index-Bwn0NV8Z.js";import"./check-C1Ca0PY3.js";import"./createLucideIcon-S0dKkUVo.js";import"./index-BMNAwHVU.js";import"./index-Bh88FqJG.js";import"./x-CW6T59GI.js";function F(d){return d==="completed"?e.jsx(p,{className:"bg-green-100 text-green-700 border-green-200",children:"Completed"}):d==="ready_for_finance"?e.jsx(p,{className:"bg-blue-100 text-blue-700 border-blue-200",children:"Ready for Finance"}):d==="in_progress"?e.jsx(p,{className:"bg-amber-100 text-amber-700 border-amber-200",children:"In Progress"}):e.jsx(p,{className:"bg-yellow-100 text-yellow-700 border-yellow-200",children:"Pending"})}function ye({paged:d,setPaged:f,columns:a,selected:h,toggleSelectOne:C,headerChecked:v,toggleSelectAll:S,toggleSort:q,sortDir:U,onPriorityChange:I,onViewDetails:b,onRowApprove:H,onRowReject:J,onRowRetrieve:K,highlightMissingDateMode:M,hideActions:X,hideSelect:g,isSidebarCollapsed:W=!1,sidebarWidth:G=260,totalCount:Q}){var y,w;const[n,c]=_.useState({open:!1,ids:[],action:null}),[k,j]=_.useState(!1);return e.jsxs("div",{className:"w-full box-border overflow-x-auto max-w-full border border-zinc-200 rounded-md bg-background transition-all duration-200",children:[e.jsx("div",{className:"min-w-full",children:e.jsxs(D,{className:"w-full text-sm table-auto",children:[e.jsx(A,{children:e.jsxs(u,{children:[!g&&e.jsx(s,{className:"w-[56px] py-2 sticky left-0 z-20 bg-background",style:{boxShadow:"2px 0 4px -2px rgba(0,0,0,0.04)",paddingLeft:"12px",paddingRight:"12px"},children:e.jsx(N,{checked:v,onCheckedChange:S})}),a.title&&e.jsx(s,{className:"px-3 min-w-[180px]",children:"Thesis Title"}),a.presenter&&e.jsx(s,{className:"px-2 min-w-[120px]",children:"Presenter"}),a.adviser&&e.jsx(s,{className:"px-2 min-w-[120px]",children:"Adviser"}),a.submitted_at&&e.jsx(s,{className:"px-2 min-w-[120px]",children:"Submitted At"}),a.program&&e.jsx(s,{className:"px-2 min-w-[100px]",children:"Program"}),a.coordinator&&e.jsx(s,{className:"px-2 min-w-[140px]",children:"Program Coordinator"}),a.scheduled_date&&e.jsx(s,{className:"px-2 min-w-[120px]",children:"Scheduled Date"}),a.expected_amount&&e.jsx(s,{className:"px-2 min-w-[120px]",children:"Expected Amount"}),a.amount_paid&&e.jsx(s,{className:"px-2 min-w-[120px]",children:"Amount Paid"}),a.reference_no&&e.jsx(s,{className:"px-2 min-w-[120px]",children:"Reference/OR No."}),a.priority&&e.jsx(s,{className:"px-2 min-w-[80px]",children:"Priority"}),a.status&&e.jsx(s,{className:"px-2 min-w-[100px] text-center",children:"AA Status"}),a.actions&&e.jsx(s,{className:"px-2 min-w-[80px] text-center sticky right-0 z-20 bg-background",style:{boxShadow:"-2px 0 4px -2px rgba(0,0,0,0.04)"},children:"Actions"})]})}),e.jsxs(P,{children:[d.map(t=>{const l=h==null?void 0:h.includes(t.id),x=r=>{const o=r.target.tagName;o==="BUTTON"||o==="INPUT"||o==="SELECT"||r.target.closest(".action-btn")||r.target.closest(".priority-dropdown")||(b?b(t.id):T.visit(`/assistant/all-defense-list/${t.id}/details`))};return e.jsxs(u,{className:"hover:bg-muted/40 cursor-pointer",onClick:x,children:[!g&&e.jsx(i,{className:"px-3 py-2 sticky left-0 z-10 bg-background",style:{boxShadow:"2px 0 4px -2px rgba(0,0,0,0.04)",paddingLeft:"12px",paddingRight:"12px"},children:e.jsx(N,{checked:l,onCheckedChange:()=>C(t.id),className:"action-btn",onClick:r=>r.stopPropagation()})}),a.title&&e.jsxs(i,{className:"px-3 py-2 font-medium truncate leading-tight align-middle flex items-center gap-2",title:t.thesis_title,children:[e.jsx(p,{variant:"outline",className:"shrink-0",children:t.defense_type||"—"}),e.jsx("span",{className:"truncate",children:t.thesis_title&&t.thesis_title.length>32?t.thesis_title.slice(0,32)+"…":t.thesis_title})]}),a.presenter&&e.jsxs(i,{className:"px-2 py-2 text-xs text-muted-foreground whitespace-nowrap align-middle",title:`${t.first_name} ${t.middle_name?t.middle_name+" ":""}${t.last_name}`,children:[t.first_name," ",t.middle_name?t.middle_name[0]+". ":"",t.last_name]}),a.adviser&&e.jsx(i,{className:"px-2 py-2 text-xs text-muted-foreground whitespace-nowrap align-middle",children:t.adviser||"—"}),a.submitted_at&&e.jsx(i,{className:"px-2 py-2 text-xs text-muted-foreground whitespace-nowrap align-middle",children:t.submitted_at?(()=>{try{return new Date(t.submitted_at).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return t.submitted_at}})():"—"}),a.program&&e.jsx(i,{className:"px-2 py-2 text-xs text-muted-foreground whitespace-nowrap align-middle",title:t.program||"—",children:R(t.program||"—")}),a.coordinator&&e.jsx(i,{className:"px-2 py-2 text-xs text-muted-foreground whitespace-nowrap align-middle",children:t.coordinator||"—"}),a.scheduled_date&&e.jsx(i,{className:"px-2 py-2 text-xs text-muted-foreground whitespace-nowrap align-middle",children:t.scheduled_date?new Date(t.scheduled_date).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"—"}),a.expected_amount&&e.jsx(i,{className:"px-2 py-2 text-xs text-muted-foreground whitespace-nowrap align-middle",children:t.expected_rate!=null?`₱${Number(t.expected_rate).toLocaleString(void 0,{minimumFractionDigits:2})}`:"—"}),a.amount_paid&&e.jsx(i,{className:"px-2 py-2 text-xs text-muted-foreground whitespace-nowrap align-middle",children:t.amount!=null?`₱${Number(t.amount).toLocaleString(void 0,{minimumFractionDigits:2})}`:"—"}),a.reference_no&&e.jsx(i,{className:"px-2 py-2 text-xs text-muted-foreground whitespace-nowrap align-middle",children:t.reference_no||"—"}),a.priority&&e.jsx(i,{className:"px-2 py-2 text-xs text-muted-foreground whitespace-nowrap align-middle",children:t.priority}),a.status&&e.jsx(i,{className:"px-2 py-2 text-xs whitespace-nowrap text-center align-middle",children:F(t.aa_verification_status)}),a.actions&&e.jsxs(i,{className:"px-2 py-2 text-xs text-center align-middle sticky right-0 z-10 bg-background",style:{boxShadow:"-2px 0 4px -2px rgba(0,0,0,0.04)"},children:[e.jsx(m,{size:"sm",variant:"outline",className:"ml-1 action-btn",onClick:r=>{r.stopPropagation(),t.aa_verification_id&&c({open:!0,ids:[t.aa_verification_id],action:"ready_for_finance"})},disabled:t.aa_verification_status==="completed",children:e.jsx(B,{className:"h-4 w-4 text-emerald-600"})}),e.jsx(m,{size:"sm",variant:"outline",className:"ml-1 action-btn",onClick:r=>{r.stopPropagation(),t.aa_verification_id&&c({open:!0,ids:[t.aa_verification_id],action:"in_progress"})},disabled:t.aa_verification_status==="completed",children:e.jsx(E,{className:"h-4 w-4 text-amber-600"})})]})]},t.id)}),d.length===0&&e.jsx(u,{children:e.jsx(i,{colSpan:Object.keys(a).length+(g?0:1),className:"py-32 text-center text-sm text-muted-foreground",children:"no results"})})]})]})}),e.jsx(L,{open:n.open,onOpenChange:t=>c(l=>({...l,open:t})),children:e.jsxs(O,{children:[e.jsx($,{children:"Confirm Status Change"}),e.jsx(z,{children:n.ids.length>1?`Are you sure you want to set ${n.ids.length} requests to ${(y=n.action)==null?void 0:y.replace("_"," ")}?`:`Are you sure you want to set this request to ${(w=n.action)==null?void 0:w.replace("_"," ")}?`}),e.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[e.jsx(m,{variant:"ghost",onClick:()=>c({open:!1,ids:[],action:null}),children:"Cancel"}),e.jsx(m,{disabled:k,onClick:async()=>{var l,x;j(!0);let t;n.ids.length===1?t=await fetch(`/aa/payment-verifications/${n.ids[0]}/status`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((l=document.querySelector('meta[name="csrf-token"]'))==null?void 0:l.content)||""},body:JSON.stringify({status:n.action})}):t=await fetch("/aa/payment-verifications/bulk-update",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((x=document.querySelector('meta[name="csrf-token"]'))==null?void 0:x.content)||""},body:JSON.stringify({verification_ids:n.ids,status:n.action})}),j(!1),c({open:!1,ids:[],action:null}),t.ok&&f?f(r=>r.map(o=>n.ids.includes(o.aa_verification_id??-1)?{...o,aa_verification_status:n.action}:o)):alert("Failed to update status. Please try again.")},children:"Confirm"})]})]})})]})}export{ye as default};
