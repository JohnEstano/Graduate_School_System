import{r as i,j as e}from"./app-BDkuJsct.js";import{C as d,c as h}from"./card-BJFJPDio.js";import{C as S,a as k,b as A}from"./chart-7aubccfQ.js";import{S as D,a as T,b as E,c as F,e as u}from"./select-D1tIJaem.js";import{D as L}from"./dollar-sign-CSALIIUa.js";import{A as _,a as W}from"./AreaChart-D-ENoPw9.js";import{C as M}from"./CartesianGrid-CTAPJDM6.js";import{X as P}from"./YAxis-B7UrdJFR.js";import"./utils-jAU0Cazi.js";import"./generateCategoricalChart-BOHwT1p9.js";import"./index-CoS1vLG5.js";import"./index-Chjiymov.js";import"./index-BhbofC_p.js";import"./index-DMsjTEK4.js";import"./index-BdhkuEJx.js";import"./index-BKBXBDOv.js";import"./index-LRezjsDo.js";import"./floating-ui.react-dom-w0Q93DA2.js";import"./index-Dia2ik6c.js";import"./index-D-bfryUZ.js";import"./chevron-down-DMxaecxw.js";import"./createLucideIcon-CEmaZ7tj.js";import"./check-BUlQxyEc.js";const O={amount:{label:"Amount",color:"#e11d48",icon:L}};function ce(){const[f,p]=i.useState([]),[g,y]=i.useState(!0),[w,C]=i.useState(0),[c,b]=i.useState("month"),[x,N]=i.useState(0);return i.useEffect(()=>{fetch("/api/honorariums",{headers:{Accept:"application/json"}}).then(r=>{if(!r.ok)throw new Error("Failed to fetch");return r.json()}).then(r=>{const m=(Array.isArray(r)?r:r.honorariums??[]).filter(t=>t.status==="paid"||t.payment_date),v=m.reduce((t,a)=>t+(parseFloat(a.amount)||0),0);C(v);let s=[];if(c==="week"){const t={},a=new Date,o=new Date(a.getTime()-56*24*60*60*1e3);m.forEach(n=>{const l=new Date(n.payment_date||n.created_at);if(l>=o){const j=`W${8-Math.floor((a.getTime()-l.getTime())/6048e5)}`;t[j]=(t[j]||0)+(parseFloat(n.amount)||0)}}),s=Array.from({length:8},(n,l)=>({label:`W${l+1}`,amount:t[`W${l+1}`]||0}))}else if(c==="month"){const t={};m.forEach(o=>{const l=new Date(o.payment_date||o.created_at).toLocaleDateString("en-US",{month:"short"});t[l]=(t[l]||0)+(parseFloat(o.amount)||0)}),s=Object.keys(t).slice(-6).map(o=>({label:o,amount:t[o]}))}else if(c==="year"){const t={};m.forEach(a=>{const n=new Date(a.payment_date||a.created_at).getFullYear().toString();t[n]=(t[n]||0)+(parseFloat(a.amount)||0)}),s=Object.entries(t).sort(([a],[o])=>a.localeCompare(o)).slice(-5).map(([a,o])=>({label:a,amount:o}))}if(p(s),s.length>1){const t=s[s.length-1].amount,a=s[s.length-2].amount,o=a>0?(t-a)/a*100:0;N(Number(o.toFixed(1)))}}).catch(r=>{console.error("Error fetching honorariums:",r),p([])}).finally(()=>{y(!1)})},[c]),g?e.jsx(d,{className:"rounded-xl shadow-none border flex flex-col justify-between p-0 min-h-[220px]",children:e.jsx(h,{className:"h-[250px] flex items-center justify-center",children:e.jsx("div",{className:"text-muted-foreground",children:"Loading chart data..."})})}):f.length===0?e.jsx(d,{className:"rounded-xl shadow-none border flex flex-col justify-between p-0 min-h-[220px]",children:e.jsx(h,{className:"h-[250px] flex items-center justify-center",children:e.jsx("div",{className:"text-muted-foreground",children:"No honorarium payment data found"})})}):e.jsxs(d,{className:"rounded-xl shadow-none border flex flex-col justify-between p-0 min-h-[220px]",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 pt-5",children:[e.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:"Honorarium Payment Trends"}),e.jsxs(D,{value:c,onValueChange:b,children:[e.jsx(T,{className:"w-[120px] h-8 text-xs",children:e.jsx(E,{})}),e.jsxs(F,{children:[e.jsx(u,{value:"week",children:"Weekly"}),e.jsx(u,{value:"month",children:"Monthly"}),e.jsx(u,{value:"year",children:"Yearly"})]})]})]}),e.jsxs("div",{className:"px-6",children:[e.jsxs("div",{className:"text-3xl font-bold leading-tight",children:["â‚±",w.toLocaleString()]}),e.jsxs("div",{className:"text-sm mt-1 mb-2 text-muted-foreground",children:[x>=0?"+":"",x,"% from previous period"]})]}),e.jsx(h,{className:"flex-1 flex items-end w-full p-0 pb-2",children:e.jsx(S,{config:O,className:"w-full h-[140px]",children:e.jsxs(_,{accessibilityLayer:!0,data:f,margin:{left:12,right:12},children:[e.jsx(M,{vertical:!1}),e.jsx(P,{dataKey:"label",tickLine:!1,axisLine:!1,tickMargin:8,tickFormatter:r=>r}),e.jsx(k,{cursor:!1,content:e.jsx(A,{indicator:"line"})}),e.jsx(W,{dataKey:"amount",type:"natural",fill:"var(--color-amount)",fillOpacity:.4,stroke:"var(--color-amount)",strokeWidth:2,dot:{fill:"#e11d48",r:3}})]})})})]})}export{ce as HonorariumPaymentTrends};
