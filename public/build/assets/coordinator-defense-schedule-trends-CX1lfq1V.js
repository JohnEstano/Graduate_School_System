import{r as o,j as e}from"./app-CQngmq00.js";import{C as d,a as i,b as l,d as h,c as f,e as L}from"./card-C_emSl4Q.js";import{C as S,a as T,b as v}from"./chart-BC_ZPf9S.js";import{L as N,a as b}from"./LineChart-DccwEbWW.js";import{C as k}from"./CartesianGrid-D1brq1mr.js";import{X as q}from"./YAxis-CFpew_UZ.js";import"./utils-jAU0Cazi.js";import"./generateCategoricalChart-RpaH3faT.js";import"./index-BGXDct6C.js";import"./index-Chjiymov.js";const E={defenses:{label:"Defenses",color:"#e11d48"}};function W(){const[u,m]=o.useState([]),[j,g]=o.useState(!0),[p,C]=o.useState(0),[w,D]=o.useState(0);return o.useEffect(()=>{fetch("/defense-requests",{headers:{Accept:"application/json"}}).then(s=>{if(!s.ok)throw new Error("Failed to fetch");return s.json()}).then(s=>{const x=(Array.isArray(s)?s:s.defenseRequests??[]).filter(t=>t.scheduled_date!==null);C(x.length);const c={};x.forEach(t=>{const a=new Date(t.scheduled_date).toLocaleDateString("en-US",{month:"short",year:"numeric"});c[a]=(c[a]||0)+1});const r=Object.keys(c).sort((t,n)=>{const a=new Date(t),y=new Date(n);return a.getTime()-y.getTime()}).slice(-6).map(t=>({month:t.split(" ")[0],defenses:c[t]}));if(m(r),r.length>1){const t=r[r.length-1].defenses,n=r[r.length-2].defenses,a=n>0?(t-n)/n*100:0;D(Number(a.toFixed(1)))}}).catch(s=>{console.error("Error fetching defense requests:",s),m([])}).finally(()=>{g(!1)})},[]),j?e.jsxs(d,{children:[e.jsxs(i,{children:[e.jsx(l,{children:"Defense Schedule Trends"}),e.jsx(h,{children:"Loading..."})]}),e.jsx(f,{className:"h-[300px] flex items-center justify-center",children:e.jsx("div",{className:"text-muted-foreground",children:"Loading chart data..."})})]}):u.length===0?e.jsxs(d,{children:[e.jsxs(i,{children:[e.jsx(l,{children:"Defense Schedule Trends"}),e.jsx(h,{children:"No data available"})]}),e.jsx(f,{className:"h-[300px] flex items-center justify-center",children:e.jsx("div",{className:"text-muted-foreground",children:"No scheduled defense requests found"})})]}):e.jsxs(d,{children:[e.jsxs(i,{children:[e.jsx(l,{children:"Defense Schedule Trends"}),e.jsx(h,{children:"Last 6 months"})]}),e.jsx(f,{children:e.jsx(S,{config:E,children:e.jsxs(N,{accessibilityLayer:!0,data:u,margin:{left:12,right:12},children:[e.jsx(k,{vertical:!1}),e.jsx(q,{dataKey:"month",tickLine:!1,axisLine:!1,tickMargin:8}),e.jsx(T,{cursor:!1,content:e.jsx(v,{hideLabel:!0})}),e.jsx(b,{dataKey:"defenses",type:"natural",stroke:"var(--color-defenses)",strokeWidth:2,dot:{fill:"var(--color-defenses)"},activeDot:{r:6}})]})})}),e.jsx(L,{className:"flex-col items-start gap-2 text-sm",children:e.jsxs("div",{className:"flex gap-2 font-medium leading-none",children:["Total of ",p," scheduled defenses"]})})]})}export{W as CoordinatorDefenseScheduleTrends};
