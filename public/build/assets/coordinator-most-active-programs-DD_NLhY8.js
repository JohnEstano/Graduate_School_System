import{r as o,j as e}from"./app-BDkuJsct.js";import{C as i,a as c,b as d,d as l,c as u,e as C}from"./card-BJFJPDio.js";import{C as q,a as y,b}from"./chart-7aubccfQ.js";import{B as v}from"./BarChart-AW9tJqMJ.js";import{Y as N,X as A}from"./YAxis-B7UrdJFR.js";import{B as w}from"./generateCategoricalChart-BOHwT1p9.js";import"./utils-jAU0Cazi.js";import"./index-CoS1vLG5.js";import"./index-Chjiymov.js";const L={requests:{label:"Requests",color:"#e11d48"}};function X(){const[a,h]=o.useState([]),[f,p]=o.useState(!0),[k,j]=o.useState(0);return o.useEffect(()=>{fetch("/defense-requests",{headers:{Accept:"application/json"}}).then(r=>{if(!r.ok)throw new Error("Failed to fetch");return r.json()}).then(r=>{const m=(Array.isArray(r)?r:r.defenseRequests??[]).filter(s=>s.workflow_state==="coordinator-approved"||s.scheduled_date!==null);j(m.length);const n={};m.forEach(s=>{var x;const t=s.program||((x=s.user)==null?void 0:x.program)||"Unknown Program";n[t]=(n[t]||0)+1});const g=Object.entries(n).map(([s,t])=>({program:s.length>25?s.substring(0,25)+"...":s,requests:t})).sort((s,t)=>t.requests-s.requests).slice(0,5);h(g)}).catch(r=>{console.error("Error fetching defense requests:",r),h([])}).finally(()=>{p(!1)})},[]),f?e.jsxs(i,{className:"rounded-xl shadow-none border",children:[e.jsxs(c,{children:[e.jsx(d,{children:"Most Active Programs"}),e.jsx(l,{children:"Loading..."})]}),e.jsx(u,{className:"h-[300px] flex items-center justify-center",children:e.jsx("div",{className:"text-muted-foreground",children:"Loading chart data..."})})]}):a.length===0?e.jsxs(i,{className:"rounded-xl shadow-none border",children:[e.jsxs(c,{children:[e.jsx(d,{children:"Most Active Programs"}),e.jsx(l,{children:"No data available"})]}),e.jsx(u,{className:"h-[300px] flex items-center justify-center",children:e.jsx("div",{className:"text-muted-foreground",children:"No scheduled or approved defense requests found"})})]}):e.jsxs(i,{className:"rounded-xl shadow-none border",children:[e.jsxs(c,{children:[e.jsx(d,{children:"Most Active Programs"}),e.jsx(l,{children:"Top 5 programs by defense requests"})]}),e.jsx(u,{children:e.jsx(q,{config:L,children:e.jsxs(v,{accessibilityLayer:!0,data:a,layout:"vertical",margin:{left:0},children:[e.jsx(N,{dataKey:"program",type:"category",tickLine:!1,tickMargin:10,axisLine:!1,tickFormatter:r=>r}),e.jsx(A,{dataKey:"requests",type:"number",hide:!0}),e.jsx(y,{cursor:!1,content:e.jsx(b,{hideLabel:!0})}),e.jsx(w,{dataKey:"requests",fill:"var(--color-requests)",radius:5})]})})}),e.jsx(C,{className:"flex-col items-start gap-2 text-sm",children:e.jsxs("div",{className:"flex gap-2 font-medium leading-none",children:["Top program: ",a[0].program," (",a[0].requests,")"]})})]})}export{X as CoordinatorMostActivePrograms};
