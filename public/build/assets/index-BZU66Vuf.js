import{K as O,r as i,a as K,j as e,L as Q,S as y}from"./app-BDkuJsct.js";import{A as X}from"./app-layout-Cr_DtTkJ.js";import{B as o}from"./button-DggClj9M.js";import{I as G}from"./input-BmPXXlp0.js";import H from"./panelists-list-table-DDmK2vbj.js";import J from"./panelists-form-modal-DlEa-UkY.js";import{T as V,t as d}from"./index-By5vkq0G.js";import{P as z,a as L,b as F}from"./popover-CxnVWzfd.js";import{C as E}from"./checkbox-CR1JIwzI.js";import{U as W}from"./users-BTr8E8QO.js";import{U as Y}from"./user-plus-Cc8-99X-.js";import{S as Z}from"./search-oqoQW3gm.js";import{C as D}from"./circle-plus-C8aRXmTg.js";import{X as R}from"./x-CtfT_1vN.js";import{T as _}from"./trash-2-CUp06ccZ.js";import"./index-B_a1aFVM.js";import"./index-DZZQifJx.js";import"./utils-jAU0Cazi.js";import"./index-CWqpdCTP.js";import"./index-BhbofC_p.js";import"./index-D-bfryUZ.js";import"./tooltip-CWM4FSMS.js";import"./floating-ui.react-dom-w0Q93DA2.js";import"./createLucideIcon-CEmaZ7tj.js";import"./separator-DaKqQg6m.js";import"./index-LRezjsDo.js";import"./chevron-right-BpKiIXqV.js";import"./dropdown-menu-B7sOazTG.js";import"./index-DMsjTEK4.js";import"./index-BdhkuEJx.js";import"./index-BKBXBDOv.js";import"./index-QFmRa-KD.js";import"./check-BUlQxyEc.js";import"./avatar-DpsgA3Kf.js";import"./settings-BITCJcnj.js";import"./graduation-cap-Cszrlop1.js";import"./file-text-rxgzo2tt.js";import"./dollar-sign-CSALIIUa.js";import"./send-9CEFXyiZ.js";import"./credit-card-CM3Zlvhr.js";import"./tabs-BOuSS6lC.js";import"./badge-BJdX7_A9.js";import"./circle-check-big-CKfkcUFR.js";import"./info-DwFda8kE.js";import"./sun-B3PIUh1_.js";import"./table-CnA6sFiR.js";import"./dialog-DeUj0iLU.js";import"./pencil-BymrdZQ3.js";import"./user-IY2-Ii15.js";import"./mail-C2Dt0zh5.js";import"./message-circle-DD6fFkTA.js";import"./loader-circle-xEC7kKhV.js";import"./calendar-CI-DWPmu.js";import"./clock-BykI6stH.js";import"./refresh-cw-B6toqFMV.js";import"./label-MiJboLk1.js";import"./index-Dia2ik6c.js";const ee=[{title:"Dashboard",href:"/dashboard"},{title:"Panelists",href:"/panelists"}];function as(){const{panelists:v=[],paymentRates:g=[]}=O().props,[S,c]=i.useState(v),[p,b]=i.useState([]),[T,u]=i.useState(!1),[M,x]=i.useState(null),[j,C]=i.useState(""),[h,m]=i.useState(!1),[N,f]=i.useState(!1),[U,A]=i.useState(g),[l,k]=i.useState([]),[n,w]=i.useState([]);i.useEffect(()=>{c(v)},[v]),i.useEffect(()=>{if(g&&g.length>0)return;let s=!0;return K.get("/dean/payment-rates/data").then(t=>{var a;if(!s)return;const r=Array.isArray((a=t.data)==null?void 0:a.rates)?t.data.rates:[];A(r)}).catch(()=>A([])),()=>{s=!1}},[g]);const P=i.useMemo(()=>{const s=j.trim().toLowerCase();let t=S;return l.length>0&&(t=t.filter(r=>Array.isArray(r.assignments)&&r.assignments.some(a=>a.role&&l.includes(a.role))||!Array.isArray(r.assignments)&&l.includes(r.role))),n.length>0&&(t=t.filter(r=>{const a=Array.isArray(r.assignments)&&r.assignments.length>0;return n.includes("Assigned")&&a||n.includes("Not Assigned")&&!a})),s&&(t=t.filter(r=>r.name.toLowerCase().includes(s)||r.email.toLowerCase().includes(s)||r.status.toLowerCase().includes(s))),t},[j,S,l,n]),$=i.useMemo(()=>P.map(s=>({...s,assignments:(s.assignments||[]).map(t=>({...t,type:t.type??t.role??s.role}))})),[P]);function B(s,t,r){f(!0),t?y.put(`/panelists/${t}`,s,{preserveScroll:!0,onSuccess:a=>{d.success("Panelist updated"),u(!1),x(null),c(Array.isArray(a.props.panelists)?a.props.panelists:[]),f(!1),r&&r()},onError:()=>{d.error("Failed to update panelist"),f(!1),r&&r()}}):y.post("/panelists",s,{preserveScroll:!0,onSuccess:a=>{d.success("Panelist added"),u(!1),x(null),c(Array.isArray(a.props.panelists)?a.props.panelists:[]),f(!1),r&&r()},onError:()=>{d.error("Failed to add panelist"),f(!1),r&&r()}})}function I(s){m(!0),y.delete(`/panelists/${s}`,{preserveScroll:!0,onSuccess:t=>{d.success("Panelist deleted"),b(r=>r.filter(a=>a!==s)),c(Array.isArray(t.props.panelists)?t.props.panelists:[]),m(!1)},onError:()=>{d.error("Failed to delete panelist"),m(!1)}})}function q(){p.length!==0&&window.confirm("Delete selected panelists?")&&(m(!0),y.post("/panelists/bulk-delete",{ids:p},{preserveScroll:!0,onSuccess:s=>{d.success("Panelists deleted"),b([]),c(Array.isArray(s.props.panelists)?s.props.panelists:[]),m(!1)},onError:()=>{d.error("Failed to bulk delete"),m(!1)}}))}return e.jsxs(X,{breadcrumbs:ee,children:[e.jsx(Q,{title:"Panelists"}),e.jsx(V,{richColors:!0,position:"bottom-right"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 overflow-auto rounded-xl pt-5 pr-7 pl-7 relative bg-background",children:[e.jsxs("div",{className:"w-full bg-white dark:bg-zinc-900 border border-border dark:border-border rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"flex flex-row items-center justify-between w-full p-3 border-b bg-white dark:bg-zinc-900 dark:border-border",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-10 w-10 flex items-center justify-center rounded-full bg-rose-500/10 dark:bg-rose-900 border border-rose-500",children:e.jsx(W,{className:"h-5 w-5 text-rose-400"})}),e.jsxs("div",{children:[e.jsx("span",{className:"text-base font-semibold",children:"Panelists"}),e.jsx("span",{className:"block text-xs text-muted-foreground dark:text-muted-foreground",children:"This section shows all defense panelists. Add, search, and manage panelists."})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(o,{onClick:()=>{u(!0),x(null)},disabled:N||h,children:[e.jsx(Y,{className:"h-4 w-4"})," ",N?"Loading...":"Add Panel"]})})]}),e.jsx("div",{className:"flex items-center justify-between gap-2 px-4 py-3 border-b bg-white dark:bg-zinc-900 dark:border-border",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(G,{type:"text",startIcon:Z,placeholder:"Search...",value:j,onChange:s=>C(s.target.value),className:"max-w-xs text-sm h-8",disabled:h}),e.jsxs(z,{children:[e.jsx(L,{asChild:!0,children:e.jsxs(o,{variant:"outline",className:"h-8 px-3 rounded-md border-dashed text-xs flex items-center gap-1",children:[e.jsx(D,{className:"h-4 w-4 mr-1"}),"Role",l.length>0&&e.jsx("span",{className:"ml-1 px-2 py-0.5 rounded-full text-xs bg-muted dark:bg-zinc-800",children:l.length>1?`${l.length} selected`:l[0]})]})}),e.jsxs(F,{className:"w-44 p-1 dark:bg-zinc-900 dark:text-muted-foreground",side:"bottom",align:"start",children:[["Chairperson","Panel Member"].map(s=>e.jsxs("div",{onClick:()=>k(t=>t.includes(s)?t.filter(r=>r!==s):[...t,s]),className:"flex items-center gap-2 p-2 rounded hover:bg-muted dark:hover:bg-zinc-800 cursor-pointer",children:[e.jsx(E,{checked:l.includes(s)}),e.jsx("span",{className:"text-sm",children:s})]},s)),e.jsx(o,{size:"sm",variant:"ghost",className:"w-full mt-2",onClick:()=>k([]),children:"Clear"})]})]}),e.jsxs(z,{children:[e.jsx(L,{asChild:!0,children:e.jsxs(o,{variant:"outline",className:"h-8 px-3 rounded-md border-dashed text-xs flex items-center gap-1",children:[e.jsx(D,{className:"h-4 w-4 mr-1"}),"Status",n.length>0&&e.jsx("span",{className:"ml-1 px-2 py-0.5 rounded-full text-xs bg-muted dark:bg-zinc-800",children:n.length>1?`${n.length} selected`:n[0]})]})}),e.jsxs(F,{className:"w-44 p-1 dark:bg-zinc-900 dark:text-muted-foreground",side:"bottom",align:"start",children:[["Assigned","Not Assigned"].map(s=>e.jsxs("div",{onClick:()=>w(t=>t.includes(s)?t.filter(r=>r!==s):[...t,s]),className:"flex items-center gap-2 p-2 rounded hover:bg-muted dark:hover:bg-zinc-800 cursor-pointer",children:[e.jsx(E,{checked:n.includes(s)}),e.jsx("span",{className:"text-sm",children:s})]},s)),e.jsx(o,{size:"sm",variant:"ghost",className:"w-full mt-2",onClick:()=>w([]),children:"Clear"})]})]}),(l.length>0||n.length>0||j.trim())&&e.jsxs(o,{variant:"ghost",size:"sm",className:"h-8 px-3 flex items-center gap-1",onClick:()=>{k([]),w([]),C("")},children:[e.jsx(R,{size:14})," Reset"]})]})})]}),e.jsx(H,{panelists:$,paymentRates:U,onEdit:s=>{x(s),u(!0)},onDelete:I,selected:p,setSelected:b,loading:h}),p.length>0&&e.jsxs("div",{className:"fixed left-1/2 z-30 -translate-x-1/2 bottom-4 md:bottom-6 flex items-center gap-1 bg-white dark:bg-muted dark:text-muted-foreground border border-border dark:border-border shadow-lg rounded-lg px-4 py-1 text-xs",children:[e.jsxs("span",{className:"font-semibold min-w-[70px] text-center",children:[p.length," selected"]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsxs(o,{variant:"ghost",size:"icon",className:"px-2 py-1 h-7 w-auto text-xs flex items-center gap-1",onClick:q,"aria-label":"Delete",disabled:h,children:[e.jsx(_,{size:13}),e.jsx("span",{className:"hidden sm:inline",children:h?"Deleting...":"Delete"})]}),e.jsx(o,{variant:"ghost",size:"icon",className:"px-1 py-1 h-7 w-auto text-xs flex items-center",onClick:()=>b([]),"aria-label":"Clear selection",children:e.jsx(R,{size:14})})]})]}),e.jsx(J,{open:T,editing:M,onClose:()=>{u(!1),x(null)},onSubmit:B,loading:N})]})]})}export{as as default};
