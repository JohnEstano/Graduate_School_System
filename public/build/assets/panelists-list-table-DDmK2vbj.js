import{r,j as e,a as U}from"./app-BDkuJsct.js";import{T as te,a as ne,b as D,c as f,d as ie,e as m}from"./table-CnA6sFiR.js";import{C as $}from"./checkbox-CR1JIwzI.js";import{B as c}from"./button-DggClj9M.js";import{D as I,a as O,d as M,b as B,e as E}from"./dialog-DeUj0iLU.js";import{B as j}from"./badge-BJdX7_A9.js";import{U as re}from"./users-BTr8E8QO.js";import{P as le}from"./pencil-BymrdZQ3.js";import{T as ae}from"./trash-2-CUp06ccZ.js";import{U as oe}from"./user-IY2-Ii15.js";import{M as ce}from"./mail-C2Dt0zh5.js";import{M as de}from"./message-circle-DD6fFkTA.js";import{L as me}from"./loader-circle-xEC7kKhV.js";import{C as xe}from"./calendar-CI-DWPmu.js";import{C as he}from"./clock-BykI6stH.js";import{R as pe}from"./refresh-cw-B6toqFMV.js";import"./utils-jAU0Cazi.js";import"./index-LRezjsDo.js";import"./index-BhbofC_p.js";import"./index-BdhkuEJx.js";import"./index-DMsjTEK4.js";import"./index-Dia2ik6c.js";import"./index-QFmRa-KD.js";import"./check-BUlQxyEc.js";import"./createLucideIcon-CEmaZ7tj.js";import"./index-B_a1aFVM.js";import"./index-DZZQifJx.js";import"./index-CWqpdCTP.js";import"./index-D-bfryUZ.js";import"./x-CtfT_1vN.js";function Je({panelists:u,paymentRates:V,onEdit:F,onDelete:G,selected:x,setSelected:T,loading:a=!1}){const H=u.map(s=>s.id),P=s=>T(s?H:[]),W=(s,n)=>T(n?[...x,s]:x.filter(i=>i!==s)),[q,b]=r.useState(!1),[L,S]=r.useState(null),J=s=>{S(s),b(!0)},_=()=>{b(!1),S(null)},K=()=>{L!==null&&(G(L),_())},[N,y]=r.useState(!1),[t,C]=r.useState(null),[o,w]=r.useState([]),[v,A]=r.useState(!1),[fe,Q]=r.useState("assignments"),[ue,k]=r.useState([]),X=s=>{C(s),w(s.assignments??[]),Q("assignments"),y(!0),U.get(`/api/coordinator/panelists/${s.id}/pending`).then(n=>k(n.data)).catch(()=>k([]))},Y=async()=>{if(t){A(!0);try{const n=(await U.get(`/api/coordinator/panelists/${t.id}`)).data;w(n.assignments??[]),C(i=>i?{...i,...n}:n)}finally{A(!1)}}};r.useEffect(()=>{N||(C(null),w([]),k([]))},[N]);function z(s){if(!s)return"";const n=String(s).toLowerCase().replace(/[\s-]/g,"");return n.includes("prefinal")?"Prefinal":n.includes("proposal")?"Proposal":n.includes("final")?"Final":s}function Z(s,n,i){const h=(s||"").trim().toLowerCase(),g=(n||"").trim().toLowerCase(),p=z(i||"").toLowerCase();if(!h||!g||!p)return null;const l=V.find(d=>String(d.program_level).trim().toLowerCase()===h&&String(d.type).trim().toLowerCase()===g&&z(d.defense_type).toLowerCase()===p);return l?Number(l.amount):null}return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"rounded-md overflow-x-auto border border-border bg-background w-full max-w-full",style:{minWidth:"700px"},children:e.jsxs(te,{className:"w-full text-sm table-fixed",children:[e.jsx(ne,{children:e.jsxs(D,{children:[e.jsx(f,{className:"w-12",children:e.jsx($,{checked:x.length>0&&x.length===u.length,onCheckedChange:s=>P(!!s),disabled:a})}),e.jsx(f,{className:"px-3 min-w-[120px]",children:"Name"}),e.jsx(f,{className:"px-2 min-w-[120px]",children:"Email"}),e.jsx(f,{className:"px-2 min-w-[80px] text-center",children:"Assigned Defenses"}),e.jsx(f,{className:"text-center px-2",children:"Actions"})]})}),e.jsx(ie,{children:u.length===0?e.jsx(D,{children:e.jsx(m,{colSpan:5,className:"py-8 text-center text-sm text-muted-foreground",children:"No panelists found."})}):u.map(s=>e.jsxs(D,{className:"hover:bg-muted/40 cursor-pointer transition",children:[e.jsx(m,{children:e.jsx($,{checked:x.includes(s.id),onCheckedChange:n=>W(s.id,!!n),disabled:a})}),e.jsx(m,{className:"px-3 py-2 font-medium truncate leading-tight align-middle",children:s.name}),e.jsx(m,{className:"px-2 py-2 text-xs text-muted-foreground whitespace-nowrap align-middle",children:s.email}),e.jsx(m,{className:"px-2 py-2 text-center align-middle",children:s.assignments?s.assignments.length:0}),e.jsx(m,{className:"px-2 py-2 text-center",children:e.jsxs("div",{className:"flex justify-center gap-2",children:[e.jsx(c,{variant:"outline",size:"icon","aria-label":"View panelist",onClick:()=>X(s),disabled:a,children:e.jsx(re,{size:18})}),e.jsx(c,{variant:"outline",size:"icon","aria-label":"Edit panelist",onClick:()=>F(s),disabled:a,children:e.jsx(le,{size:18})}),e.jsx(c,{variant:"outline",size:"icon","aria-label":"Delete panelist",onClick:()=>J(s.id),disabled:a,children:e.jsx(ae,{size:18})})]})})]},s.id))})]})}),e.jsx(I,{open:N,onOpenChange:s=>y(s),children:e.jsxs(O,{className:"max-w-2xl dark:bg-zinc-800",style:{minWidth:"520px",maxWidth:"640px"},children:[e.jsxs(M,{children:[e.jsx(B,{className:"dark:text-zinc-100",children:"Panelist Information"}),e.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[e.jsx("div",{className:"h-12 w-12 flex items-center justify-center rounded-full bg-rose-500/10 border border-rose-500",children:e.jsx(oe,{className:"h-7 w-7 text-rose-500"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-sm text-zinc-900 dark:text-zinc-100",children:t==null?void 0:t.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-300",children:t==null?void 0:t.email}),e.jsxs("button",{className:"px-2 py-1 rounded hover:bg-zinc-100 dark:hover:bg-zinc-700 text-zinc-600 dark:text-zinc-300 text-xs flex items-center gap-1 cursor-pointer transition",style:{height:"22px"},title:"Send Gmail",onClick:()=>{t!=null&&t.email&&window.open(`https://mail.google.com/mail/?view=cm&fs=1&to=${encodeURIComponent(t.email)}`,"_blank")},children:[e.jsx(ce,{size:14,className:"text-zinc-500 dark:text-zinc-300"}),"Gmail"]}),e.jsxs("button",{className:"px-2 py-1 rounded hover:bg-zinc-100 dark:hover:bg-zinc-700 text-zinc-600 dark:text-zinc-300 text-xs flex items-center gap-1 cursor-pointer transition",style:{height:"22px"},title:"Open Google Chat",onClick:()=>{t!=null&&t.email&&window.open(`https://mail.google.com/chat/u/0/#chat/user/${encodeURIComponent(t.email)}`,"_blank")},children:[e.jsx(de,{size:14,className:"text-zinc-500 dark:text-zinc-300"}),"Chat"]})]})]})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"overflow-y-auto overflow-x-auto min-w-[400px] rounded bg-white dark:bg-zinc-900 px-2 py-2",style:{height:"240px"},children:[e.jsxs("div",{className:"font-semibold mb-2 text-sm flex items-center gap-2",children:["Assigned Defenses",e.jsx(j,{variant:"secondary",className:"text-xs",children:(o==null?void 0:o.length)??0})]}),v?e.jsxs("div",{className:"text-xs flex items-center justify-center h-full dark:text-zinc-300",children:[e.jsx(me,{className:"mr-2 h-4 w-4 animate-spin"})," Loading defenses..."]}):((o==null?void 0:o.length)??0)===0?e.jsx("div",{className:"text-gray-500 text-xs flex items-center justify-center h-full dark:text-gray-400",children:"No defenses assigned to this panelist."}):e.jsx("ul",{className:"divide-y",children:o.map(s=>{(s==null?void 0:s.receivable)!=null&&s.receivable!==""&&Number(s.receivable),Z(s==null?void 0:s.program_level,(s==null?void 0:s.type)??(s==null?void 0:s.role),s==null?void 0:s.defense_type);const n=s==null?void 0:s.scheduled_date,i=s==null?void 0:s.start_time,h=s==null?void 0:s.end_time,g=l=>l?new Date(l).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):null,p=l=>{if(!l)return null;const[d,ee]=l.split(":"),R=parseInt(d),se=R>=12?"PM":"AM";return`${R%12||12}:${ee} ${se}`};return e.jsxs("li",{className:"py-3 px-2 flex flex-col gap-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx(j,{variant:"outline",className:"text-xs",children:"Thesis"}),e.jsx("span",{className:"font-medium text-sm",children:(s==null?void 0:s.thesis_title)??"Untitled Thesis"})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[n&&e.jsxs(j,{variant:"secondary",className:"text-xs flex items-center gap-1",children:[e.jsx(xe,{size:12}),g(n)]}),i&&h&&e.jsxs(j,{variant:"secondary",className:"text-xs flex items-center gap-1",children:[e.jsx(he,{size:12}),p(i)," - ",p(h)]})]}),e.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-300",children:["Role: ",e.jsx("b",{className:"mx-1",children:(s==null?void 0:s.role)??(t==null?void 0:t.role)??"-"}),"â€¢ Type: ",e.jsx("b",{className:"mx-1",children:z(s==null?void 0:s.defense_type)})]})]},s.id)})})]}),e.jsx("div",{className:"flex w-full justify-end mt-2",children:e.jsxs(c,{variant:"outline",size:"sm",onClick:Y,disabled:v,title:"Refresh defenses",children:[e.jsx(pe,{className:`mr-1 h-4 w-4 ${v?"animate-spin":""}`}),"Refresh"]})})]}),e.jsx(E,{children:e.jsx("div",{className:"flex w-full justify-end gap-2",children:e.jsx(c,{variant:"ghost",onClick:()=>y(!1),children:"Close"})})})]})}),e.jsx(I,{open:q,onOpenChange:b,children:e.jsxs(O,{className:"bg-background text-muted-foreground",children:[e.jsx(M,{children:e.jsx(B,{children:"Confirm Delete"})}),e.jsx("div",{className:"text-muted-foreground text-sm",children:"This will delete the panelist. This action cannot be undone."}),e.jsxs(E,{children:[e.jsx(c,{variant:"ghost",onClick:_,disabled:a,children:"Cancel"}),e.jsx(c,{onClick:K,disabled:a,className:"text-white",children:"Delete"})]})]})})]})}export{Je as default};
